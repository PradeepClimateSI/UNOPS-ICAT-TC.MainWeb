<div class="container pl-20 pr-20" id="content">
    <div class="mb-12">
        <h4 class="mt-4"> Result - {{intervention?.policyName}}</h4>
    </div>
    <div class="card" style="min-height: 600px;">
        <div class="p-grid p-fluid col-md-12 col-sm-12 text-title">
            <div class="row p-2" *ngFor="let item of card">
                <div class="col-3">{{item.title}} :</div>
                <div class="col-9">{{item.data}}</div>
            </div>
        </div>
        <hr>
        <div class="p-grid p-fluid col-md-12 col-sm-12" *ngFor="let section of keys ">
            <div class="row p-2">
                <label class="text" for=""><u ><b>{{section}}</b> </u></label>
            </div>
            <div class="row p-2">
                <p-table [value]="results[section]" rowGroupMode="subheader" groupRowsBy="criteria" dataKey="criteria" [expandedRowKeys]="expandedRows">
                    <ng-template pTemplate="header">
                        <tr>
                            <th >
                                Question
                            </th>
                            <th >
                                Answer
                            </th>
                            <th colspan="2">
                                Rationale
                            </th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="groupheader" let-company let-isExpanded="expanded">
                        <tr>
                            <td colspan="3">
                                <button type="button" pButton pRipple [pRowToggler]="company" class="p-button-text 
                        p-button-rounded p-button-plain mr-4" [icon]="isExpanded ? 
                        'pi pi-chevron-down' : 
                        'pi pi-chevron-right'">
                                </button>
                                <span class="font-bold">{{company.criteria}}</span>
                            </td>
                        </tr>
                    </ng-template>
                    <ng-template let-company>
                        <tr>
                            <td >{{company.question}}</td>
                            <td > {{company.answer}}</td>
                            <td >{{company.comment}}</td>
                            <td > <a *ngIf="company?.document" target="_blank" [href]="fileServerURL+'/'+company?.document"><i class="pi pi-download download"></i></a></td>

                            
                        </tr>
                    </ng-template>
                </p-table>
            </div>
           
        </div>
        <div class="p-grid p-fluid col-12">
            <div class="row p-2">
                <label class="text"><u ><b>Transformational Change Criteria</b> </u></label>
            </div>
            <div class="row p-2" *ngIf="processData.technology.length!=0">
                <p-table   [value]="processData.technology" >
                
                    <ng-template pTemplate="caption" styleClass="table-header"  >
                        <div class="table-header">
                            Process of Change / Technology
                        </div>
                    </ng-template>
                    <ng-template pTemplate="header">
                        <tr>
                            <th >Characteristic</th>
                            <th >Question </th>
                            <th >Score</th>
                            <th colspan="2">justification</th>
                        </tr>
                    </ng-template>
                   
                    <ng-template pTemplate="body" let-technology>
                        <tr>
                            <td >{{technology.characteristic}}</td>
                            <td >{{technology.question}}</td>
                            <td >{{(technology?.score)?(technology?.score):'-'}}</td>
                            <td >{{(technology?.justification)?(technology?.justification):'-'}}</td>
                            <td > <a *ngIf="technology?.document" target="_blank" [href]="fileServerURL+'/'+technology?.document"><i class="pi pi-download download"></i></a></td>
                        </tr>
                    </ng-template>
                </p-table>
            </div>
            <div class="row p-2" *ngIf="processData.incentives.length!=0">
                <p-table [value]="processData.incentives"  >
                    <ng-template pTemplate="caption" styleClass="table-header"  >
                        <div class="table-header">
                            Process of Change / Incentives
                        </div>
                    </ng-template>
                    <ng-template pTemplate="header">
                        <tr>
                            <th >Characteristic</th>
                            <th >Question</th>
                            <th >Score</th>
                            <th colspan="2">Justification</th>
                        </tr>
                    </ng-template>
                   
                    <ng-template pTemplate="body" let-incentives>
                        <tr>
                            <td >{{incentives.characteristic}}</td>
                            <td >{{incentives.question}}</td>
                            <td >{{(incentives?.score)?(incentives?.score):'-'}}</td>
                            <td >{{(incentives?.justification)?(incentives?.justification):'-'}} </td>
                            <td><a *ngIf="incentives?.document" target="_blank" [href]="fileServerURL+'/'+incentives?.document"><i class="pi pi-download download"></i></a></td>
                        </tr>
                    </ng-template>
                </p-table>
            </div>
            <div class="row p-2" *ngIf="processData.norms.length!=0">
                <p-table [value]="processData.norms"  >
                    <ng-template pTemplate="caption" styleClass="table-header"  >
                        <div class="table-header">
                            Process of Change / Norms
                        </div>
                    </ng-template>
                    <ng-template pTemplate="header">
                        <tr>
                            <th >Characteristic</th>
                            <th >Question</th>
                            <th >Score</th>
                            <th colspan="2">Justification</th>
                        </tr>
                    </ng-template>
                   
                    <ng-template pTemplate="body" let-norms>
                        <tr>
                            <td >{{norms.characteristic}}</td>
                            <td >{{norms.question}}</td>
                            <td >{{(norms?.score)?(norms?.score):'-'}}</td>
                            <td >{{(norms?.justification)?(norms?.justification):'-'}} </td>
                            <td><a *ngIf="norms?.document" target="_blank" [href]="fileServerURL+'/'+norms?.document"><i class="pi pi-download download"></i></a></td>
                        </tr>
                    </ng-template>
                </p-table>
            </div>
            
            <div class="row p-2" *ngIf="outcomeData.scale_GHGs.length!=0">
                <p-table  [value]="outcomeData.scale_GHGs" >
                    <ng-template pTemplate="caption" styleClass="table-header"  >
                        <div class="table-header">
                            Outcome of Change / Scale GHGs
                        </div>
                    </ng-template>
                    <ng-template pTemplate="header">
                        <tr>
                            <th >Characteristic</th>
                            <th >Starting Situation </th>
                            <th >Expected Impact</th>
                            <th >Score</th>
                            <th colspan="2">Justification</th>
                        </tr>
                    </ng-template>
                   
                    <ng-template pTemplate="body" let-scale_GHGs>
                        <tr>
                            <td >{{scale_GHGs.characteristic}}</td>
                            <td >{{(scale_GHGs?.starting_situation)?(scale_GHGs?.starting_situation):'-'}}</td>
                            <td >{{(scale_GHGs?.expected_impacts)?(scale_GHGs?.expected_impacts):'-'}}</td>
                            <td >{{(scale_GHGs?.score)?(scale_GHGs?.score):'-'}}</td>
                            <td >{{(scale_GHGs?.justification)?(scale_GHGs?.justification):'-'}} </td>
                            <td><a *ngIf="scale_GHGs?.document" target="_blank" [href]="fileServerURL+'/'+scale_GHGs?.document"><i class="pi pi-download download"></i></a></td>

                            
                        </tr>
                    </ng-template>
                </p-table>
            </div>
            <div class="row p-2" *ngIf="outcomeData.sustained_GHGs.length!=0">
                <p-table   [value]="outcomeData.sustained_GHGs">
                    <ng-template pTemplate="caption" styleClass="table-header"  >
                        <div class="table-header">
                            Outcome of Change / Sustained GHGs
                        </div>
                    </ng-template>
                    <ng-template pTemplate="header">
                        <tr>
                            <th >Characteristic</th>
                            <th >Question</th>
                            <th >Score</th>
                            <th colspan="2">Justification</th>
                        </tr>
                    </ng-template>
                   
                    <ng-template pTemplate="body" let-sustained_GHGs>
                        <tr>
                            <td >{{sustained_GHGs.characteristic}}</td>
                            <td >{{(sustained_GHGs?.question)?(sustained_GHGs?.question):'-'}}</td>
                            <td >{{(sustained_GHGs?.score)?(sustained_GHGs?.score):'-'}}</td>
                            <td >{{(sustained_GHGs?.justification)?(sustained_GHGs?.justification):'-'}} </td>
                            <td><a *ngIf="sustained_GHGs?.document" target="_blank" [href]="fileServerURL+'/'+sustained_GHGs?.document"><i class="pi pi-download download"></i></a></td>

                    </ng-template>
                </p-table>
            </div>
           
            <div class="row p-2" *ngIf="outcomeData.scale_SDs.length!=0">
            
                <p-table  [value]="outcomeData.scale_SDs" >
                    <ng-template pTemplate="caption" styleClass="table-header"  >
                        <div class="table-header">
                            Outcome of Change / Scaled SDs
                        </div>
                    </ng-template>
                    <ng-template pTemplate="header">
                        <tr>
                            <th >SDG</th>
                            <th >Characteristic</th>
                            <th >Starting Situation </th>
                            <th >Expected Impact</th>
                            <th >Score</th>
                            <th colspan="2">Justification</th>
                        </tr>
                    </ng-template>
                   
                    <ng-template pTemplate="body" let-scale_SDs>
                        <tr>
                            <td >{{(scale_SDs?.SDG)?(scale_SDs?.SDG):'-'}}</td>
                            <td >{{scale_SDs?.characteristic}}</td>
                            <td >{{(scale_SDs?.starting_situation)?(scale_SDs?.starting_situation):'-'}}</td>
                            <td >{{(scale_SDs?.expected_impacts)?(scale_SDs?.expected_impacts):'-'}}</td>
                            <td >{{(scale_SDs?.score)?(scale_SDs?.score):'-'}}</td>
                            <td >{{(scale_SDs?.justification)?(scale_SDs?.justification):'-'}} </td>
                            <td><a *ngIf="scale_SDs?.document" target="_blank" [href]="fileServerURL+'/'+scale_SDs?.document"><i class="pi pi-download download"></i></a></td>
                            
                        </tr>
                    </ng-template>
                </p-table>
            </div>
            <div class="row p-2" *ngIf="outcomeData.sustained_SDs.length!=0">
                <p-table [value]="outcomeData.sustained_SDs" >
                    <ng-template pTemplate="caption" styleClass="table-header"  >
                        <div class="table-header">
                            Outcome of Change / Sustained SDs
                        </div>
                    </ng-template>
                    <ng-template pTemplate="header">
                        <tr>
                            <th >SDG</th>
                            <th >Characteristic</th>
                            <th >Question</th>
                            <th > Score</th>
                            <th colspan="2">Justification</th>
                        </tr>
                    </ng-template>
                   
                    <ng-template pTemplate="body" let-sustained_SDs>
                        <tr>
                            <td >{{(sustained_SDs?.SDG)?(sustained_SDs?.SDG):'-'}}</td>
                            <td >{{sustained_SDs.characteristic}}</td>
                            <td >{{(sustained_SDs?.question)?(sustained_SDs?.question):'-'}}</td>
                            <td >{{(sustained_SDs?.score)?(sustained_SDs?.score):'-'}}</td>
                            <td >{{(sustained_SDs?.justification)?(sustained_SDs?.justification):'-'}} </td>
                            <td><a *ngIf="sustained_SDs?.document" target="_blank" [href]="fileServerURL+'/'+sustained_SDs?.document"><i class="pi pi-download download"></i></a></td>
                        </tr>
                    </ng-template>
                </p-table>
            </div>

            
            <div class="row p-2 text">
                <div class="col-5">Transformational Change: </div>
                <div class="col-7">{{score}}</div>
            </div>
        </div>
        <div class="p-grid p-fluid col-md-12 col-sm-12">
            <div class="row p-2">
                <div class="col-8"></div>
                <div class="col-2">
                    <button pButton pRipple type="button" label="Download Excel" (click)="toDownloadExcel()"
                    class="p-button-info" *ngIf="!isDownloading"></button>
                </div>
                <div class="col-2">
                    <button pButton pRipple type="button" label="Download PDF" (click)="toDownloadPdf()"
                    class="p-button-info" *ngIf="!isDownloading"></button>
                </div>
            </div>
        </div>
    </div>
</div>