<p-tabView (onChange)="onMainTabChange($event) " [(activeIndex)]="activeIndexMain ">
    <p-tabPanel *ngFor="let type of types; let idx = index" header="{{type.name}}">
        <ng-template pTemplate="header">
            <span>{{type.name}}</span><i *ngIf="maintabIsValid[idx] !== undefined && !maintabIsValid[idx]"  pTooltip="Mandatory fields not filled" tooltipPosition="top" class="pi pi-info-circle" style="color: red; font-size: 1rem;"></i>
        </ng-template>
        <p-tabView #tabView (onChange)="onCategoryTabChange($event)" [(activeIndex)]="activeIndex" *ngIf="type.code === 'process'">
            <p-tabPanel *ngFor="let category of categories[type.code]; let idx = index" [header]="category.name" [selected]="category.name==assessment.processDraftLocation">
                <ng-template pTemplate="header">
                    <span>{{category.name}}</span><i *ngIf="tab1IsValid[idx] !== undefined && !tab1IsValid[idx]"  pTooltip="Mandatory fields not filled" tooltipPosition="top" class="pi pi-info-circle" style="color: red; font-size: 1rem;"></i>
                </ng-template>
                <br>
                <p style="font-size: large;">{{category.description}}</p>
                <br>
                <ng-container *ngFor="let char of category.characteristics; let idx = index">
                    <h6>{{idx + 1}}. {{char.name === 'Research and Development' ? char.name + ' (R&D)' : char.name}}</h6>
                    <p>{{char.description}}</p>
                    <div class="row">
                        <div class="col-2">
                            <label for="Description">Relevance * <i class="pi pi-info-circle" pTooltip="{{relevance_tooltip}}" tooltipPosition="bottom"
                                style="font-size: 1rem"></i></label>
                        </div>
                        <div class="col-5">
                            <p-dropdown name="data_charData_relavance" #data_charData_relavance="ngModel" placeholder="Select Relevance" [(ngModel)]="char.relevance" [options]="relevance" optionLabel="name" appendTo="body" optionValue="value" [required]="true"
                                (onChange)="onRelevanceChange($event, char)"></p-dropdown>
                        </div>
                        <p class="info-message text-danger" *ngIf="
                                char.relevance === undefined &&
                                (nextClicked || data_charData_relavance.touched)
                              ">
                            This is a mandatory field
                        </p>
                    </div>
                    <br>
                    <div *ngIf="char.relevance !== 0">
                        <p><strong>{{char.main_question}}</strong></p>
                        <br>
                        <p><strong><u>Guiding Question(s)</u></strong></p>
                        <div *ngFor="let question of char.questions">
                            <app-cm-question [question]="question" [approach]="approach" [assessmentquestions]="assessmentquestions" [isEditMode]="isEditMode" (prev_answer)="onAnswer($event, question, char)"></app-cm-question>
                        </div>
                    </div>
                </ng-container>
                <div class="row justify-content-end">
                    <div>
                        <div class="d-flex flex-row-reverse mt-20 ">
                            <div class="btn btn-primary text-uppercase" (click)="next(category.code, category.characteristics)">
                                Next
                            </div>
                            <div style="margin-right: 10px;" class="btn btn-primary text-uppercase" (click)="submit(category.code, true,category.name,'prose')">
                                Save
                            </div>
                        </div>
                    </div>
                </div>
            </p-tabPanel>
        </p-tabView>
        <p-tabView #tabView (onChange)="onCategoryTabChange2($event)" [(activeIndex)]="activeIndex2" *ngIf="type.code === 'outcome'">
            <p-tabPanel *ngFor="let category of outcome; let idx = index" [selected]="category.name==assessment.outcomeDraftLocation">
                <ng-template pTemplate="header">
                    <span [innerHTML]="category.name"></span><i *ngIf="tabIsValid[idx] !== undefined && !tabIsValid[idx]"  pTooltip="Mandatory fields not filled" tooltipPosition="top" class="pi pi-info-circle" style="color: red; font-size: 1rem;"></i>
                </ng-template>
                <form #fData="ngForm">
                    <ng-container *ngIf="category.type === 'GHG'">
                        <ng-container *ngFor="let char of category.results; let idx = index">
                            <h6>{{idx+1}}. {{char.characteristic.name}}</h6>
                            <ng-container *ngIf="category.method === 'SCALE'">
                                <div class="row p-2">
                                    <div class="col-4">Starting Situation</div>
                                    <div class="col-8">
                                        <input type="text" [name]="'stSituation'+char.characteristic.id" #tboundrary="ngModel" [placeholder]="char.characteristic.code === 'INTERNATIONAL' ? ghg_starting_situation_placeholder.international : (char.characteristic.code === 'NATIONAL' ? ghg_starting_situation_placeholder.national : ghg_starting_situation_placeholder.subNational)" [(ngModel)]="char.startingSituation" class="form-control" required />
                                        <p class="info-message text-danger" *ngIf="
                                            (fData.form.controls['stSituation'+char.characteristic.id]?.touched ? 
                                                (char.startingSituation === undefined || char.startingSituation === '')
                                             : char.startingSituation === undefined && clickedFormMap[activeIndex2])
                                            ">
                                            This is a mandatory field
                                        </p>
                                    </div>

                                </div>
                                <div class="row p-2">
                                    <div class="col-4">Expected Impact</div>
                                    <div class="col-8">
                                        <input type="text" [name]="'impact'+char.characteristic.id" #tboundrary="ngModel" placeholder="Please describe the expected emissions reductions on the indicated scale." [(ngModel)]="char.expectedImpact" class="form-control" required />
                                        <p class="info-message text-danger" *ngIf="
                                                (fData.form.controls['impact'+char.characteristic.id]?.touched ? 
                                                    (char.expectedImpact === undefined || char.expectedImpact === '')
                                                : char.expectedImpact === undefined && clickedFormMap[activeIndex2])
                                                ">
                                            This is a mandatory field
                                        </p>
                                    </div>
                                </div>
                                <div class="row p-2">
                                    <div class="col-4">Score <i class="pi pi-info-circle" pTooltip="{{char.characteristic.code === 'INTERNATIONAL' ? GHG_scale_info.macro : (char.characteristic.code === 'NATIONAL' ? GHG_scale_info.medium : GHG_scale_info.micro)}}" tooltipPosition="bottom"
                                            style="font-size: 1rem"></i></div>
                                    <div class="col-6">
                                        <p-dropdown *ngIf="approach !== 'INDIRECT'" [name]="'score'+char.characteristic.id" #type="ngModel" placeholder="Select Score" [(ngModel)]="char.selectedScore" [virtualScroll]="true" [virtualScrollItemSize]="20" [style]="{'width': '100%'}"
                                            [options]="char.characteristic.code === 'INTERNATIONAL' ? GHG_scale_score_macro : (char.characteristic.code === 'NATIONAL' ? GHG_scale_score_medium : GHG_scale_score_micro)" [required]="true" appendTo="body"
                                            (onChange)="onSelectScore($event, char, idx, category.type)" optionLabel="name">
                                            <ng-template let-option pTemplate="item">
                                                <div class="custom-option">
                                                    {{ option.name }}
                                                </div>
                                            </ng-template>
                                        </p-dropdown>
                                        <p class="info-message text-danger" *ngIf="
                                            (fData.form.controls['score'+char.characteristic.id]?.touched ? 
                                                (char.selectedScore.code === undefined || char.selectedScore.code === '')
                                            : char.selectedScore.code === undefined && clickedFormMap[activeIndex2])
                                            ">
                                            This is a mandatory field
                                        </p>
                                        <p-dropdown *ngIf="approach === 'INDIRECT'" name="institution" [options]="institutions" [(ngModel)]="char.institution" #finstitution="ngModel" placeholder="Select an institution" optionLabel="name" [required]="true"></p-dropdown>
                                    </div>
                                </div>
                                <div class="row p-2">
                                    <div class="col-4">Justification</div>
                                    <div class="col-6">
                                        <textarea type="text" rows="5" [name]="'justification'+char.characteristic.id" #tboundrary="ngModel" [(ngModel)]="char.comment" class="form-control" placeholder="Enter Justification" required 
                                        [maxlength]="masterDataService.getFieldCharCount(fieldNames.JUSTIFICATION)"></textarea>
                                        <span style="font-size: 1rem; float: right;">Maximum characters {{masterDataService.getFieldCharCount(fieldNames.JUSTIFICATION)}}</span>
                                        <p class="info-message text-danger" *ngIf="
                                                (fData.form.controls['justification'+char.characteristic.id]?.touched ? 
                                                    (char.comment === undefined || char.comment === '')
                                                : char.comment === undefined && clickedFormMap[activeIndex2])
                                                ">
                                            This is a mandatory field
                                        </p>
                                    </div>
                                    <div class="col-2">
                                        <p-fileUpload mode="basic" chooseIcon="pi pi-upload" chooseLabel="Upload" name="files" [url]="uploadUrl" (onUpload)="onUpload($event,char)" [multiple]="true" accept="{{acceptedFiles}}" [maxFileSize]="5000000" [auto]="true">
                                        </p-fileUpload>
                                    </div>
                                </div>
                                <div class="row p-2" *ngIf="char.filePath">
                                    <div class="col-4"></div>
                                    <div class="col-4">
                                        <p class="col-5">{{char.filePath}}</p>
                                    </div>
                                    <div class="col-4">
                                        <a target="_blank" [href]="fileServerURL+'/'+char.filePath"><i class="pi pi-download download col-4"></i></a>
                                    </div>
                                </div>
                            </ng-container>
                            <ng-container *ngIf="category.method === 'SUSTAINED'">
                                <p>Is the intervention’s GHG outcome sustained over time, i.e. the mitigation continues to accrue beyond the crediting period? Note: this is different from permanence of the achieved mitigation</p>
                                <div class="row p-2">
                                    <div class="col-4">Score</div>
                                    <div class="col-6">
                                        <p-dropdown *ngIf="approach !== 'INDIRECT'" [name]="'score'+char.characteristic.id" #scoreee="ngModel" placeholder="Select Score" [(ngModel)]="char.selectedScore" [virtualScroll]="true" [virtualScrollItemSize]="20" [style]="{'width': '100%'}"
                                            [options]="GHG_sustained_score" optionLabel="name" [required]="true" appendTo="body" (onChange)="onSelectScore($event, char, idx, category.type)">
                                            <ng-template let-option pTemplate="item">
                                                <div class="custom-option">
                                                    {{ option.name }}
                                                </div>
                                            </ng-template>
                                        </p-dropdown>
                                        <p class="info-message text-danger" *ngIf="
                                            (fData.form.controls['score'+char.characteristic.id]?.touched ? 
                                                (char.selectedScore.code === undefined || char.selectedScore.code === '')
                                            : char.selectedScore.code === undefined && clickedFormMap[activeIndex2])
                                            ">
                                            This is a mandatory field
                                        </p>
                                        <p-dropdown *ngIf="approach === 'INDIRECT'" name="institution" [options]="institutions" [(ngModel)]="char.institution" #finstitution="ngModel" placeholder="Select an institution" optionLabel="name" [required]="true"></p-dropdown>
                                    </div>
                                </div>
                                <div class="row p-2">
                                    <div class="col-4">Justification</div>
                                    <div class="col-6">
                                        <textarea rows="5" type="text" [name]="'justification'+char.characteristic.id" #tboundrary="ngModel" [(ngModel)]="char.comment" class="form-control" placeholder="Enter Justification" required 
                                        [maxlength]="masterDataService.getFieldCharCount(fieldNames.JUSTIFICATION)"></textarea>
                                        <span style="font-size: 1rem; float: right;">Maximum characters {{masterDataService.getFieldCharCount(fieldNames.JUSTIFICATION)}}</span>
                                        <p class="info-message text-danger" *ngIf="
                                                (fData.form.controls['justification'+char.characteristic.id]?.touched ? 
                                                    (char.comment === undefined || char.comment === '')
                                                : char.comment === undefined && clickedFormMap[activeIndex2])
                                                ">
                                            This is a mandatory field
                                        </p>
                                    </div>
                                    <div class="col-2">
                                        <p-fileUpload mode="basic" chooseIcon="pi pi-upload" chooseLabel="Upload" name="files" [url]="uploadUrl" (onUpload)="onUpload($event,char)" [multiple]="true" accept="{{acceptedFiles}}" [maxFileSize]="5000000" [auto]="true">
                                        </p-fileUpload>
                                    </div>
                                </div>
                                <div class="row p-2" *ngIf="char.filePath">
                                    <div class="col-4"></div>
                                    <div class="col-4">
                                        <p class="col-5">{{char.filePath}}</p>
                                    </div>
                                    <div class="col-4">
                                        <a target="_blank" [href]="fileServerURL+'/'+char.filePath"><i class="pi pi-download download col-4"></i></a>
                                    </div>
                                </div>
                            </ng-container>
                        </ng-container>
                        <ng-container *ngIf="category.method === 'SUSTAINED'">
                            <h6>GHG Answer</h6>
                            <div class="row p-2">
                                <div class="col-4">Aggregated Answer</div>
                                <div class="col-8">
                                    <input type="text" name="ghgScore" #tboundrary="ngModel" disabled="true" [(ngModel)]="GHGScore" class="form-control" />
                                </div>
                            </div>
                        </ng-container>
                        <div class="row justify-content-end">
                            <div>
                                <div class="d-flex flex-row-reverse mt-20 " *ngIf="activeIndex2 < outcome.length - 1">
                                    <div class="btn btn-primary text-uppercase" (click)="next(category.type+'_'+category.method)">
                                        Next
                                    </div>
                                    <div style="margin-right: 10px;" class="btn btn-primary text-uppercase" (click)="submit(category.type+'_'+category.method, true,category.code,'out')">
                                        Save
                                    </div>
                                </div>
                            </div>
                        </div>
                    </ng-container>
                    <ng-container *ngIf="category.type === 'ADAPTATION'">
                        <ng-container *ngFor="let char of category.results; let idx = index">
                            <h6>{{idx+1}}. {{char.characteristic.name}}</h6>
                            <ng-container *ngIf="category.method === 'SCALE'">
                                <div class="row p-2">
                                    <div class="col-4">Adaptation Co-benifit <i class="pi pi-info-circle" pTooltip="{{adaptation_tooltip}}" tooltipPosition="bottom" style="font-size: 1rem"></i></div>
                                    <div class="col-8">
                                        <input type="text" [name]="'benifit'+char.characteristic.id" #tboundrary="ngModel" [(ngModel)]="char.adaptationCoBenifit" class="form-control" required />
                                        <p class="info-message text-danger" *ngIf="
                                            (fData.form.controls['benifit'+char.characteristic.id]?.touched ? 
                                                (char.adaptationCoBenifit === undefined || char.adaptationCoBenifit === '')
                                            : char.adaptationCoBenifit === undefined && clickedFormMap[activeIndex2])
                                            ">
                                            This is a mandatory field
                                        </p>
                                    </div>
                                </div>
                                <div class="row p-2">
                                    <div class="col-4">Starting Situation <i class="pi pi-info-circle" pTooltip="{{starting_situation_tooltip}}" tooltipPosition="bottom" style="font-size: 1rem"></i></div>
                                    <div class="col-8">
                                        <input type="text" [name]="'stSituation'+char.characteristic.id" #tboundrary="ngModel" [(ngModel)]="char.startingSituation" class="form-control" required />
                                        <p class="info-message text-danger" *ngIf="
                                            (fData.form.controls['stSituation'+char.characteristic.id]?.touched ? 
                                                (char.startingSituation === undefined || char.startingSituation === '')
                                            : char.startingSituation === undefined && clickedFormMap[activeIndex2])
                                            ">
                                            This is a mandatory field
                                        </p>
                                    </div>
                                </div>
                                <div class="row p-2">
                                    <div class="col-4">Expected Impact <i class="pi pi-info-circle" pTooltip="{{expected_impact_tooltip}}" tooltipPosition="bottom" style="font-size: 1rem"></i></div>
                                    <div class="col-8">
                                        <input type="text" [name]="'impact'+char.characteristic.id" #tboundrary="ngModel" [(ngModel)]="char.expectedImpact" class="form-control" required />
                                        <p class="info-message text-danger" *ngIf="
                                            (fData.form.controls['impact'+char.characteristic.id]?.touched ? 
                                                (char.expectedImpact === undefined || char.expectedImpact === '')
                                            : char.expectedImpact === undefined && clickedFormMap[activeIndex2])
                                            ">
                                            This is a mandatory field
                                        </p>
                                    </div>
                                </div>
                                <div class="row p-2">
                                    <div class="col-4">Score <i class="pi pi-info-circle" pTooltip="{{char.characteristic.code === 'INTERNATIONAL' ? adaptation_scale_info.macro : (char.characteristic.code === 'NATIONAL' ? adaptation_scale_info.medium : adaptation_scale_info.micro)}}"
                                            tooltipPosition="bottom" style="font-size: 1rem"></i></div>
                                    <div class="col-6">
                                        <p-dropdown *ngIf="approach !== 'INDIRECT'" [name]="'score'+char.characteristic.id" #type="ngModel" placeholder="Select Score" [(ngModel)]="char.selectedScore" [options]="adaptation_scale_score" [virtualScroll]="true" [virtualScrollItemSize]="20"
                                            [style]="{'width': '100%'}" optionLabel="name" [required]="true" appendTo="body" (onChange)="onSelectScore($event, char, idx, category.type)">
                                            <ng-template let-option pTemplate="item">
                                                <div class="custom-option">
                                                    {{ option.name }}
                                                </div>
                                            </ng-template>
                                        </p-dropdown>
                                        <p class="info-message text-danger" *ngIf="
                                            (fData.form.controls['score'+char.characteristic.id]?.touched ? 
                                                (char.selectedScore.code === undefined || char.selectedScore.code === '')
                                            : char.selectedScore.code === undefined && clickedFormMap[activeIndex2])
                                            ">
                                            This is a mandatory field
                                        </p>
                                        <p-dropdown *ngIf="approach === 'INDIRECT'" name="institution" [options]="institutions" [(ngModel)]="char.institution" #finstitution="ngModel" placeholder="Select an institution" optionLabel="name" [required]="true"></p-dropdown>
                                    </div>
                                </div>
                                <div class="row p-2">
                                    <div class="col-4">Justification</div>
                                    <div class="col-6">
                                        <textarea rows="5" type="text" [name]="'justification'+char.characteristic.id" #tboundrary="ngModel" [(ngModel)]="char.comment" class="form-control" placeholder="Enter Justification" required 
                                        [maxlength]="masterDataService.getFieldCharCount(fieldNames.JUSTIFICATION)"></textarea>
                                        <span style="font-size: 1rem; float: right;">Maximum characters {{masterDataService.getFieldCharCount(fieldNames.JUSTIFICATION)}}</span>
                                        <p class="info-message text-danger" *ngIf="
                                            (fData.form.controls['justification'+char.characteristic.id]?.touched ? 
                                                (char.comment === undefined || char.comment === '')
                                            : char.comment === undefined && clickedFormMap[activeIndex2])
                                            ">
                                            This is a mandatory field
                                        </p>
                                    </div>
                                    <div class="col-2">
                                        <p-fileUpload mode="basic" chooseIcon="pi pi-upload" chooseLabel="Upload" name="files" [url]="uploadUrl" (onUpload)="onUpload($event,char)" [multiple]="true" accept="{{acceptedFiles}}" [maxFileSize]="5000000" [auto]="true">
                                        </p-fileUpload>
                                    </div>
                                </div>
                                <div class="row p-2" *ngIf="char.filePath">
                                    <div class="col-4"></div>
                                    <div class="col-4">
                                        <p class="col-5">{{char.filePath}}</p>
                                    </div>
                                    <div class="col-4">
                                        <a target="_blank" [href]="fileServerURL+'/'+char.filePath"><i class="pi pi-download download col-4"></i></a>
                                    </div>
                                </div>
                            </ng-container>
                            <ng-container *ngIf="category.method === 'SUSTAINED'">
                                <p>Is the intervention’s contribution to the adaptation co-benefit sustained in nature?</p>
                                <div class="row p-2">
                                    <div class="col-4">Score</div>
                                    <div class="col-6">
                                        <p-dropdown *ngIf="approach !== 'INDIRECT'" [name]="'score'+char.characteristic.id" #type="ngModel" placeholder="Select Score" [(ngModel)]="char.selectedScore" [options]="adaptation_sustained_score" optionLabel="name" [required]="true" appendTo="body"
                                            [virtualScroll]="true" [virtualScrollItemSize]="20" [style]="{'width': '100%'}" (onChange)="onSelectScore($event, char, idx, category.type)">
                                            <ng-template let-option pTemplate="item">
                                                <div class="custom-option">
                                                    {{ option.name }}
                                                </div>
                                            </ng-template>
                                        </p-dropdown>
                                        <p class="info-message text-danger" *ngIf="
                                        (fData.form.controls['score'+char.characteristic.id]?.touched ? 
                                            (char.selectedScore.code === undefined || char.selectedScore.code === '')
                                        : char.selectedScore.code === undefined && clickedFormMap[activeIndex2])
                                        ">
                                            This is a mandatory field
                                        </p>
                                        <p-dropdown *ngIf="approach === 'INDIRECT'" name="institution" [options]="institutions" [(ngModel)]="char.institution" #finstitution="ngModel" placeholder="Select an institution" optionLabel="name" [required]="true"></p-dropdown>
                                    </div>
                                </div>
                                <div class="row p-2">
                                    <div class="col-4">Justification</div>
                                    <div class="col-6">
                                        <textarea rows="5" type="text" [name]="'justification'+char.characteristic.id" #tboundrary="ngModel" [(ngModel)]="char.comment" class="form-control" placeholder="Enter Justification" required 
                                        [maxlength]="masterDataService.getFieldCharCount(fieldNames.JUSTIFICATION)"></textarea>
                                        <span style="font-size: 1rem; float: right;">Maximum characters {{masterDataService.getFieldCharCount(fieldNames.JUSTIFICATION)}}</span>
                                        <p class="info-message text-danger" *ngIf="
                                            (fData.form.controls['justification'+char.characteristic.id]?.touched ? 
                                                (char.comment === undefined || char.comment === '')
                                            : char.comment === undefined && clickedFormMap[activeIndex2])
                                            ">
                                            This is a mandatory field
                                        </p>
                                    </div>
                                    <div class="col-2">
                                        <p-fileUpload mode="basic" chooseIcon="pi pi-upload" chooseLabel="Upload" name="files" [url]="uploadUrl" (onUpload)="onUpload($event,char)" [multiple]="true" accept="{{acceptedFiles}}" [maxFileSize]="5000000" [auto]="true">
                                        </p-fileUpload>
                                    </div>
                                </div>
                                <div class="row p-2" *ngIf="char.filePath">
                                    <div class="col-4"></div>
                                    <div class="col-4">
                                        <p class="col-5">{{char.filePath}}</p>
                                    </div>
                                    <div class="col-4">
                                        <a target="_blank" [href]="fileServerURL+'/'+char.filePath"><i class="pi pi-download download col-4"></i></a>
                                    </div>
                                </div>
                            </ng-container>
                        </ng-container>
                        <ng-container *ngIf="category.method === 'SUSTAINED'">
                            <h6>Adaptation Answer</h6>
                            <div class="row p-2">
                                <div class="col-4">Aggregated Answer</div>
                                <div class="col-8">
                                    <input type="text" name="adaptationScore" #tboundrary="ngModel" disabled="true" [(ngModel)]="adaptationScore" class="form-control" />
                                </div>
                            </div>
                        </ng-container>
                        <div class="row justify-content-end">
                            <div>
                                <div class="d-flex flex-row-reverse mt-20 ">
                                    <div *ngIf="activeIndex2 < outcome.length - 1" class="btn btn-primary text-uppercase" (click)="next(category.type+'_'+category.method)">
                                        Next
                                    </div>
                                    <div style="margin-right: 10px;" class="btn btn-primary text-uppercase" (click)="submit(category.type+'_'+category.method, true,category.code,'out')">
                                        Save
                                    </div>
                                </div>
                            </div>
                        </div>
                    </ng-container>
                    <ng-container *ngIf="category.type === 'SD'">
                        <div class="row p-2">
                            <div class="col-4">Choose SDG</div>
                            <div class="col-8">
                                <p-multiSelect name="impact_categories" placeholder="Select SDG(s)" appendTo="body" [options]="sdgList" [(ngModel)]="selectedSDGsList" optionLabel="name" (onChange)="onSelectSDG($event)" [disabled]="category.method === 'SUSTAINED'">
                                </p-multiSelect>
                            </div>
                        </div>
                        <ng-container selectedSDGs && selectedSDGs.length>
                            <ng-container *ngFor="let SDG of selectedSDGs; let sidx = index">
                                <h5> SDG {{SDG.number}} - {{SDG.name}}</h5>
                                <div class="card">
                                    <ng-container *ngIf="category.method === 'SCALE'">
                                        <ng-container *ngFor="let char of SDG.scaleResult; let idx = index;">
                                            <h6>{{idx+1}}. {{char.characteristic.name}}</h6>
                                            <div class="row p-2">
                                                <div class="col-4">SDG Indicator <i class="pi pi-info-circle" pTooltip="Please describe the indicator used to assess the contribution to the selected SDG (i.e. number of jobs created)." tooltipPosition="bottom" style="font-size: 1rem"></i></div>
                                                <div class="col-8">
                                                    <input type="text" [name]="'indicator'+SDG.code+char.characteristic.id" [(ngModel)]="char.sdgIndicator" class="form-control" placeholder="" required />
                                                    <p class="info-message text-danger" *ngIf="
                                                        (fData.form.controls['indicator'+SDG.code+char.characteristic.id]?.touched ? 
                                                            (char.sdgIndicator === undefined || char.sdgIndicator === '')
                                                        : char.sdgIndicator === undefined && clickedFormMap[activeIndex2])
                                                        ">
                                                        This is a mandatory field
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="row p-2">
                                                <div class="col-4">Starting Situation <i class="pi pi-info-circle" pTooltip="Please describe the value of the indicator before intervention implementation." tooltipPosition="bottom" style="font-size: 1rem"></i></div>
                                                <div class="col-8">
                                                    <input type="text" [name]="'stSituation'+SDG.code+char.characteristic.id" [(ngModel)]="char.startingSituation" class="form-control" placeholder="" required />
                                                    <p class="info-message text-danger" *ngIf="
                                                        (fData.form.controls['stSituation'+SDG.code+char.characteristic.id]?.touched ? 
                                                            (char.startingSituation === undefined || char.startingSituation === '')
                                                        : char.startingSituation === undefined && clickedFormMap[activeIndex2])
                                                        ">
                                                        This is a mandatory field
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="row p-2">
                                                <div class="col-4">Expected Impact <i class="pi pi-info-circle" pTooltip="Please describe the value of the indicator after intervention implementation." tooltipPosition="bottom" style="font-size: 1rem"></i></div>
                                                <div class="col-8">
                                                    <input type="text" [name]="'impact'+SDG.code+char.characteristic.id" [(ngModel)]="char.expectedImpact" class="form-control" placeholder="" required />
                                                    <p class="info-message text-danger" *ngIf="
                                                        (fData.form.controls['impact'+SDG.code+char.characteristic.id]?.touched ? 
                                                            (char.expectedImpact === undefined || char.expectedImpact === '')
                                                        : char.expectedImpact === undefined && clickedFormMap[activeIndex2])
                                                        ">
                                                        This is a mandatory field
                                                    </p>
                                                </div>
                                            </div>
                                            <div class="row p-2">
                                                <div class="col-4">Score <i class="pi pi-info-circle" pTooltip="{{char.characteristic.code === 'INTERNATIONAL' ? SD_scale_info.macro : (char.characteristic.code === 'NATIONAL' ? SD_scale_info.medium : SD_scale_info.micro)}}" tooltipPosition="bottom"
                                                        style="font-size: 1rem"></i></div>
                                                <div class="col-8">
                                                    <p-dropdown *ngIf="approach !== 'INDIRECT'" [name]="'score'+SDG.code+char.characteristic.id" #type="ngModel" placeholder="Select Score" [(ngModel)]="char.selectedScore" [virtualScroll]="true" [virtualScrollItemSize]="20" [style]="{'width': '100%'}"
                                                        (onChange)="onSelectScore($event, char, idx, category.type)" [options]="SDG_scale_score" optionLabel="name" [required]="true" appendTo="body">
                                                        <ng-template let-option pTemplate="item">
                                                            <div class="custom-option">
                                                                {{ option.name }}
                                                            </div>
                                                        </ng-template>
                                                    </p-dropdown>
                                                    <p class="info-message text-danger" *ngIf="
                                                        (fData.form.controls['score'+SDG.code+char.characteristic.id]?.touched ? 
                                                            (char.selectedScore.code === undefined || char.selectedScore.code === '')
                                                        : char.selectedScore.code === undefined && clickedFormMap[activeIndex2])
                                                        ">
                                                        This is a mandatory field
                                                    </p>
                                                    <p-dropdown *ngIf="approach === 'INDIRECT'" name="institution" [options]="institutions" [(ngModel)]="char.institution" #finstitution="ngModel" placeholder="Select an institution" optionLabel="name" [required]="true"></p-dropdown>
                                                </div>
                                            </div>
                                            <div class="row p-2">
                                                <div class="col-4">Justification</div>
                                                <div class="col-6">
                                                    <textarea rows="5" type="text" [name]="'justification'+SDG.code+char.characteristic.id" [(ngModel)]="char.comment" class="form-control" placeholder="Enter Justification" required 
                                                    [maxlength]="masterDataService.getFieldCharCount(fieldNames.JUSTIFICATION)"></textarea>
                                                    <span style="font-size: 1rem; float: right;">Maximum characters {{masterDataService.getFieldCharCount(fieldNames.JUSTIFICATION)}}</span>
                                                    <p class="info-message text-danger" *ngIf="
                                                        (fData.form.controls['justification'+SDG.code+char.characteristic.id]?.touched ? 
                                                            (char.comment === undefined || char.comment === '')
                                                        : char.comment === undefined && clickedFormMap[activeIndex2])
                                                        ">
                                                        This is a mandatory field
                                                    </p>
                                                </div>
                                                <div class="col-2">
                                                    <p-fileUpload mode="basic" chooseIcon="pi pi-upload" chooseLabel="Upload" name="files" [url]="uploadUrl" (onUpload)="onUpload($event,char)" [multiple]="true" accept="{{acceptedFiles}}" [maxFileSize]="5000000" [auto]="true">
                                                    </p-fileUpload>
                                                </div>
                                            </div>
                                            <div class="row p-2" *ngIf="char.filePath">
                                                <div class="col-4"></div>
                                                <div class="col-4">
                                                    <p class="col-5">{{char.filePath}}</p>
                                                </div>
                                                <div class="col-4">
                                                    <a target="_blank" [href]="fileServerURL+'/'+char.filePath"><i class="pi pi-download download col-4"></i></a>
                                                </div>
                                            </div>
                                        </ng-container>
                                    </ng-container>
                                    <ng-container *ngIf="category.method === 'SUSTAINED'">
                                        <ng-container *ngFor="let chSus of SDG.sustainResult; let idx = index">
                                            <h6>{{idx+1}}. {{chSus.characteristic.name}}</h6>
                                            <p>Is the activity’s contribution to the selected SDG sustained in nature?</p>
                                            <div class="row p-2">
                                                <div class="col-4">Score</div>
                                                <div class="col-6">
                                                    <p-dropdown *ngIf="approach !== 'INDIRECT'" [name]="'susScore'+SDG.code+chSus.characteristic.id" #type="ngModel" placeholder="Select Score" [(ngModel)]="chSus.selectedScore" [virtualScroll]="true" [virtualScrollItemSize]="20" [style]="{'width': '100%'}"
                                                        (onChange)="onSelectScore($event, chSus, idx, category.type)" [options]="SDG_sustained_score" optionLabel="name" [required]="true" appendTo="body">
                                                        <ng-template let-option pTemplate="item">
                                                            <div class="custom-option">
                                                                {{ option.name }}
                                                            </div>
                                                        </ng-template>
                                                    </p-dropdown>
                                                    <p class="info-message text-danger" *ngIf="
                                                        (fData.form.controls['susScore'+SDG.code+chSus.characteristic.id]?.touched ? 
                                                            (chSus.selectedScore.code === undefined || chSus.selectedScore.code === '')
                                                        : chSus.selectedScore.code === undefined && clickedFormMap[activeIndex2])
                                                        ">
                                                        This is a mandatory field
                                                    </p>
                                                    <p-dropdown *ngIf="approach === 'INDIRECT'" name="institution" [options]="institutions" [(ngModel)]="chSus.institution" #finstitution="ngModel" placeholder="Select an institution" optionLabel="name" [required]="true"></p-dropdown>
                                                </div>
                                            </div>
                                            <div class="row p-2">
                                                <div class="col-4">Justification</div>
                                                <div class="col-6">
                                                    <textarea rows="5" type="text" [name]="'susJustification'+SDG.code+chSus.characteristic.id" [(ngModel)]="chSus.comment" class="form-control" placeholder="Enter Justification" required 
                                                    [maxlength]="masterDataService.getFieldCharCount(fieldNames.JUSTIFICATION)"></textarea>
                                                    <span style="font-size: 1rem; float: right;">Maximum characters {{masterDataService.getFieldCharCount(fieldNames.JUSTIFICATION)}}</span>
                                                    <p class="info-message text-danger" *ngIf="
                                                        (fData.form.controls['susJustification'+SDG.code+chSus.characteristic.id]?.touched ? 
                                                            (chSus.comment === undefined || chSus.comment === '')
                                                        : chSus.comment === undefined && clickedFormMap[activeIndex2])
                                                        ">
                                                        This is a mandatory field
                                                    </p>
                                                </div>
                                                <div class="col-2">
                                                    <p-fileUpload mode="basic" chooseIcon="pi pi-upload" chooseLabel="Upload" name="files" [url]="uploadUrl" (onUpload)="onUpload($event,chSus)" [multiple]="true" accept="{{acceptedFiles}}" [maxFileSize]="5000000" [auto]="true">
                                                    </p-fileUpload>
                                                </div>
                                            </div>
                                            <div class="row p-2" *ngIf="chSus.filePath">
                                                <div class="col-4"></div>
                                                <div class="col-4">
                                                    <p class="col-5">{{chSus.filePath}}</p>
                                                </div>
                                                <div class="col-4">
                                                    <a target="_blank" [href]="fileServerURL+'/'+chSus.filePath"><i class="pi pi-download download col-4"></i></a>
                                                </div>
                                            </div>
                                        </ng-container>
                                    </ng-container>
                                </div>
                            </ng-container>
                            <ng-container *ngIf="category.method === 'SUSTAINED'">
                                <h6>SDG Score</h6>
                                <div class="row p-2">
                                    <div class="col-4">Aggregated Score</div>
                                    <div class="col-8">
                                        <input type="text" name="sdgScore" #tboundrary="ngModel" disabled="true" [(ngModel)]="SDGScore" class="form-control" />
                                    </div>
                                </div>
                            </ng-container>
                        </ng-container>
                        <div class="row justify-content-end" *ngIf="activeIndex2 < outcome.length - 1">
                            <div>
                                <div class="d-flex flex-row-reverse mt-20 ">
                                    <div class="btn btn-primary text-uppercase" (click)="next(category.type+'_'+category.method)">
                                        Next
                                    </div>
                                    <div style="margin-right: 10px;" class="btn btn-primary text-uppercase" (click)="submit(category.type+'_'+category.method, true,category.code,'out')">
                                        Save
                                    </div>
                                </div>
                            </div>
                        </div>
                    </ng-container>
                </form>
                <div class="row justify-content-end" *ngIf="activeIndex2 === outcome.length - 1">
                    <div>
                        <div class="d-flex flex-row-reverse mt-20 ">
                            <button [disabled]="savedData" class="btn btn-primary text-uppercase" (click)="submit('',false,'','')">
                                {{ approach === 'INDIRECT' ? 'Send to Data Collection Team' : 'Calculate & CheckResults'
                                }}
                            </button>
                        </div>
                    </div>
                </div>
            </p-tabPanel>
        </p-tabView>
    </p-tabPanel>
</p-tabView>