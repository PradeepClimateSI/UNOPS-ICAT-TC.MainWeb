<div class="container pl-20 pr-20">
    <div class="mb-12">
        <h4 class="mt-4"> Assessment Information</h4>
    </div>
    <form #fData="ngForm" (ngSubmit)="save(fData)">
        <div class="card" style="min-height: 600px;">
            <div class="p-grid p-fluid col-md-12 col-sm-12">
                <div class="row p-2">
                    <div class="col-12 col-md-6">
                        <div class="p-field p-2">
                            <label for="policy">Select Intervetion *</label>
                            <p-dropdown name="policy" #policy="ngModel" placeholder="Select Intervetion"
                                [(ngModel)]="assessment.climateAction" appendTo="body" [options]="policies"
                                optionLabel="policyName" [required]="true"
                                [disabled]="isSavedAssessment"></p-dropdown>
                            <p class="info-message text-danger" *ngIf="
                                !assessment.climateAction &&
                                (fData.submitted || policy.touched)
                              ">
                                This is a mandatory field
                            </p>
                        </div>
                        <div class="p-field p-2">
                            <label for="policy">Assessment Type *</label>
                            <p-dropdown name="type" #type="ngModel" placeholder="Select Assessment Type"
                                [(ngModel)]="assessment.assessmentType" [options]="assessment_types" optionLabel="name"
                                optionValue="name" [required]="true"
                                appendTo="body"
                                [disabled]="isSavedAssessment"
                                (onChange)="selectAssessmentType($event)"></p-dropdown>
                            <p class="info-message text-danger" *ngIf="
                                !assessment.assessmentType &&
                                (fData.submitted || type.touched)
                              ">
                                This is a mandatory field
                            </p>
                        </div>
                        <div class="p-field p-2">
                            <label for="gac">Geographical Areas Covered*</label>
                            <p-dropdown name="investorAssessment.geographical_areas_covered" #gac="ngModel"
                                placeholder="Select Geographical Areas Covered"
                                [(ngModel)]="investorAssessment.geographical_areas_covered"
                                [options]="levelOfImplementation" optionLabel="name" optionValue="name"
                                [required]="true"
                                [disabled]="isSavedAssessment"
                                appendTo="body">
                            </p-dropdown>
                            <p class="info-message text-danger" *ngIf="
                                !investorAssessment.geographical_areas_covered &&
                                (fData.submitted || gac.touched)
                              ">
                                This is a mandatory field
                            </p>
                            </div>
                        <div class="p-field p-2">
                            <label for="Sectors Covered">Sectors Covered*</label>

                            <p-multiSelect name="sectors" #sectors="ngModel" placeholder="Select Sectors Covered"
                                [(ngModel)]="sectorArray" [options]="sectorList"
                                (ngModelChange)="onItemSelectSectors($event)" optionLabel="name"
                                [required]="true"
                                [disabled]="isSavedAssessment"
                                appendTo="body">
                            </p-multiSelect>
                            <p class="info-message text-danger" *ngIf="
                                sectorArray.length===0 &&
                                (fData.submitted || sectors.touched)
                              ">
                                This is a mandatory field
                            </p>
                            </div>

                        <!-- <div class="p-field p-2">
                            <label for="Sectors Covered">Impacts Covered*</label>
                            <p-multiSelect name="impact" #impacts="ngModel" placeholder="Select Impact Covered"
                                [(ngModel)]="impactArray" [options]="impactCovered"
                                (ngModelChange)="onItemSelectImpacts($event)" optionLabel="name"
                                [required]="true"
                                [disabled]="isSavedAssessment"
                                appendTo="body">
                            </p-multiSelect>
                            <p class="info-message text-danger" *ngIf="
                                impactArray.length===0 &&
                                (fData.submitted || impacts.touched)
                              ">
                                This is a mandatory field
                            </p>
                        </div>
     -->
                        <div class="p-field p-2">

                            <label for="date1">Assessment Period*</label>
                            <div class="p-inputgroup">
                                <span class="p-inputgroup-addon">
                                    <i class="pi pi-calendar"></i>
                                </span>
                                <p-calendar dateFormat="mm-dd-yy" inputId="date1" placeholder="From"
                                    [(ngModel)]="assessment.from" name="date1" #date1="ngModel"  [disabled]="isSavedAssessment" [required]="true" appendTo="body"  [disabled]="isSavedAssessment">
                                   </p-calendar>
                                <span class="p-inputgroup-addon">to</span>
                                <p-calendar dateFormat="mm-dd-yy" inputId="date2" placeholder="To"
                                    [(ngModel)]="assessment.to" name="date2" #date2="ngModel"  [disabled]="isSavedAssessment"  [required]="true" appendTo="body" [disabled]="isSavedAssessment"></p-calendar>

                            </div>
                            <div class="col-12">
                                <p class="info-message text-danger" *ngIf="(date1.invalid || date2.invalid) && (fData.submitted || date1.touched || date2.touched)">
                                    This is a mandatory field
                                  </p>
                            </div>

                        </div>
                        <div class="p-field p-2">
                            <label for="opportunities">Opportunities for stakeholders to participate in the assessment *</label>
                            <input pInputText type="text" #opportunities="ngModel" name="opportunities" ngModel
                            placeholder="Opportunities" [(ngModel)]="assessment.opportunities" required [disabled]="isSavedAssessment"/>
                            <p class="info-message text-danger" *ngIf="!opportunities.value && (fData.submitted || opportunities.touched)">This is a mandatory field</p>
                      </div>

                      <div class="p-field p-2">
                            <label for="principles">Principles on which the assessment is based *</label>
                            <input pInputText type="text" #principles="ngModel" name="principles" ngModel
                            placeholder="Principles" [(ngModel)]="assessment.principles" required [disabled]="isSavedAssessment"/>
                            <p class="info-message text-danger" *ngIf="!principles.value && (fData.submitted || principles.touched)">This is a mandatory field</p>
                      </div>

                            <!-- <div class="p-field p-2">
                            <label for="Sectors Covered">Assessment Method*</label>
                            <p-dropdown name="type" #method="ngModel" placeholder="Select Assessment Method"
                                [(ngModel)]="assessment.assessment_method" [options]="assessmentMethods"  appendTo="body"
                                optionLabel="name" optionValue="name"></p-dropdown>
                            <p class="info-message text-danger" *ngIf="
                                !assessment.assessment_method &&
                                (fData.submitted || method.touched)
                              ">
                                This is a mandatory field
                            </p>
                            </div> -->
                        <!-- <div class="p-field p-2">
                                <label for="Sectors Covered">Assessment Approach*</label>
                                <p-dropdown name="approach" #assessApproach="ngModel" placeholder="Select Assessment Method"
                                    [(ngModel)]="assessment.assessment_approach" [options]="assessmentApproach"  appendTo="body"
                                    (ngModelChange)="onAssessmentApproachchange(assessment.assessment_approach)" [required]="true"
                                    [disabled]="isSavedAssessment"
                                    optionLabel="name" optionValue="name"></p-dropdown>
                                <p class="info-message text-danger" *ngIf="
                                    !assessment.assessment_approach &&
                                    (fData.submitted || assessApproach.touched)
                                  ">
                                    This is a mandatory field
                                </p>
                            </div>
                        <div class="p-field p-2">
                                    <label for="Sectors Covered">Type of Investment</label>
                                    <p-dropdown
                                        name="investment_type"
                                        #investment_type="ngModel"
                                         placeholder="Select type of investment"
                                        [(ngModel)]="investorAssessment.investment_type"
                                        [options]="investmentType"  appendTo="body"

                                        [disabled]="isSavedAssessment"
                                        optionLabel="name" optionValue="name"></p-dropdown>

                        </div> -->


                    </div>
                </div>
                <!-- <div class="row p-2">
                    <div class="col-12 col-md-6">
                        <div class="p-field p-2">
                            <label for="Level of implementation">Level of implementation*</label>
                            <p-dropdown name="investorAssessment.level_of_implemetation" #levelofimpl="ngModel"
                                placeholder="Select Level of implementation"
                                [(ngModel)]="investorAssessment.level_of_implemetation"
                                appendTo="body"
                                [options]="levelOfImplementation" optionLabel="name" optionValue="name"
                                (ngModelChange)="onLevelofImplementationChange($event)"
                                [disabled]="isSavedAssessment"
                                [required]="true"></p-dropdown>
                            <p class="info-message text-danger" *ngIf="
                                !investorAssessment.level_of_implemetation &&
                                (fData.submitted || levelofimpl.touched)
                              ">
                                This is a mandatory field
                            </p>
                        </div>

                    </div>
                    <div *ngIf="levelofImplementation ===1" class="col-12 col-md-6">
                        <div class="p-field p-2">
                            <label for="Level of implementation">Enter country*</label>
                            <input type="text" pInputText
                              #country="ngModel"
                              [required]="true"
                              placeholder="Enter country"
                              [(ngModel)]="investorAssessment.national_country"
                              [disabled]="isSavedAssessment"
                              name="country" />
                            <p class="info-message text-danger" *ngIf="
                                !investorAssessment.national_country &&
                                (fData.submitted || country.touched)
                              ">
                                This is a mandatory field
                            </p>
                        </div>

                    </div>

                    <div *ngIf="levelofImplementation ===2" class="col-12 col-md-6">
                        <div class="p-field p-2">
                            <label for="Level of implementation">Enter region*</label>
                            <input type="text" pInputText
                              #country="ngModel"
                              [required]="true"
                              placeholder="Enter region"
                              [disabled]="isSavedAssessment"
                              [(ngModel)]="investorAssessment.subnational_region"
                              name="country" />
                            <p class="info-message text-danger" *ngIf="
                                !investorAssessment.subnational_region &&
                                (fData.submitted || country.touched)
                              ">
                                This is a mandatory field
                            </p>
                        </div>

                    </div>



                </div> -->
                <div class="row p-2">
                    <div class="col-12 col-md-6">

                    </div>



                </div>

            </div>
            <div class="row justify-content-end" *ngIf="!isSavedAssessment">
                <div>

                    <div class="d-flex flex-row-reverse  ">
                        <button class="btn btn-primary text-uppercase" type="submit">
                            Continue
                        </button>
                    </div>
                </div>
            </div>
        </div>


    </form>
    <!-- <div class="p-grid p-fluid col-sm-12" *ngIf="showSections">
        <app-cm-section [assessment]="assessmentres"></app-cm-section>
    </div> -->
    <!-- <div class="card" *ngIf="isSavedAssessment && tabLoading"> -->
        <div class="card" >
        <form #fData1="ngForm" (ngSubmit)="onsubmit(fData1)" >
        <p-tabView  (onChange)="onMainTabChange($event) " [(activeIndex)]="activeIndexMain ">

            <p-tabPanel  header="Process of Change" >
                <!-- <div *ngFor="let characteristic of meth1Process"> -->

                <p-tabView #tabView (onChange)="onCategoryTabChange($event, tabView)" [(activeIndex)]="activeIndex "    >

                    <p-tabPanel [header]="category.CategoryName" *ngFor="let category of processData" >

                        <div class="characteristic-Topic " *ngFor="let data of category.data; index as i">
                            <h6>{{i+1}}.{{data.characteristics.name}}</h6>
                            <div>

                                    <div class="container pl-20 pr-20">
                                        <div id="content" #content>
                                            <div class=" mt-2">
                                                <div class="p-grid p-fluid col-12">
                                                    <div class="row p-2">


                                                                <div class="col-2">
                                                                    <label for="Description">Relevance*</label>
                                                                </div>
                                                                <div class="col-4">
                                                                    <p-dropdown  
                                                                    name="data.charData.relavance"
                                                                    #rel="ngModel"
                                                                    placeholder="Select Relevance"
                                                                    [(ngModel)]="data.relavance"
                                                                    [options]="relevance" optionLabel="name"
                                                                    appendTo="body"
                                                                    optionValue="value" [required]="true"></p-dropdown>
                                                                    <p class="info-message text-danger" *ngIf="data.relavance ==null  && (fData1.submitted || rel.touched) ">
                                                                      This is a mandatory field </p>

                                                                    <!-- <p-dropdown  *ngIf="approach===2"
                                                                    name="data.charData.relavance"
                                                                    placeholder="Select Institution"
                                                                    [(ngModel)]="data.relavance"
                                                                    [options]="instiTutionList"
                                                                    optionLabel="name"
                                                                    appendTo="body"
                                                                    optionValue="id"
                                                                   [required]="true"></p-dropdown> -->
                                                                </div>



                                                        <!-- <div class="col-12 col-lg-6"   *ngIf="approach===1">
                                                            <div class="p-field">
                                                                <label for="justification">Justification</label>
                                                                <input type="text" pInputText
                                                                    [(ngModel)]="data.justification"
                                                                    placeholder="Enter Justifiaction"
                                                                    name="justification" />

                                                            </div>
                                                        </div> -->
                                                    </div>

                                                    <div class="row p-2">
                                                        <!-- <div class="col-12 col-lg-6">
                                                            <div class="p-field">
                                                                <label for="Description">Description</label>
                                                                <textarea
                                                                  name="{{data.characteristics.name}}_description"
                                                                    placeholder="Description" rows="5" cols="60"
                                                                    pInputTextarea
                                                                    [(ngModel)]="data.description"
                                                                    autoResize="autoResize"
                                                                    class="p-inputtext"></textarea>
                                                            </div>
                                                        </div> -->

                                                            <div class="col-2">
                                                              <label for="Description">Description</label>
                                                            </div>
                                                            <div class="col-10">
                                                              <!-- <label for="Description">{{question.question.description}}</label> -->
                                                              <p style="text-align: justify;">{{data.characteristics.investmentDescription}}</p>
                                                            </div>


                                                        <!-- <div class="col-12 col-lg-6">
                                                            <div class="p-field">
                                                                <label for="StartingSituation">Starting
                                                                    Situation</label>
                                                                <textarea name="Starting Situation"
                                                                    placeholder="Starting Situation" rows="5" cols="60"
                                                                    pInputTextarea
                                                                    [(ngModel)]="data.starting_situation"
                                                                    autoResize="autoResize"
                                                                    class="p-inputtext"></textarea>

                                                            </div>
                                                        </div> -->
                                                    </div>


                                                    <div class="row p-2">
                                                        <!-- <label for="Indicator"><u>Indicator</u></label> -->
                                                        <div class="row" *ngFor="let question of data.indicator_details">
                                                            <label *ngIf="question.question.isMain" for="Indicator" class="mt-10 mb-10"><u>{{question.question.name}}</u></label>

                                                             <div class="row" *ngIf="!question.question.isMain">
                                                                <div  class=" ml-25 col-6 mb-20">
                                                                    <p  class="question">{{question.question.name}}</p>
                                                                    <div class="tooltip-container">
                                                                      <div *ngIf="question.question.tooltip">
                                                                        <span class="tooltip-icon">i</span>
                                                                        <div class="tooltip-text" [innerHTML]="addNewline(question.question.tooltip)"></div>
                                  
                                                                      </div>
                                                                    </div>
                                                                 </div>


                                                                 <div class="col-4 mb-20">

                                                                    <p-dropdown *ngIf="approach===1"
                                                                        name="data.charData.question01" #type="ngModel"
                                                                        placeholder="Select Answer"
                                                                        [(ngModel)]="question.value"
                                                                        [options]="yesNoAnswer" optionLabel="name"
                                                                        appendTo="body"
                                                                        optionValue="name">
                                                                    </p-dropdown>
                                                                    <p-dropdown  *ngIf="approach===2"
                                                                        name={{data}}_charData.relavance
                                                                        placeholder="Select Institution"
                                                                        [(ngModel)]="question.value"
                                                                        [options]="instiTutionList" optionLabel="name"
                                                                        appendTo="body"
                                                                        optionValue="id" >
                                                                    </p-dropdown>

                                                                 </div>

                                                                 
                                                             </div>
                                                             
                                                             <div class="row" *ngIf="!question.question.isMain">
                                                                <div class=" ml-25 col-6 mb-20">

                                                                    <p class="justifiaction" class="question">Comment and justification*</p>
                                                                  </div>
                                                                  <div class="col-4 mb-20">
                                                                    <input type="text" pInputText
                                                                    [(ngModel)]="question.justification"
                                                                    placeholder="Enter Justification"
                                                                    #questionJustification="ngModel"
                                                                    name="questionJustification" />
                                                                    <p class="info-message text-danger" *ngIf="!question.justification  && (fData1.submitted || questionJustification.touched) ">
                                                                      This is a mandatory field </p>

                                                                 </div>
                                                             </div>



                                                        </div>

                                                    </div>

                                                    <div class="row p-2">
                                                        <div class="col-12 col-lg-6">
                                                            <div class="p-field" >
                                                                <label for="likelihood" >Likelihood*</label>
                                                                <p-dropdown 
                                                                    appendTo="body"
                                                                    name="data.charData.likelihood"
                                                                    #likelihood2="ngModel" 
                                                                    placeholder="Select Likelihood"
                                                                    [(ngModel)]="data.likelihood"
                                                                    [options]="likelihood" optionLabel="id"
                                                                    optionValue="value" [required]="true"
                                                                    ></p-dropdown>
                                                                    <p class="info-message text-danger" *ngIf="data.likelihood ==null && (fData1.submitted || likelihood2.touched) ">
                                                                      This is a mandatory field </p>
                                                                    <!-- <p-dropdown  *ngIf="approach===2"
                                                                    name={{data}}_charData.relavance
                                                                    placeholder="Select Institution"
                                                                    [(ngModel)]="data.likelihood"
                                                                    [options]="instiTutionList" optionLabel="name"
                                                                    appendTo="body"
                                                                    optionValue="id" [required]="true">
                                                                </p-dropdown> -->

                                                            </div>
                                                        </div>

                                                        <div class="col-12 col-lg-6" *ngIf="approach===1">
                                                            <div class="p-field">
                                                                <label for="justification">Justification*</label>
                                                                <input type="text" pInputText
                                                                    [(ngModel)]="data.likelihood_justification" #just1="ngModel"
                                                                    placeholder="Enter Justification"
                                                                    name="data.charData.likelihood_justification" />
                                                                    <p class="info-message text-danger" *ngIf="!data.likelihood_justification  && (fData1.submitted || just1.touched) ">
                                                                      This is a mandatory field </p>

                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row p-2">
                                                        <label for="question">Supporting Documentation</label>
                                                </div>

                                                  <div class="row p-2 align-items-center">
                                                    <div class="col-2 d-flex align-items-center">
                                                      <p-fileUpload mode="basic" chooseIcon="pi pi-upload" chooseLabel="Upload" name="files"
                                                        [url]="uploadUrl" (onUpload)="onUpload($event,data)" [multiple]="true"
                                                        accept="{{acceptedFiles}}" [maxFileSize]="5000000" [auto]="true">
                                                      </p-fileUpload>
                                                    </div>

                                                    <div class="col-2 d-flex align-items-center" *ngIf="data.uploadedDocumentPath">
                                                      <p>{{data.uploadedDocumentPath}}</p>
                                                    </div>

                                                    <div class="col-2 d-flex align-items-center" *ngIf="data.uploadedDocumentPath">
                                                      <a target="_blank" [href]="fileServerURL+'/'+data.uploadedDocumentPath"><i
                                                          class="pi pi-download download"></i></a>
                                                    </div>
                                                  </div>

                                                    <!-- <div class="row p-2">
                                                        <div class="col-12 col-lg-6">
                                                            <div class="p-field">
                                                                <label for="Relevance">Relevance Weight (%)</label>
                                                                <p-inputNumber inputId="locale-us" mode="decimal"
                                                                    [min]="0" [max]="100"
                                                                    locale="en-US"
                                                                    [minFractionDigits]="2"
                                                                    [(ngModel)]="data.relevance_weight"
                                                                    placeholder="Enter Relevance Weight"
                                                                    name="data.charData.relevance_weight"
                                                                    (ngModelChange)="onRelevanceWeightChange(category.CategoryName,data.characteristics.name, $event)">
                                                                </p-inputNumber>
                                                             <div *ngIf="!chaCategoryTotalEqualsTo1[category.CategoryName] && initialRelevance !==0" style="color: red;">
                                                                  Relevance weights for characteristics of {{category.CategoryName}} category should sum up to 100%.
                                                                  <br>
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <div class="col-12 col-lg-6">
                                                            <div class="p-field">
                                                                <label for="Relevance">Likelihood Weight (%)</label>
                                                                <p-inputNumber inputId="locale-us" mode="decimal"
                                                                    [min]="0" [max]="100"
                                                                    locale="en-US"
                                                                    [minFractionDigits]="2"
                                                                    [(ngModel)]="data.likelihood_weight"
                                                                    placeholder="Enter Likelihood Weight"
                                                                    name="data.charData.likelihood_weight"
                                                                    (ngModelChange)="onLikelihoodWeightChange(category.CategoryName,data.characteristics.name, $event)">
                                                                </p-inputNumber>

                                                              <div *ngIf="!chaCategoryLikelihoodTotalEqualsTo1[category.CategoryName] && initialLikelihood !==0 " style="color: red;">
                                                                  Likelihood weights for characteristics of {{category.CategoryName}} category should sum up to 100%.
                                                                  <br>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div> -->
                                                </div>
                                            </div>

                                        </div>
                                    </div>



                            </div>
                        </div>




                    </p-tabPanel>






                </p-tabView>
                <!-- </div> -->
            </p-tabPanel>

            <p-tabPanel header="Outcome of Change">
              <p-tabView #tabView2 (onChange)="onCategoryTabChange($event, tabView2) " [(activeIndex)]="activeIndex2">

                <p-tabPanel *ngFor="let category of outcomeData">

                  <ng-template pTemplate="header">
                    <!-- Use a container div for the header -->
                    <div class="custom-tab-header">{{ category.CategoryName }}</div>
                  </ng-template>

                  <div *ngIf="category.CategoryName === 'SDG Scale of the Outcome' ">
                    <div class="row">
                      <div class="col-2 ">
                        <p>Select those SDGs impacted by the intervention : </p>
                      </div>

                      <div class="col-4 ">
                        <p-multiSelect appendTo="body" name="sdgs" placeholder="Select SDGs" [(ngModel)]="selectedSDGs"
                          [options]="sdgList" (ngModelChange)="onItemSelectSDGs($event)" optionLabel="name"
                          ></p-multiSelect>
                      </div>

                      <div class="col-5 "></div>
                    </div>
                  </div>


                  <div
                    *ngIf="category.CategoryName !== 'SDG Scale of the Outcome' && category.CategoryName !== 'SDG Time frame over which the outcome is sustained'  ">
                    <div class="characteristic-Topic" *ngFor="let data of category.data; index as i">
                      <h6>{{i+1}}.{{data.characteristics.name}}</h6>
                      <div>
                        <form>
                          <div class="container pl-20 pr-20">
                            <div id="content" #content>
                              <div class=" mt-2">
                                <div class="p-grid p-fluid col-12">

                                  <!-- <div class="row p-2">
                                    <div class="col-12 col-lg-12">
                                      <div class="p-field">
                                        <label for="indicator">Indicator</label>
                                        <input type="text" pInputText [(ngModel)]="data.indicator"
                                          placeholder="Indicator Name" name="indicator" />
                                      </div>
                                    </div>
                                  </div>

                                  <div class="row p-2">
                                    <div class="col-12 col-lg-6">
                                      <div class="p-field">
                                        <label for="indicatorStartingVal">Indicator Starting Situation Value</label>
                                        <p-inputNumber [(ngModel)]="data.indicatorStartingVal"
                                          name="indicatorStartingVal" placeholder="Value at the Starting Situation"
                                          inputId="locale-us" mode="decimal" locale="en-US" [minFractionDigits]="2">
                                        </p-inputNumber>
                                      </div>
                                    </div>

                                    <div class="col-12 col-lg-6">
                                      <div class="p-field">
                                        <label for="indicatorExpectedVal">Indicator Expected Value</label>
                                        <p-inputNumber [(ngModel)]="data.indicatorExpectedVal"
                                          name="indicatorExpectedVal" placeholder="Expected Value" inputId="locale-us"
                                          mode="decimal" locale="en-US" [minFractionDigits]="2">
                                        </p-inputNumber>

                                      </div>
                                    </div>
                                  </div> -->


                                  <div class="row p-2">
                                    <div class="row" *ngFor="let question of data.indicator_details">
                                     <label for="question">{{question.question.name}} </label>

                                     <!--    <div class="tooltip-container">
                                          <div *ngIf="question.question.hint">
                                           <span class="tooltip-icon">i</span> </div>
                                          <div class="tooltip-text">{{addNewline(question.question.hint)}}</div>
                                      </div> -->
                                    </div>
                                </div>

                                <!-- Newwwwwww -->
                                <div class="row p-2" *ngIf=" category.CategoryName ==='GHG Scale of the Outcome' && data.characteristics.name === 'International/global level'">
                                  <p>3 - reduction in emissions > 0.1% of global emissions</p>
                                  <p>2 - reduction in emissions > 0.05% of global emissions</p>
                                  <p>1 - reduction in emissions > 0.01% of global emissions</p>
                                  <p>0 - reduction in emissions < 0.01% of global emissions</p>
                                  <p>minus 3 - any emissions increase</p><br><br>
                                  <p>Note: all reduction in emissions calculated as average reduction
                                     in emissions (tCO2e/yr calculated as total estimated reductions over
                                     lifetime of the project divided by project lifetime) and compared to global
                                      emissions for the latest year for which those emissions data is available </p>
                                </div>

                                <div class="row p-2" *ngIf=" category.CategoryName ==='GHG Scale of the Outcome' && data.characteristics.name === 'National/Sectorial level'">
                                  <p>3 - reduction in emissions > 1% of national/sectoral emissions</p>
                                  <p>2 - reduction in emissions equal to 0.5 - 1% of national/sectoral emissions</p>
                                  <p>1 - reduction in emissions equal to 0.1 - 0.5% of national/sectoral emissions</p>
                                  <p>0 - reduction in emissions less than 0.1% of national/sectoral emissions</p>
                                  <p>minus 3 - any emissions increase</p><br><br>
                                  <p>Note: all reduction in emissions calculated as average reduction in emissions
                                     (tCO2e/yr calculated as total estimated reductions over lifetime of the project divided
                                      by project lifetime) and compared to national/sectoral emissions for the latest year for
                                       which those emissions data is available </p>
                                </div>

                                <div class="row p-2" *ngIf=" category.CategoryName ==='GHG Scale of the Outcome' && data.characteristics.name === 'Subnational/regional/municipal or sub sectorial level'">
                                  <p>3 - reduction in emissions > 5% of subnational/regional/municipal emissions or subsectoral level</p>
                                  <p>2 - reduction in emissions equal to 1 - 5% subnational/regional/municipal emissions or subsectoral level</p>
                                  <p>1 - reduction in emissions equal to 0.5 - 1% of subnational/regional/municipal emissions or subsectoral level</p>
                                  <p>0 - reduction in emissions less than 0.5% of subnational/regional/municipal emissions or subsectoral level</p>
                                  <p>minus 3 - any emissions increase</p><br><br>
                                  <p>Note: all reduction in emissions calculated as average reduction in emissions (tCO2e/yr calculated
                                     as total estimated reductions over lifetime of the project divided by project lifetime) and
                                      compared to subnational/regional/municipal emissions or subsectoral level emissions for the
                                      latest year for which those emissions data is available </p>
                                </div>
                                <!-- Newwwwwww - Endddd -->


                                  <div class="row p-2">

                                   <!--  <div class="col-12 col-lg-6">
                                      <div class="p-field">
                                        <label for="Relevance">Score</label>
                                        <p-inputNumber inputId="integeronly" [(ngModel)]="data.score"
                                          [showButtons]="true" [min]="-1" [max]="3" [step]="1" inputId="minmax-buttons"
                                          placeholder="Enter Score" name="data.charData.score"> </p-inputNumber>
                                      </div>
                                    </div> -->

                                    <div class="col-12 col-lg-6">
                                      <div class="p-field">
                                        <label for="score">Score</label>
                                        <div *ngIf=" category.CategoryName ==='GHG Scale of the Outcome' ||  category.CategoryName ==='Adaptation Scale of the Outcome' ">
                                        <p-dropdown appendTo="body" name="score" #type="ngModel"
                                          placeholder="Select Score" [(ngModel)]="data.score"
                                          [options]="outcomeScaleScore" optionLabel="id" optionValue="value"
                                         ></p-dropdown></div>

                                          <div *ngIf=" category.CategoryName ==='GHG Time frame over which the outcome is sustained' ||  category.CategoryName ==='Adaptation Time frame over which the outcome is sustained' ">
                                            <p-dropdown appendTo="body" name="score" #type="ngModel"
                                              placeholder="Select Score" [(ngModel)]="data.score"
                                              [options]="outcomeSustainedScore" optionLabel="id" optionValue="value"
                                              ></p-dropdown></div>
                                      </div>
                                    </div>

                                    <div class="col-12 col-lg-6">
                                      <div class="p-field">
                                        <label for="justification">Justification*</label>
                                        <input type="text" pInputText [(ngModel)]="data.justification" #just2="ngModel"
                                          placeholder="Enter Justification" name="justification" />
                                          <p class="info-message text-danger" *ngIf="!data.justification  && (fData1.submitted || just2.touched) ">
                                            This is a mandatory field </p>

                                      </div>
                                    </div>
                                  </div>


                                  <!-- lllllllllllllllllllllllllllll -->
                              <div class="row p-2 align-items-center">
                                <div class="col-2 d-flex align-items-center">
                                  <p-fileUpload mode="basic" chooseIcon="pi pi-upload" chooseLabel="Upload" name="files"
                                    [url]="uploadUrl" (onUpload)="onUpload($event,data)" [multiple]="true"
                                    accept="{{acceptedFiles}}" [maxFileSize]="5000000" [auto]="true">
                                  </p-fileUpload>
                                </div>

                                <div class="col-2 d-flex align-items-center" *ngIf="data.uploadedDocumentPath">
                                  <p>{{data.uploadedDocumentPath}}</p>
                                </div>

                                <div class="col-2 d-flex align-items-center" *ngIf="data.uploadedDocumentPath">
                                  <a target="_blank" [href]="fileServerURL+'/'+data.uploadedDocumentPath"><i
                                      class="pi pi-download download"></i></a>
                                </div>
                              </div>


                              <!-- lllllllllllllllllllllllllllll -->


                              <div class="row p-2"
                              *ngIf=" category.CategoryName ==='GHG Scale of the Outcome' && data.characteristics.name === 'Subnational/regional/municipal or sub sectorial level' ">
                              <div class="col-12 col-lg-6">
                                <div class="p-field">
                                  <label for="expected_ghg_mitigation">Expected GHG mitgation (Mt CO2-eq)</label>
                                  <p-inputNumber [(ngModel)]="data.expected_ghg_mitigation" name="expected_ghg_mitigation"
                                      placeholder="Expected GHG mitgation Value" inputId="locale-us" mode="decimal"
                                    locale="en-US" [minFractionDigits]="2">
                                  </p-inputNumber>
                                  </div>
                                </div>

                                <div *ngIf="category.CategoryName ==='GHG Scale of the Outcome'" style="text-align: justify;">
                                  <p>  <br><br>
                                    Note: all reduction in emissions calculated as average reduction in emissions
                                    (tCO2e/yr calculated as total estimated reductions over lifetime of the project
                                    divided by project lifetime) and compared respectively to global, national/sectoral or
                                    subnational and subsectorial emissions for the latest year for which those emissions data
                                    is available
                                  </p>
                                </div>

                                </div>


                              </div>
                            </div>
                          </div>
                        </div>
                        </form>

                      </div>
                    </div>
                  </div>

                  <div *ngIf="category.CategoryName === 'SDG Scale of the Outcome'">
                    <div *ngFor="let item of sdgDataSendArray2; index as i">
                      <br>
                      <h6>SDG {{ selectedSDGs[i].number }} - {{ selectedSDGs[i].name }}</h6>

                      <div class="row">
                        <div class="col-8">
                          <p>Could the intervention have an impact on this particular SDG?</p>
                        </div>
                        <div class="col-4">
                          <p-dropdown appendTo="body" name="type" #type="ngModel" placeholder="Select Answer"
                          [(ngModel)]="selectedSDGs[i].answer" [options]="sdg_answers" optionLabel="name"
                          optionValue="name"  ></p-dropdown>
                        </div>
                      </div>

                      <div class="characteristic-Topic" *ngFor="let data of item.data; index as j">
                        <h6>{{ j+1 }}.{{ data.characteristics.name }}</h6>
                        <div>
                          <form>
                            <div class="container pl-20 pr-20">
                              <div id="content" #content>
                                <div class=" mt-2">
                                  <div class="p-grid p-fluid col-12">


                                   <!--  <div class="row p-2">
                                      <div class="col-12 col-lg-12">
                                        <div class="p-field">
                                          <label for="indicator">Indicator</label>
                                          <input type="text" (ngModelChange)="assignSDG(selectedSDGs[i], data)"
                                            pInputText [(ngModel)]="data.indicator" placeholder="Indicator Name"
                                            name="indicator" />
                                        </div>
                                      </div>
                                    </div> -->

                                    <!-- <div class="row p-2">
                                      <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="indicatorStartingVal">Indicator Starting Situation Value</label>
                                          <p-inputNumber (ngModelChange)="assignSDG(selectedSDGs[i], data)"
                                            [(ngModel)]="data.indicatorStartingVal" name="indicatorStartingVal"
                                            placeholder="Value at the Starting Situation" inputId="locale-us"
                                            mode="decimal" locale="en-US" [minFractionDigits]="2"></p-inputNumber>
                                        </div>
                                      </div>

                                      <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="indicatorExpectedVal">Indicator Expected Value</label>
                                          <p-inputNumber (ngModelChange)="assignSDG(selectedSDGs[i], data)"
                                            [(ngModel)]="data.indicatorExpectedVal" name="indicatorExpectedVal"
                                            placeholder="Expected Value" inputId="locale-us" mode="decimal"
                                            locale="en-US" [minFractionDigits]="2"></p-inputNumber>
                                        </div>
                                      </div>
                                    </div> -->

                                    <div class="row p-2">
                                      <div class="row" *ngFor="let question of data.indicator_details">
                                       <label for="question">{{question.question.name}} </label>

                                         <!--  <div class="tooltip-container">
                                            <div *ngIf="question.question.hint">
                                             <span class="tooltip-icon">i</span> </div>
                                            <div class="tooltip-text">{{addNewline(question.question.hint)}}</div>
                                        </div> -->
                                      </div>
                                  </div>

                                    <div class="row p-2">

                                     <!--  <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="Relevance">Score</label>
                                          <p-inputNumber (ngModelChange)="assignSDG(selectedSDGs[i], data)"
                                            inputId="integeronly" [(ngModel)]="data.score" [showButtons]="true"
                                            [min]="-1" [max]="3" [step]="1" inputId="minmax-buttons"
                                            placeholder="Enter Score" name="data.charData.score"></p-inputNumber>
                                        </div>
                                      </div> -->

                                      <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="score">Score</label>
                                          <p-dropdown appendTo="body" name="score" #type="ngModel"
                                            placeholder="Select Score" [(ngModel)]="data.score" (ngModelChange)="assignSDG(selectedSDGs[i], data)"
                                            [options]="outcomeScaleScore" optionLabel="id" optionValue="value"
                                           ></p-dropdown>
                                        </div>
                                      </div>

                                      <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="justification">Justification*</label>
                                          <input (ngModelChange)="assignSDG(selectedSDGs[i], data)" type="text"
                                            pInputText [(ngModel)]="data.justification" #just3="ngModel"
                                            placeholder="Enter Justification" name="justification" />
                                            <p class="info-message text-danger" *ngIf="!data.justification  && (fData1.submitted || just3.touched) ">
                                              This is a mandatory field </p>
                                        </div>
                                      </div>
                                    </div>

                                    <!-- lllllllllllllllllllllllllllll -->
                                    <div class="row p-2 align-items-center">
                                      <div class="col-2 d-flex align-items-center">
                                        <p-fileUpload mode="basic" chooseIcon="pi pi-upload" chooseLabel="Upload"
                                          name="files" [url]="uploadUrl" (onUpload)="onUpload($event,data)"
                                          [multiple]="true" accept="{{acceptedFiles}}" [maxFileSize]="5000000"
                                          [auto]="true">
                                        </p-fileUpload>
                                      </div>

                                      <div class="col-2 d-flex align-items-center" *ngIf="data.uploadedDocumentPath">
                                        <p>{{data.uploadedDocumentPath}}</p>
                                      </div>

                                      <div class="col-2 d-flex align-items-center" *ngIf="data.uploadedDocumentPath">
                                        <a target="_blank" [href]="fileServerURL+'/'+data.uploadedDocumentPath"><i
                                            class="pi pi-download download"></i></a>
                                      </div>
                                    </div>


                                    <!-- lllllllllllllllllllllllllllll -->


                                  </div>
                                </div>
                              </div>
                            </div>
                          </form>
                        </div>
                      </div>
                    </div>
                  </div>



                  <div *ngIf="category.CategoryName === 'SDG Time frame over which the outcome is sustained'  ">

                    <div *ngFor="let item of sdgDataSendArray4; index as i">
                      <br>
                      <h6>SDG {{ selectedSDGs[i].number }} - {{ selectedSDGs[i].name }}</h6>
                      <div class="characteristic-Topic" *ngFor="let data of item.data; index as j">
                        <h6>{{ j+1 }}.{{ data.characteristics.name }}</h6>
                        <div>
                          <form>
                            <div class="container pl-20 pr-20">
                              <div id="content" #content>
                                <div class=" mt-2">
                                  <div class="p-grid p-fluid col-12">

                                   <!--  <div class="row p-2">
                                      <div class="col-12 col-lg-12">
                                        <div class="p-field">
                                          <label for="indicator">Indicator</label>
                                          <input (ngModelChange)="assignSDG(selectedSDGs[i], data)" type="text"
                                            pInputText [(ngModel)]="data.indicator" placeholder="Indicator Name"
                                            name="indicator" />
                                        </div>
                                      </div>
                                    </div> -->

                                   <!--  <div class="row p-2">
                                      <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="indicatorStartingVal">Indicator Starting Situation Value</label>
                                          <p-inputNumber (ngModelChange)="assignSDG(selectedSDGs[i], data)"
                                            [(ngModel)]="data.indicatorStartingVal" name="indicatorStartingVal"
                                            placeholder="Value at the Starting Situation" inputId="locale-us"
                                            mode="decimal" locale="en-US" [minFractionDigits]="2"></p-inputNumber>
                                        </div>
                                      </div>

                                      <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="indicatorExpectedVal">Indicator Expected Value</label>
                                          <p-inputNumber (ngModelChange)="assignSDG(selectedSDGs[i], data)"
                                            [(ngModel)]="data.indicatorExpectedVal" name="indicatorExpectedVal"
                                            placeholder="Expected Value" inputId="locale-us" mode="decimal"
                                            locale="en-US" [minFractionDigits]="2"></p-inputNumber>
                                        </div>
                                      </div>
                                    </div> -->

                                    <div class="row p-2">
                                      <div class="row" *ngFor="let question of data.indicator_details">
                                       <label for="question">{{question.question.name}} </label>

                                         <!--  <div class="tooltip-container">
                                            <div *ngIf="question.question.hint">
                                             <span class="tooltip-icon">i</span> </div>
                                            <div class="tooltip-text">{{addNewline(question.question.hint)}}</div>
                                        </div> -->
                                      </div>
                                  </div>

                                    <div class="row p-2">

                                     <!--  <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="Relevance">Score</label>
                                          <p-inputNumber (ngModelChange)="assignSDG(selectedSDGs[i], data)"
                                            inputId="integeronly" [(ngModel)]="data.score" [showButtons]="true"
                                            [min]="-1" [max]="3" [step]="1" inputId="minmax-buttons"
                                            placeholder="Enter Score" name="data.charData.score"></p-inputNumber>
                                        </div>
                                      </div> -->

                                      <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="score">Score</label>
                                          <p-dropdown appendTo="body" name="score" #type="ngModel"
                                            placeholder="Select Score" [(ngModel)]="data.score" (ngModelChange)="assignSDG(selectedSDGs[i], data)"
                                            [options]="outcomeSustainedScore" optionLabel="id" optionValue="value"
                                            ></p-dropdown>
                                        </div>
                                      </div>

                                      <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="justification">Justification*</label>
                                          <input (ngModelChange)="assignSDG(selectedSDGs[i], data)" type="text"
                                            pInputText [(ngModel)]="data.justification" #just4="ngModel"
                                            placeholder="Enter Justification" name="justification" />
                                            <p class="info-message text-danger" *ngIf="!data.justification  && (fData1.submitted || just4.touched) ">
                                              This is a mandatory field </p>
                                        </div>
                                      </div>
                                    </div>

                                    <!-- lllllllllllllllllllllllllllll -->
                                    <div class="row p-2 align-items-center">
                                      <div class="col-2 d-flex align-items-center">
                                        <p-fileUpload mode="basic" chooseIcon="pi pi-upload" chooseLabel="Upload"
                                          name="files" [url]="uploadUrl" (onUpload)="onUpload($event,data)"
                                          [multiple]="true" accept="{{acceptedFiles}}" [maxFileSize]="5000000"
                                          [auto]="true">
                                        </p-fileUpload>
                                      </div>

                                      <div class="col-2 d-flex align-items-center" *ngIf="data.uploadedDocumentPath">
                                        <p>{{data.uploadedDocumentPath}}</p>
                                      </div>

                                      <div class="col-2 d-flex align-items-center" *ngIf="data.uploadedDocumentPath">
                                        <a target="_blank" [href]="fileServerURL+'/'+data.uploadedDocumentPath"><i
                                            class="pi pi-download download"></i></a>
                                      </div>
                                    </div>


                                    <!-- lllllllllllllllllllllllllllll -->


                                  </div>
                                </div>
                              </div>
                            </div>
                          </form>
                        </div>
                      </div>
                    </div>

                  </div>



                </p-tabPanel>

              </p-tabView>
            </p-tabPanel>


        </p-tabView>

        <div  *ngIf="activeIndex2===5 && activeIndexMain===1" class="row justify-content-end">
            <div>
                <!-- <div class=" col-md-10 offset-md-4" style="color:red" >
                    <div class="col align-self-end" *ngIf="failedLikelihoodArray.length!=0">
                       Please make sure to set Likelihood weights for
                       <span  *ngFor="let data of failedLikelihoodArray ; let last = last" class="array-item">
                           {{data.category}}<span  *ngIf="!last">, </span>
                        </span > should sum up to 100%.

                    </div>
                    <div class="col align-self-end" *ngIf="failedRelevanceArray.length!=0">
                        Please make sure to set Relevance weights for <span  *ngFor="let data of failedRelevanceArray ; let last = last" class="array-item">
                            {{data.category}} <span  *ngIf="!last">, </span>
                         </span > should sum up to 100%.


                    </div>
                </div> -->



                <div
                class="d-flex flex-row-reverse mt-20 ">
                    <button class="btn btn-primary text-uppercase" type="submit" [disabled]="failedLikelihoodArray.length!=0 ||failedRelevanceArray.length!=0 || !fData1.valid">
                        {{approach==1 ?'Calculate & Check results': (approach==2 ?'Send to Data Collection Team':'')}}
                    </button>
                </div>
            </div>
        </div>

        <div    *ngIf="activeIndex2!==5 || activeIndexMain!==1" class="row justify-content-end">
            <div>

                <div
                class="d-flex flex-row-reverse mt-20 ">
                    <div class="btn btn-primary text-uppercase" (click)="next()" [class.disabled]="(!isLikelihoodDisabled || !isRelavanceDisabled)">

                       Next
                    </div>
                </div>
            </div>
        </div>







    </form>
<!-- <ng-template #elseblock> -->


<!-- </ng-template> -->

    </div>


</div>
