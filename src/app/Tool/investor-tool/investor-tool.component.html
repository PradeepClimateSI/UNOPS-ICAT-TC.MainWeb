<div class="container pl-20 pr-20">
    <div class="mb-12">
        <h4 class="mt-4"> Assess Investment & Private Sector Transformational Change</h4>
    </div>
    <form #fData="ngForm" (ngSubmit)="save(fData)">
        <div class="card" style="min-height: 600px;">
            <div class="p-grid p-fluid col-md-12 col-sm-12">
                <div class="row p-2">
                    <div class="col-12 col-md-6">
                        <div class="p-field p-2">
                            <label for="policy">Select Intervetion *</label>
                            <p-dropdown name="policy" #policy="ngModel" placeholder="Select Policy"
                                [(ngModel)]="assessment.climateAction" appendTo="body" [options]="policies"
                                optionLabel="policyName" [required]="true"></p-dropdown>
                            <p class="info-message text-danger" *ngIf="
                                !assessment.climateAction &&
                                (fData.submitted || policy.touched)
                              ">
                                This is a mandatory field
                            </p>
                        </div>
                        <div class="p-field p-2">
                            <label for="policy">Assessment Type *</label>
                            <p-dropdown name="type" #type="ngModel" placeholder="Select Assessment Type"
                                [(ngModel)]="assessment.assessmentType" [options]="assessment_types" optionLabel="name"
                                optionValue="name" [required]="true"
                                appendTo="body"
                                (onChange)="selectAssessmentType($event)"></p-dropdown>
                            <p class="info-message text-danger" *ngIf="
                                !assessment.assessmentType &&
                                (fData.submitted || type.touched)
                              ">
                                This is a mandatory field
                            </p>
                        </div>


                    </div>
                </div>
                <div class="row p-2">
                    <div class="col-12 col-md-6">
                        <div class="p-field p-2">
                            <label for="Level of implementation">Level of implementation*</label>
                            <p-dropdown name="investorAssessment.level_of_implemetation" #levelofimpl="ngModel"
                                placeholder="Select Level of implementation"
                                [(ngModel)]="investorAssessment.level_of_implemetation"
                                appendTo="body"
                                [options]="levelOfImplementation" optionLabel="name" optionValue="name"
                                (ngModelChange)="onLevelofImplementationChange($event)"
                                [required]="true"></p-dropdown>
                            <p class="info-message text-danger" *ngIf="
                                !investorAssessment.level_of_implemetation &&
                                (fData.submitted || levelofimpl.touched)
                              ">
                                This is a mandatory field
                            </p>
                        </div>

                    </div>
                    <div *ngIf="levelofImplementation ===1" class="col-12 col-md-6">
                        <div class="p-field p-2">
                            <label for="Level of implementation">Enter country*</label>
                            <input type="text" pInputText
                              #country="ngModel"
                              [required]="true"
                              placeholder="Enter country"
                              [(ngModel)]="investorAssessment.national_country"
                              name="country" />
                            <p class="info-message text-danger" *ngIf="
                                !investorAssessment.national_country &&
                                (fData.submitted || country.touched)
                              ">
                                This is a mandatory field
                            </p>
                        </div>

                    </div>

                    <div *ngIf="levelofImplementation ===2" class="col-12 col-md-6">
                        <div class="p-field p-2">
                            <label for="Level of implementation">Enter region*</label>
                            <input type="text" pInputText
                              #country="ngModel"
                              [required]="true"
                              placeholder="Enter region"
                              [(ngModel)]="investorAssessment.subnational_region"
                              name="country" />
                            <p class="info-message text-danger" *ngIf="
                                !investorAssessment.subnational_region &&
                                (fData.submitted || country.touched)
                              ">
                                This is a mandatory field
                            </p>
                        </div>

                    </div>



                </div>
                <div class="row p-2">
                    <div class="col-12 col-md-6">
                    <div class="p-field p-2">
                        <label for="Level of implementation">Geographical Areas Covered*</label>
                        <p-dropdown name="investorAssessment.geographical_areas_covered" #type="ngModel"
                            placeholder="Select Geographical Areas Covered"
                            [(ngModel)]="investorAssessment.geographical_areas_covered"
                            [options]="levelOfImplementation" optionLabel="name" optionValue="name"
                            [required]="true"></p-dropdown>
                        <p class="info-message text-danger" *ngIf="
                            !investorAssessment.geographical_areas_covered &&
                            (fData.submitted || type.touched)
                          ">
                            This is a mandatory field
                        </p>
                        </div>
                        <div class="p-field p-2">
                        <label for="Sectors Covered">Sectors Covered*</label>

                        <p-multiSelect name="sectors" #type="ngModel" placeholder="Select Sectors Covered"
                            [(ngModel)]="sectorArray" [options]="sectorList"
                            (ngModelChange)="onItemSelectSectors($event)" optionLabel="name"
                            [required]="true"></p-multiSelect>
                        <p class="info-message text-danger" *ngIf="
                            sectorArray.length===0 &&
                            (fData.submitted || type.touched)
                          ">
                            This is a mandatory field
                        </p>
                        </div>

                        <div class="p-field p-2">
                        <label for="Sectors Covered">Impact Covered*</label>
                        <p-multiSelect name="impact" #type="ngModel" placeholder="Select Impact Covered"
                            [(ngModel)]="impactArray" [options]="impactCovered"
                            (ngModelChange)="onItemSelectImpacts($event)" optionLabel="name"
                            [required]="true"></p-multiSelect>
                        <p class="info-message text-danger" *ngIf="
                            impactArray.length===0 &&
                            (fData.submitted || type.touched)
                          ">
                            This is a mandatory field
                        </p>
                        </div>

                        <div class="p-field p-2">

                        <label for="date1">Assessment Period</label>
                        <div class="p-inputgroup">
                            <span class="p-inputgroup-addon">
                                <i class="pi pi-calendar"></i>
                            </span>
                            <p-calendar dateFormat="mm-dd-yy" inputId="date1" placeholder="From"
                                [(ngModel)]="assessment.from" name="date1"></p-calendar>
                            <span class="p-inputgroup-addon">to</span>
                            <p-calendar dateFormat="mm-dd-yy" inputId="date2" placeholder="To"
                                [(ngModel)]="assessment.to" name="date2"></p-calendar>
                        </div>
                        </div>

                        <div class="p-field p-2">
                        <label for="Sectors Covered">Assessment Method*</label>
                        <p-dropdown name="type" #type="ngModel" placeholder="Select Assessment Method"
                            [(ngModel)]="assessment.assessment_method" [options]="assessmentMethods"  appendTo="body"
                            optionLabel="name" optionValue="name"></p-dropdown>
                        <!-- <p class="info-message text-danger" *ngIf="
                            !assessment.assessment_method &&
                            (fData.submitted || type.touched)
                          ">
                            This is a mandatory field
                        </p> -->
                        </div>
                        <div class="p-field p-2">
                            <label for="Sectors Covered">Assessment Approach*</label>
                            <p-dropdown name="approach" #assessApproach="ngModel" placeholder="Select Assessment Method"
                                [(ngModel)]="assessment.assessment_approach" [options]="assessmentApproach"  appendTo="body"
                                (ngModelChange)="onAssessmentApproachchange(assessment.assessment_approach)" [required]="true"
                                optionLabel="name" optionValue="name"></p-dropdown>
                            <p class="info-message text-danger" *ngIf="
                                !assessment.assessment_approach &&
                                (fData.submitted || assessApproach.touched)
                              ">
                                This is a mandatory field
                            </p>
                            </div>
                    </div>



                </div>

            </div>
            <div class="row justify-content-end" *ngIf="!isSavedAssessment">
                <div>

                    <div class="d-flex flex-row-reverse  ">
                        <button class="btn btn-primary text-uppercase" type="submit">
                            Continue
                        </button>
                    </div>
                </div>
            </div>
        </div>


    </form>
    <!-- <div class="p-grid p-fluid col-sm-12" *ngIf="showSections">
        <app-cm-section [assessment]="assessmentres"></app-cm-section>
    </div> -->
    <!-- <div class="card" *ngIf="isSavedAssessment"> -->
        <div class="card" >
        <form #fData1="ngForm" (ngSubmit)="onsubmit(fData1)" >
        <p-tabView  (onChange)="onMainTabChange($event) " [(activeIndex)]="activeIndexMain ">

            <p-tabPanel  header="Process of Change">
                <!-- <div *ngFor="let characteristic of meth1Process"> -->

                <p-tabView #tabView (onChange)="onCategoryTabChange($event, tabView)" [(activeIndex)]="activeIndex "    >

                    <p-tabPanel [header]="category.CategoryName" *ngFor="let category of processData" >



                        <div class="characteristic-Topic" *ngFor="let data of category.data; index as i">
                            <h6>{{i+1}}.{{data.characteristics.name}}</h6>
                            <div>

                                    <div class="container pl-20 pr-20">
                                        <div id="content" #content>
                                            <div class=" mt-2">
                                                <div class="p-grid p-fluid col-12">

                                                    <div class="row p-2">
                                                        <div class="col-12 col-lg-6">
                                                            <div class="p-field">
                                                                <label for="Description">Description</label>
                                                                <textarea
                                                                  name="{{data.characteristics.name}}_description"
                                                                    placeholder="Description" rows="5" cols="60"
                                                                    pInputTextarea
                                                                    [(ngModel)]="data.description"
                                                                    autoResize="autoResize"
                                                                    class="p-inputtext"></textarea>
                                                            </div>
                                                        </div>

                                                        <div class="col-12 col-lg-6">
                                                            <div class="p-field">
                                                                <label for="StartingSituation">Starting
                                                                    Situation</label>
                                                                <textarea name="Starting Situation"
                                                                    placeholder="Starting Situation" rows="5" cols="60"
                                                                    pInputTextarea
                                                                    [(ngModel)]="data.starting_situation"
                                                                    autoResize="autoResize"
                                                                    class="p-inputtext"></textarea>

                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="row p-2">
                                                        <div class="col-12 col-lg-6">
                                                            <div class="p-field">
                                                                <label for="Description">Relevance</label>
                                                                <p-dropdown  *ngIf="approach===1"
                                                                    name="data.charData.relavance"
                                                                    #type="ngModel"
                                                                    placeholder="Select Relevance"
                                                                    [(ngModel)]="data.relavance"
                                                                    [options]="relevance" optionLabel="name"
                                                                    appendTo="body"
                                                                    optionValue="value" [required]="true"></p-dropdown>

                                                                    <p-dropdown  *ngIf="approach===2"
                                                                    name="data.charData.relavance"
                                                                    placeholder="Select Institution"
                                                                    [(ngModel)]="data.relavance"
                                                                    [options]="instiTutionList" 
                                                                    optionLabel="name"
                                                                    appendTo="body"
                                                                    optionValue="id"
                                                                   [required]="true"></p-dropdown>   
                                                            </div>
                                                        </div>

                                                        <div class="col-12 col-lg-6"   *ngIf="approach===1">
                                                            <div class="p-field">
                                                                <label for="justification">Justification</label>
                                                                <input type="text" pInputText
                                                                    [(ngModel)]="data.justification"
                                                                    placeholder="Enter Justifiaction"
                                                                    name="justification" />

                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row p-2">
                                                        <label for="Indicator"><u>Indicator</u></label>
                                                        <div class="row" *ngFor="let question of data.indicator_details">
                                                            <div class=" ml-25 col-5 mb-20">
                                                        
                                                            <p class="question">{{question.question.name}}</p>
                                                          </div>
                                                          <div 
                                                            class="col-4 mb-20">
                                                            <p-dropdown *ngIf="approach===1"
                                                                name="data.charData.question01" #type="ngModel"
                                                                placeholder="Select Answer"
                                                                [(ngModel)]="question.value"
                                                                [options]="yesNoAnswer" optionLabel="name"
                                                                appendTo="body"
                                                                optionValue="name" [required]="true">
                                                            </p-dropdown>
                                                            <p-dropdown  *ngIf="approach===2"
                                                                name={{data}}_charData.relavance
                                                                placeholder="Select Institution"
                                                                [(ngModel)]="question.value"
                                                                [options]="instiTutionList" optionLabel="name"
                                                                appendTo="body"
                                                                optionValue="id" [required]="true">
                                                            </p-dropdown> 

                                                        </div>
                                                        </div>

                                                    </div>

                                                    <div class="row p-2">
                                                        <div class="col-12 col-lg-6">
                                                            <div class="p-field">
                                                                <label for="likelihood">Likelihood</label>
                                                                <p-dropdown *ngIf="approach===1" 
                                                                    name="data.charData.likelihood"
                                                                    #type="ngModel" placeholder="Select Likelihood"
                                                                    [(ngModel)]="data.likelihood"
                                                                    [options]="likelihood" optionLabel="id"
                                                                    optionValue="value" [required]="true"
                                                                    appendTo="body"></p-dropdown>

                                                                    <p-dropdown  *ngIf="approach===2"
                                                                    name={{data}}_charData.relavance
                                                                    placeholder="Select Institution"
                                                                    [(ngModel)]="data.likelihood"
                                                                    [options]="instiTutionList" optionLabel="name"
                                                                    appendTo="body"
                                                                    optionValue="id" [required]="true">
                                                                </p-dropdown> 

                                                            </div>
                                                        </div>

                                                        <div class="col-12 col-lg-6" *ngIf="approach===1">
                                                            <div class="p-field">
                                                                <label for="justification">Justification</label>
                                                                <input type="text" pInputText
                                                                    [(ngModel)]="data.likelihood_justification"
                                                                    placeholder="Enter Justifiaction"
                                                                    name="data.charData.likelihood_justification" />

                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="row p-2">
                                                        <div class="col-12 col-lg-6">
                                                            <div class="p-field">
                                                                <label for="Relevance">Relevance Weight (%)</label>
                                                                <p-inputNumber inputId="locale-us" mode="decimal"
                                                                     locale="en-US" [minFractionDigits]="2"
                                                                    [(ngModel)]="data.relevance_weight"
                                                                    placeholder="Enter Relevance Weight"
                                                                    name="data.charData.relevance_weight"
                                                                    (ngModelChange)="onRelevanceWeightChange(category.CategoryName,data.characteristics.name, $event)">
                                                                </p-inputNumber>
                                                             <div *ngIf="!chaCategoryTotalEqualsTo1[category.CategoryName]" style="color: red;">
                                                                  Relevance weights for characteristics of {{category.CategoryName}} category should sum up to 100%.
                                                                  <br>
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <div class="col-12 col-lg-6">
                                                            <div class="p-field">
                                                                <label for="Relevance">Likelihood Weight (%)</label>
                                                                <p-inputNumber inputId="locale-us" mode="decimal"
                                                                     locale="en-US" [minFractionDigits]="2"
                                                                    [(ngModel)]="data.likelihood_weight"
                                                                    placeholder="Enter Likelihood Weight"
                                                                    name="data.charData.likelihood_weight"
                                                                    (ngModelChange)="onLikelihoodWeightChange(category.CategoryName,data.characteristics.name, $event)">
                                                                </p-inputNumber>

                                                              <div *ngIf="!chaCategoryLikelihoodTotalEqualsTo1[category.CategoryName]" style="color: red;">
                                                                  Likelihood weights for characteristics of {{category.CategoryName}} category should sum up to 100%.
                                                                  <br>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                    </div>



                            </div>
                        </div>




                    </p-tabPanel>






                </p-tabView>
                <!-- </div> -->
            </p-tabPanel>
            <p-tabPanel header="Outcome of Change">
                <p-tabView #tabView2 (onChange)="onCategoryTabChange($event, tabView2) " [(activeIndex)]="activeIndex2">

                    <p-tabPanel [header]="category.CategoryName" *ngFor="let category of outcomeData">

                        <div class="characteristic-Topic" *ngFor="let data of category.data; index as i">
                            <h6>{{i+1}}.{{data.characteristics.name}}</h6>
                            <div>
                                <form>
                                    <div class="container pl-20 pr-20">
                                        <div id="content" #content>
                                            <div class=" mt-2">
                                                <div class="p-grid p-fluid col-12">
                                                    <div class="row p-2">
                                                        <label for="Indicator"><u>Indicator</u></label>
                                                        <div class="row" *ngFor="let question of data.indicator_details">
                                                            <div class=" ml-25 col-5 mb-20">
                                                        
                                                            <p class="question">{{question.question.name}}</p>
                                                          </div>
                                                          <div 
                                                            class="col-4 mb-20">
                                                            <p-dropdown  *ngIf="approach===1"
                                                                name="data.charData.question01" #type="ngModel"
                                                                placeholder="Select Answer"
                                                                [(ngModel)]="question.value"
                                                                [options]="yesNoAnswer" optionLabel="name"
                                                                appendTo="body"
                                                                optionValue="name" [required]="true">
                                                            </p-dropdown>

                                                            <p-dropdown  *ngIf="approach===2"
                                                                name={{data}}_charData.relavance
                                                                placeholder="Select Institution"
                                                                [(ngModel)]="question.value"
                                                                [options]="instiTutionList" optionLabel="name"
                                                                appendTo="body"
                                                                optionValue="id" [required]="true">
                                                            </p-dropdown> 

                                                            </div>
                                                        </div>

                                                    </div>

                                                    <div class="row p-2"
                                                        *ngIf=" category.CategoryName ==='Scale SD'|| category.CategoryName ==='Sustained nature-SD'">
                                                        <div class="col-12 col-lg-12">
                                                            <div class="p-field">
                                                                <input type="text" pInputText
                                                                    [(ngModel)]="data.indicator"
                                                                    placeholder="Enter an Indicator"
                                                                    name="justification" />
                                                            </div>
                                                            <!-- need to add on requirement -->
                                                            <!-- <div class="col-12 col-lg-6">
                                                            <div class="p-field">
                                                                <label for="justification">Justification</label>
                                                                <input type="text" pInputText
                                                                    [(ngModel)]="data.charData.justification"
                                                                    placeholder="Enter Justifiaction"
                                                                    name="justification" />


                                                        </div> -->
                                                        </div>
                                                    </div>

                                                    <div class="row p-2" *ngIf=" approach===1 && (category.CategoryName ==='Scale SD'|| category.CategoryName ==='Sustained nature-SD')">
                                                        <div class="col-12 col-lg-6">
                                                          <div class="p-field">
                                                            <label for="indicatorStartingVal">Indicator Starting Situation Value</label>
                                                            <p-inputNumber [(ngModel)]="data.indicatorStartingVal" name="indicatorStartingVal"
                                                              placeholder="Value at the Starting Situation" inputId="locale-us" mode="decimal"
                                                              locale="en-US" [minFractionDigits]="2">
                                                            </p-inputNumber>
                                                          </div>
                                                        </div>

                                                        <div class="col-12 col-lg-6">
                                                          <div class="p-field">
                                                            <label for="indicatorExpectedVal">Indicator Expected Value</label>
                                                            <p-inputNumber [(ngModel)]="data.indicatorExpectedVal" name="indicatorExpectedVal"
                                                              placeholder="Expected Value" inputId="locale-us" mode="decimal" locale="en-US"
                                                              [minFractionDigits]="2">
                                                            </p-inputNumber>

                                                          </div>
                                                        </div>
                                                      </div>




                                                    <div class="row p-2">
                                                        <div class="col-12 col-lg-6">
                                                            <div class="p-field">
                                                                <label for="Relevance">Score</label>
                                                                <p-inputNumber *ngIf="approach===1"
                                                                    inputId="horizontal"
                                                                    [(ngModel)]="data.score"  
                                                                    [showButtons]="true" [min]="-1" [max]="3" [step]="1"
                                                                    inputId="minmax-buttons"
                                                                    placeholder="Enter an integer between -1 and 3"
                                                                    name="data.charData.score"> 
                                                                </p-inputNumber>

                                                                
                                                                <p-dropdown  *ngIf="approach===2"
                                                                    name={{data}}_charData.relavance
                                                                    placeholder="Select Institution"
                                                                    [(ngModel)]="data.score"  
                                                                    [options]="instiTutionList" optionLabel="name"
                                                                    appendTo="body"
                                                                    optionValue="id" [required]="true">
                                                                </p-dropdown> 
                                                            </div>
                                                        </div>

                                                        <div   *ngIf="approach===1" class="col-12 col-lg-6">
                                                            <div class="p-field">
                                                                <label for="justification">Justification</label>
                                                                <input type="text" pInputText
                                                                    [(ngModel)]="data.justification"
                                                                    placeholder="Enter Justifiaction"
                                                                    name="justification" />

                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="row p-2" *ngIf="categoryTabIndex===0 && mainTabIndex===1 && category.CategoryName ==='Scale GHGs' && data.characteristics.name === 'Micro Level'">
                                                        <div class="col-12 col-lg-6">
                                                          <div class="p-field">
                                                            <label for="expected_ghg_mitigation">Expected GHG mitgation (Mt CO2-eq)</label>
                                                            <p-inputNumber *ngIf="approach===1"
                                                              [(ngModel)]="data.expected_ghg_mitigation" name="expected_ghg_mitigation"
                                                              placeholder="Expected GHG mitgation Value" inputId="locale-us" mode="decimal"
                                                              locale="en-US" [minFractionDigits]="2">
                                                            </p-inputNumber>

                                                            <p-dropdown  *ngIf="approach===2"
                                                                name={{data}}_charData.relavance
                                                                placeholder="Select Institution"
                                                                [(ngModel)]="data.expected_ghg_mitigation"
                                                                [options]="instiTutionList" optionLabel="name"
                                                                appendTo="body"
                                                                optionValue="id" [required]="true">
                                                            </p-dropdown> 
                                                          </div>
                                                        </div>


                                                      </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                </form>

                            </div>
                        </div>



                    </p-tabPanel>




                </p-tabView>
            </p-tabPanel>

        </p-tabView>

        <div  *ngIf="activeIndex2===3 && activeIndexMain===1" class="row justify-content-end">
            <div>

                <div
                class="d-flex flex-row-reverse mt-20 ">
                    <button class="btn btn-primary text-uppercase" type="submit" >
                        Calculate & Check results
                    </button>
                </div>
            </div>
        </div>

        <div    *ngIf="activeIndex2!==3 || activeIndexMain!==1" class="row justify-content-end">
            <div>

                <div
                class="d-flex flex-row-reverse mt-20 ">
                    <div class="btn btn-primary text-uppercase" (click)="next()" >
                       Next
                    </div>
                </div>
            </div>
        </div>







    </form>
<!-- <ng-template #elseblock> -->


<!-- </ng-template> -->

    </div>


</div>
