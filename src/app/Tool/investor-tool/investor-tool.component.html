<div class="container pl-20 pr-20">
    <div class="mb-12">
        <h4 class="mt-4"> Assessment Information</h4>
    </div>
    <form #fData="ngForm" (ngSubmit)="save(fData)">
        <div class="card" style="min-height: 600px;">
            <div class="p-grid p-fluid col-md-12 col-sm-12">
                <div class="row p-2">
                    <div class="col-12 col-md-6">
                        <div class="p-field p-2">
                            <label for="policy">Select Intervetion *</label>
                            <p-dropdown name="policy" #policy="ngModel" placeholder="Select Intervetion"
                                [(ngModel)]="assessment.climateAction" appendTo="body" [options]="policies"
                                optionLabel="policyName" [required]="true"
                                [disabled]="isSavedAssessment || isEditMode"></p-dropdown>
                            <p class="info-message text-danger" *ngIf="
                                !assessment.climateAction &&
                                (fData.submitted || policy.touched)
                              ">
                                This is a mandatory field
                            </p>
                        </div>
                        <div class="p-field p-2">
                            <label for="policy">Assessment Type *</label>
                            <p-dropdown name="type" #type="ngModel" placeholder="Select Assessment Type"
                                [(ngModel)]="assessment.assessmentType" [options]="assessment_types" optionLabel="name"
                                optionValue="name" [required]="true"
                                appendTo="body"
                                [disabled]="isSavedAssessment|| isEditMode"
                                (onChange)="selectAssessmentType($event)"></p-dropdown>
                            <p class="info-message text-danger" *ngIf="
                                !assessment.assessmentType &&
                                (fData.submitted || type.touched)
                              ">
                                This is a mandatory field
                            </p>
                        </div>
                        <div class="p-field p-2">
                            <label for="gac">Geographical Areas Covered*</label>
                            <p-multiSelect name="investorAssessment.geographical_areas_covered" #gac="ngModel"
                                placeholder="Select Geographical Areas Covered"
                                [(ngModel)]="geographicalAreasCoveredArr"
                                [options]="levelOfImplementation" optionLabel="name"
                                [required]="true"
                                [disabled]="isSavedAssessment|| isEditMode"
                                appendTo="body">
                            </p-multiSelect>
                            <p class="info-message text-danger" *ngIf="
                                  geographicalAreasCoveredArr.length===0 &&
                                  (fData.submitted || sectors.touched)
                                ">
                                  This is a mandatory field
                              </p>
                            </div>
                        <div class="p-field p-2">
                            <label for="Sectors Covered">Sectors Covered*</label>

                            <p-multiSelect name="sectors" #sectors="ngModel" placeholder="Select Sectors Covered"
                                [(ngModel)]="sectorArray" [options]="sectorList"
                                (ngModelChange)="onItemSelectSectors($event)" optionLabel="name"
                                [required]="true"
                                [disabled]="isSavedAssessment|| isEditMode"
                                appendTo="body">
                            </p-multiSelect>
                            <p class="info-message text-danger" *ngIf="
                                sectorArray.length===0 &&
                                (fData.submitted || sectors.touched)
                              ">
                                This is a mandatory field
                            </p>
                            </div>

                        <!-- <div class="p-field p-2">
                            <label for="Sectors Covered">Impacts Covered*</label>
                            <p-multiSelect name="impact" #impacts="ngModel" placeholder="Select Impact Covered"
                                [(ngModel)]="impactArray" [options]="impactCovered"
                                (ngModelChange)="onItemSelectImpacts($event)" optionLabel="name"
                                [required]="true"
                                [disabled]="isSavedAssessment"
                                appendTo="body">
                            </p-multiSelect>
                            <p class="info-message text-danger" *ngIf="
                                impactArray.length===0 &&
                                (fData.submitted || impacts.touched)
                              ">
                                This is a mandatory field
                            </p>
                        </div>
     -->
                        <div class="p-field p-2">

                            <label for="date1">Assessment Period*</label>
                            <div class="p-inputgroup">
                                <span class="p-inputgroup-addon">
                                    <i class="pi pi-calendar"></i>
                                </span>
                                <p-calendar dateFormat="mm-dd-yy" inputId="date1" placeholder="From"
                                    [(ngModel)]="assessment.from" name="date1" #date1="ngModel"  [disabled]="isSavedAssessment|| isEditMode" [required]="true" appendTo="body"  [disabled]="isSavedAssessment">
                                   </p-calendar>
                                <span class="p-inputgroup-addon">to</span>
                                <p-calendar dateFormat="mm-dd-yy" inputId="date2" placeholder="To"
                                    [(ngModel)]="assessment.to" name="date2" #date2="ngModel"  [disabled]="isSavedAssessment|| isEditMode"  [required]="true" appendTo="body" [disabled]="isSavedAssessment"></p-calendar>

                            </div>
                            <div class="col-12">
                                <p class="info-message text-danger" *ngIf="(date1.invalid || date2.invalid) && (fData.submitted || date1.touched || date2.touched)">
                                    This is a mandatory field
                                  </p>
                            </div>

                        </div>
                       
                        <div class="p-field p-2">
                            <label for="opportunities">Opportunities for stakeholders to participate in the assessment *</label>
                            <input pInputText type="text" #opportunities="ngModel" name="opportunities" ngModel
                            placeholder="Explain how different stakeholders if any will participate in the assessment" [(ngModel)]="assessment.opportunities" required [disabled]="isSavedAssessment|| isEditMode"/>
                            <p class="info-message text-danger" *ngIf="!opportunities.value && (fData.submitted || opportunities.touched)">This is a mandatory field</p>
                      </div>
                      <!-- <div class="p-field p-2">
                        <label for="additioinalInfo">Additional information*</label>
                        <textarea [disabled]="isSavedAssessment|| isEditMode" name="additioinalInfo" placeholder="Enter additional info" #additioinalInfo="ngModel"
                        [(ngModel)]="assessment.additioinalInfo" rows="2" cols="130" pInputText autoResize="autoResize" required
                        ></textarea>
                        <p class="info-message text-danger"
                          *ngIf="!additioinalInfo.value && (fData.submitted || additioinalInfo.touched)">This is a mandatory field</p>
                      </div> -->

                      <!-- <div class="p-field p-2">
                            <label for="principles">Principles on which the assessment is based *</label>
                            <input pInputText type="text" #principles="ngModel" name="principles" ngModel
                            placeholder="Principles" [(ngModel)]="assessment.principles" required [disabled]="isSavedAssessment|| isEditMode"/>
                            <p class="info-message text-danger" *ngIf="!principles.value && (fData.submitted || principles.touched)">This is a mandatory field</p>
                      </div> -->

                            <!-- <div class="p-field p-2">
                            <label for="Sectors Covered">Assessment Method*</label>
                            <p-dropdown name="type" #method="ngModel" placeholder="Select Assessment Method"
                                [(ngModel)]="assessment.assessment_method" [options]="assessmentMethods"  appendTo="body"
                                optionLabel="name" optionValue="name"></p-dropdown>
                            <p class="info-message text-danger" *ngIf="
                                !assessment.assessment_method &&
                                (fData.submitted || method.touched)
                              ">
                                This is a mandatory field
                            </p>
                            </div> -->
                        <!-- <div class="p-field p-2">
                                <label for="Sectors Covered">Assessment Approach*</label>
                                <p-dropdown name="approach" #assessApproach="ngModel" placeholder="Select Assessment Method"
                                    [(ngModel)]="assessment.assessment_approach" [options]="assessmentApproach"  appendTo="body"
                                    (ngModelChange)="onAssessmentApproachchange(assessment.assessment_approach)" [required]="true"
                                    [disabled]="isSavedAssessment"
                                    optionLabel="name" optionValue="name"></p-dropdown>
                                <p class="info-message text-danger" *ngIf="
                                    !assessment.assessment_approach &&
                                    (fData.submitted || assessApproach.touched)
                                  ">
                                    This is a mandatory field
                                </p>
                            </div>
                        <div class="p-field p-2">
                                    <label for="Sectors Covered">Type of Investment</label>
                                    <p-dropdown
                                        name="investment_type"
                                        #investment_type="ngModel"
                                         placeholder="Select type of investment"
                                        [(ngModel)]="investorAssessment.investment_type"
                                        [options]="investmentType"  appendTo="body"

                                        [disabled]="isSavedAssessment"
                                        optionLabel="name" optionValue="name"></p-dropdown>

                        </div> -->


                    </div>
                    <div class="mt-2 overflow-visible" style="z-index: 1;">
                      <div class="p-grid p-fluid col-sm-12">
                        <div class="p-2">
                          <h6>Transformational Vision & Stage</h6>
                        </div>
                        <div class="row p-2">
                          <div class="  col-12">
                                                                    
                            <!-- <label >What is the envisioned change in the system the intervention is 
                              impacting in moving from where the system is currently to where it should be to achieve 
                              the transformational shift desired?</label> -->
                              <!-- <label >How do you see the system the intervention is impacting on moving from its current status towards a situation where? *</label> -->
                              <label >What is the vision for the desired change of the system over time towards zero-carbon and sustainable practices? *</label>
                          </div>
                          <div class="col-12 col-md-6">
                            <div class="p-field">
                              <textarea  name="envisioned_change" placeholder="Enter an answer" #envisioned_change="ngModel" [disabled]="isSavedAssessment|| isEditMode"
                                [(ngModel)]="assessment.envisioned_change" rows="1" cols="130" pInputText autoResize="autoResize" required
                                ></textarea>
                                <p class="info-message text-danger" *ngIf="  !envisioned_change.value &&                     
                                  (fData.submitted || envisioned_change.touched || envisioned_change.dirty)
                                ">
                                    This is a mandatory field
                                  </p>
                            </div>
                          </div>
                        </div>
                        <div class="row p-2">
                          <div class="  col-12">
                                                                    
                            <!-- <p class="question">How does that change would look like …</p> -->
                            <p class="question">What would that change look like? *</p>
                          </div>
                          <div class="col-12 col-md-6">
                            <div class="p-field">
                              <!-- <label for="vision_short">Short Term ({{"\u003C"}}5 years)</label> -->
                              <label for="vision_short">Within 5 years? *</label>
                              <textarea [disabled]="isSavedAssessment|| isEditMode" name="vision_short" placeholder="Short Term Vision" #vision_short="ngModel"
                                [(ngModel)]="assessment.vision_short" rows="1" cols="130" pInputText autoResize="autoResize" required
                                ></textarea>
                                <p class="info-message text-danger" *ngIf="  !vision_short.value &&                     
                                (fData.submitted || vision_short.touched || vision_short.dirty)
                              ">
                                  This is a mandatory field
                                </p>
                            </div>
                          </div>
                         
                          <div class="col-12 col-md-6">
                            <div class="p-field">
                              <!-- <label for="vision_medium">Medium Term ({{"\u003E"}}5 years and   {{"\u003C"}}15 years)</label> -->
                              <label for="vision_short">Between 5 and 15 years? *</label>
                              <textarea [disabled]="isSavedAssessment|| isEditMode"  name="vision_medium" placeholder="Medium Term Vision" #vision_medium="ngModel"
                                [(ngModel)]="assessment.vision_medium" rows="1" cols="130" pInputText autoResize="autoResize" required
                                ></textarea>
                                <p class="info-message text-danger" *ngIf="  !vision_medium.value &&                     
                                (fData.submitted || vision_medium.touched || vision_medium.dirty)
                              ">
                                  This is a mandatory field
                                </p>
                            </div>
                          </div>
                          <div class="col-12 col-md-6">
                            <div class="p-field">
                              <!-- <label for="vision_long">Long Term ({{"\u003E"}}15 years)</label> -->
                              <label for="vision_short">After 15 years? *</label>
                              <textarea [disabled]="isSavedAssessment|| isEditMode" name="vision_long" placeholder="Long Term Vision"
                                #vision_long="ngModel" [(ngModel)]="assessment.vision_long" rows="1" cols="130" pInputText required
                                autoResize="autoResize"></textarea>
                                <p class="info-message text-danger" *ngIf="  !vision_long.value &&                     
                                (fData.submitted || vision_long.touched || vision_long.dirty)
                              ">
                                  This is a mandatory field
                                </p>
                            </div>
                          </div>
                        </div>
                        <div class="row p-2">
                          <div class="  col-12">
                                                                    
                            <!-- <label >In which phase of transformation is the system to be transformed?</label> -->
                            <label >In which phase of transformation is the system currently at? *</label>
                          </div>
                          <div class="col-12 col-md-6">
                            <div class="p-field">
                              <textarea [disabled]="isSavedAssessment|| isEditMode" name="phase_of_transformation" placeholder="See Chapter 6 of the ICAT Transformational Change Methodology" #phase_of_transformation="ngModel"
                                [(ngModel)]="assessment.phase_of_transformation" rows="2" cols="130" pInputText autoResize="autoResize" required
                                ></textarea>
                                <p class="info-message text-danger" *ngIf="  !phase_of_transformation.value &&                     
                                (fData.submitted || phase_of_transformation.touched || phase_of_transformation.dirty)
                              ">
                                  This is a mandatory field
                                </p>
                            </div>
                          </div>
                        </div>
                        <div class="row p-2">
                          <div class="  col-12">
                                                                    
                            <label >How does the intervention seek to contribute to the change in the system to achieve the vision? *</label>
                          </div>
                          <div class="col-12 col-md-6">
                            <div class="p-field">
                              <textarea [disabled]="isSavedAssessment|| isEditMode" name="change_in_system" placeholder="Enter an answer" #change_in_system="ngModel"
                                [(ngModel)]="assessment.change_in_system" rows="1" cols="130" pInputText autoResize="autoResize" required
                                ></textarea>
                                <p class="info-message text-danger" *ngIf="  !change_in_system.value &&                     
                                (fData.submitted || change_in_system.touched || change_in_system.dirty)
                              ">This is a mandatory field
                            </p>
                            </div>
                          </div>
                        </div>
                        <!-- <div class="row p-2">
                          <div class="  col-12">
                                                                    
                            <label >How does the intervention seek to contribute to the change in the system to achieve the vision? *</label>
                          </div>
                          <div class="col-12 col-md-6">
                            <div class="p-field">
                              <textarea [disabled]="isSavedAssessment" name="change_in_system" placeholder="Enter an answer" #change_in_system="ngModel"
                                [(ngModel)]="assessment.change_in_system" rows="1" cols="130" pInputText autoResize="autoResize" required
                                ></textarea>
                                <p class="info-message text-danger" *ngIf="  !change_in_system.value &&                     
                                (fData.submitted || change_in_system.touched || change_in_system.dirty)
                              ">This is a mandatory field
                            </p>
                            </div>
                          </div>
                        </div> -->
            
            
                      </div>
                    </div>
                    <div class=" mt-2">
                      <div class="p-grid p-fluid col-sm-12">
                        <div class="p-2">
                          <h6>Barriers &nbsp; <p-button [hidden]="isSavedAssessment || isEditMode" icon="pi pi-plus "  styleClass="p-button-sm p-button-rounded"  (click)="showDialog()"></p-button></h6>
                        </div>
                        <p-dialog header="Add Barrier" [(visible)]="barrierBox"  [modal]="true" appendTo="body"  [style]="{width: '50vw'}"  >

                          
                  <div class="tooltip2-container">
                    <div>
                      <div class="tooltip2-icon">i</div>
                      <div class="tooltip2-text">
                        <p-table [value]="tableData" [tableStyle]="{ 'min-width': '60rem' }">
                          <ng-template pTemplate="header">
                              <tr>
                                  <th>Barrier</th>
                                  <th>Explanation</th>
                                  <th>Characteristics Affected</th>
                                  <th>Is the barrier directly affected by the intervention?</th>
                              </tr>
                          </ng-template>
                          <ng-template pTemplate="body" let-tableData>
                              <tr>
                                  <td>{{tableData.barrier}}</td>
                                  <td>{{tableData.explanation}}</td>
                                  <td>{{tableData.cha}}</td>
                                  <td>{{tableData.ans}}</td>
                              </tr>
                          </ng-template>
                        </p-table>
                      </div>
  
                    </div>
                  </div>


                          <ng-template pTemplate="p-dialog-content">
                          <div class="row p-2">
                            <div class="col-12 col-md-6">
                              <div class="p-field">
                                <label style="width:200px" for="impEntity">Barrier</label>
                                <input type="text" placeholder="Please add barrier"  name="category"
                                #cat="ngModel" [(ngModel)]="barrierSelected.barrier" maxlength="300" class="p-inputtext"
                                pInputText />
                                
                              </div>
                            </div>
            
                          </div>
            
                          <div class="row p-2">
                            <div class="col-12 col-md-6">
                              <div class="p-field">
                                <label style="width:200px" for="impEntity">Explanation</label>
                                <input type="text" placeholder="Please add explanation"  name="explanation" 
                                #explanation="ngModel" [(ngModel)]="barrierSelected.explanation" maxlength="300" class="p-inputtext"
                                pInputText />
                              </div>
                            </div>
            
                          </div>
            
                          <div class="row p-2">
                            <div class="col-12 col-md-6">
                              <div class="p-field">
                                <label style="width:200px"  for="impEntity">Characteristic Affected</label>
                                <ng-container *ngIf="isDownloadMode == 0; else elseBlockcharacteristics">
                                  <p-multiSelect  placeholder="Please select characteristics" name="characteristics"
                                    #characteristic="ngModel" [(ngModel)]="barrierSelected.characteristics" [options]="characteristicsList" appendTo="body"
                                    optionLabel="name"  [required]="true"></p-multiSelect>
                                  <p class="info-message text-danger" *ngIf="  !finalSectors &&                     
                                  (fData.submitted || characteristic.touched || characteristic.dirty)
                                ">
                                    This is a mandatory field
                                  </p>
                                </ng-container>
                                <ng-template #elseBlockcharacteristics>
                                  <ng-container *ngIf="isDownloadMode == 1 ">
                                    <p-multiSelect placeholder="Please select characteristics" name="characteristics"
                                      #characteristic="ngModel" [(ngModel)]="barrierSelected.characteristics" [options]="characteristicsList" appendTo="body"
                                      optionLabel="name"  [required]="true"></p-multiSelect>
              
                                  </ng-container>
                                  <ng-container *ngIf="isDownloadMode == 0">
                                    <input  type="text" maxlength="50" name="projsector"
                                    #projsector="ngModel" class="p-inputtext" [(ngModel)]="sectorsJoined"
                                    [ngModelOptions]="{ standalone: true }" pattern="^[a-zA-Z0-9 ]{1,64}$" pInputText />
                                  </ng-container>
              
                                </ng-template>
                              </div>
                            </div>
            
                          </div>
            
            
            
                          <div class="row p-2">
                            <div class="col-12 col-md-6">
                              <div class="p-field">
                                <p-checkbox  [binary]="true" [(ngModel)]="barrierSelected.affectedbyIntervention"  name="affectedbyIntervention" inputId="binary"></p-checkbox> &nbsp; &nbsp;
                                <label for="ny">Is the barrier directly affected by the intervention?</label>
            
                              </div>
                            </div>
            
                          </div>
            
                        </ng-template>
            
                          <ng-template pTemplate="footer">
                            <p-button
                            (click)="barrierBox=false; pushBarriers(barrierSelected)"
            
                                label="Save"
            
                            ></p-button>
                        </ng-template>
            
            
            
            
                      </p-dialog>
                      <div class="row p-2" >
                        <div class="col-12 col-md-2">
                          <div class="p-field">
                            <label class ="barrier-top" for="relatedPolicies">Barrier </label>
                          </div>
                        </div>
                        <div class="col-12 col-md-3">
                          <div class="p-field">
                            <label class ="barrier-top" for="relatedPolicies">Explanation </label>
                          </div>
                        </div>
                        <div class="col-12 col-md-3">
                          <div class="p-field">
                            <label class ="barrier-top" for="relatedPolicies">Characteristic Affected </label>
                          </div>
                        </div>
                        <div class="col-12 col-md-4">
                          <div class="p-field">
                            <label class ="barrier-top" for="relatedPolicies">Is the barrier directly affected by the intervention?</label>
                          </div>
                        </div>
            
                      </div>
                      <div *ngIf="finalBarrierList.length !==0" >
                        <div class="row p-2" *ngFor="let barriers of finalBarrierList">
            
                          <div class="col-12 col-md-2">
                            <div class="p-field">
                             <div></div>
                             <div>{{barriers.barrier}}</div>
                            </div>
                          </div>
                          <div class="col-12 col-md-3">
                            <div class="p-field">
                              <div>{{barriers.explanation}}</div>
                            </div>
                          </div>
                          <div class="col-12 col-md-3">
                            <div class="p-field">
                              <div>{{barriersNameArray(barriers.characteristics)}}</div>
                            </div>
                          </div>
                          <div class="col-12 col-md-4">
                            <div class="p-field">
                              <div>{{barriers.affectedbyIntervention==true?'Yes':'No'}} </div>
            
                            </div>
                          </div>
            
                        </div>
            
                      </div>
            
                      <div  >
                        <div class="row p-2" *ngFor="let barriers of barrierArray">
            
                          <div class="col-12 col-md-2">
                            <div class="p-field">
                             <div></div>
                             <div>{{barriers.barrier}}</div>
                            </div>
                          </div>
                          <div class="col-12 col-md-3">
                            <div class="p-field">
                              <div>{{barriers.explanation}}</div>
                            </div>
                          </div>
                          <div class="col-12 col-md-3">
                            <div class="p-field">
                              <div>{{barriersNameArray(barriers['characteristics'])}}</div>
                            </div>
                          </div>
                          <div class="col-12 col-md-4">
                            <div class="p-field">
                              <div>{{barriers.is_affected==true?'Yes':'No'}} </div>
            
                            </div>
                          </div>
            
                        </div>
            
                      </div>
            
            
                      </div>
                    </div>
                </div>
                <!-- <div class="row p-2">
                    <div class="col-12 col-md-6">
                        <div class="p-field p-2">
                            <label for="Level of implementation">Level of implementation*</label>
                            <p-dropdown name="investorAssessment.level_of_implemetation" #levelofimpl="ngModel"
                                placeholder="Select Level of implementation"
                                [(ngModel)]="investorAssessment.level_of_implemetation"
                                appendTo="body"
                                [options]="levelOfImplementation" optionLabel="name" optionValue="name"
                                (ngModelChange)="onLevelofImplementationChange($event)"
                                [disabled]="isSavedAssessment"
                                [required]="true"></p-dropdown>
                            <p class="info-message text-danger" *ngIf="
                                !investorAssessment.level_of_implemetation &&
                                (fData.submitted || levelofimpl.touched)
                              ">
                                This is a mandatory field
                            </p>
                        </div>

                    </div>
                    <div *ngIf="levelofImplementation ===1" class="col-12 col-md-6">
                        <div class="p-field p-2">
                            <label for="Level of implementation">Enter country*</label>
                            <input type="text" pInputText
                              #country="ngModel"
                              [required]="true"
                              placeholder="Enter country"
                              [(ngModel)]="investorAssessment.national_country"
                              [disabled]="isSavedAssessment"
                              name="country" />
                            <p class="info-message text-danger" *ngIf="
                                !investorAssessment.national_country &&
                                (fData.submitted || country.touched)
                              ">
                                This is a mandatory field
                            </p>
                        </div>

                    </div>

                    <div *ngIf="levelofImplementation ===2" class="col-12 col-md-6">
                        <div class="p-field p-2">
                            <label for="Level of implementation">Enter region*</label>
                            <input type="text" pInputText
                              #country="ngModel"
                              [required]="true"
                              placeholder="Enter region"
                              [disabled]="isSavedAssessment"
                              [(ngModel)]="investorAssessment.subnational_region"
                              name="country" />
                            <p class="info-message text-danger" *ngIf="
                                !investorAssessment.subnational_region &&
                                (fData.submitted || country.touched)
                              ">
                                This is a mandatory field
                            </p>
                        </div>

                    </div>



                </div> -->
                <div class="row p-2">
                    <div class="col-12 col-md-6">

                    </div>



                </div>

            </div>
            <div class="row justify-content-end" *ngIf="!isSavedAssessment && !isEditMode">
                <div>

                    <div class="d-flex flex-row-reverse  ">
                        <button class="btn btn-primary text-uppercase" type="submit">
                            Continue
                        </button>
                    </div>
                </div>
            </div>
        </div>


    </form>
    <!-- <div class="p-grid p-fluid col-sm-12" *ngIf="showSections">
        <app-cm-section [assessment]="assessmentres"></app-cm-section>
    </div> -->
    <div class="card" *ngIf="(isSavedAssessment && tabLoading) || (isEditMode && draftLoading)">
        <!-- <div class="card" > -->
        <form #fData1="ngForm" (ngSubmit)="onsubmit(fData1)" >
        <p-tabView  (onChange)="onMainTabChange($event) " [(activeIndex)]="activeIndexMain ">

            <p-tabPanel  header="Process of Change" >
                <!-- <div *ngFor="let characteristic of meth1Process"> -->

                <p-tabView #tabView (onChange)="onCategoryTabChange($event, tabView)" [(activeIndex)]="activeIndex "    >

                    <p-tabPanel  [header]="category.CategoryName" *ngFor="let category of processData; index as cat" >

                        <div class="characteristic-Topic " *ngFor="let data of category.data; index as i">
                            <h6 *ngIf="data.characteristics.name!= 'Research and Development'">{{i+1}}.{{data.characteristics.name}}</h6>
                            <h6 *ngIf="data.characteristics.name === 'Research and Development'">{{i+1}}.{{data.characteristics.name}} (R&D)</h6>
                            <div>

                                    <div class="container pl-20 pr-20">
                                        <div id="content" #content>
                                            <div class=" mt-2">
                                                <div class="p-grid p-fluid col-12">
                                                  
                                                  <div class="row p-2">
                                                  
                                                    <div class="col-2">
                                                      <label for="Description">Description</label>
                                                    </div>
                                                    <div class="col-10">
                                                      <!-- <label for="Description">{{question.question.description}}</label> -->
                                                      <p style=" white-space: pre-wrap; text-align: justify;">{{data.characteristics.investmentDescription}}</p>
                                                    </div>
                                                  </div>


                                                    <div class="row p-2">


                                                                <div class="col-2">
                                                                    <label for="Description">Relevance*</label>
                                                                </div>
                                                                <div class="col-4">
                                                                    <p-dropdown  
                                                                    name="cat-{{cat}}-data.charData.relavance-{{i}}"
                                                                    #rel="ngModel"
                                                                    placeholder="Select Relevance"
                                                                    [(ngModel)]="data.relavance"
                                                                    [options]="relevance" optionLabel="name"
                                                                    (ngModelChange)="onChangeRelevance(data.relavance, data)"
                                                                    appendTo="body"
                                                                    optionValue="value" [required]="true"></p-dropdown>
                                                                    <p class="info-message text-danger" *ngIf="data.relavance ==null  && (fData1.submitted || rel.touched)  || (category.isValidated==false && data.relavance ==null)">
                                                                      This is a mandatory field </p>
                                                                </div>

                                                    </div>

                                                    
                                                    <div *ngIf="data.relavance !=0">

                                                    <div class="row p-2">
                                                        <!-- <label for="Indicator"><u>Indicator</u></label> -->
                                                        <div class="row" *ngFor="let question of data.indicator_details ; let j = index">
                                                            <label style="font-size: 17px;" *ngIf="question.question.isMain" for="Indicator" class="mt-10 mb-10"><u>{{question.question.name}}</u></label>

                                                             <div class="row" *ngIf="!question.question.isMain">
                                                                <div  class=" ml-25 col-6 mb-20">
                                                                    <p  class="question">{{question.question.name}}</p>
                                                                    <div class="tooltip-container">
                                                                      <div *ngIf="question.question.tooltip">
                                                                        <span class="tooltip-icon">i</span>
                                                                        <div class="tooltip-text" [innerHTML]="addNewline(question.question.tooltip)"></div>
                                  
                                                                      </div>
                                                                    </div>
                                                                 </div>


                                                                 <div class="col-4 mb-20">

                                                                    <p-dropdown *ngIf="approach===1"
                                                                        name="cat-{{cat}}-data.charData.question-{{i}}-{{j}}" #type="ngModel"
                                                                        placeholder="Select Answer"
                                                                        [(ngModel)]="question.value"
                                                                        [options]="yesNoAnswer" optionLabel="name"
                                                                        appendTo="body"
                                                                        optionValue="name">
                                                                    </p-dropdown>
                                                                    <p-dropdown  *ngIf="approach===2"
                                                                        name={{data}}_charData.relavance
                                                                        placeholder="Select Institution"
                                                                        [(ngModel)]="question.value"
                                                                        [options]="instiTutionList" optionLabel="name"
                                                                        appendTo="body"
                                                                        optionValue="id" >
                                                                    </p-dropdown>

                                                                 </div>

                                                                 
                                                             </div>
                                                             
                                                             <div class="row" *ngIf="!question.question.isMain">
                                                                <div class=" ml-25 col-6 mb-20">

                                                                    <!-- <p class="justifiaction" class="question">Comment and justification*</p> -->
                                                                    <p class="justifiaction" class="question">Justification*</p>
                                                                  </div>
                                                                  <div class="col-4 mb-20">
                                                                    <input type="text" pInputText
                                                                    [(ngModel)]="question.justification"
                                                                    placeholder="Enter Justification"
                                                                    #questionJustification="ngModel"
                                                                    [name]="question.question.name+'question'" />
                                                                    <p class="info-message text-danger" *ngIf="!question.justification  && (fData1.submitted || questionJustification.touched) || (category.isValidated==false && !question.justification)">
                                                                      This is a mandatory field </p>

                                                                 </div>
                                                             </div>



                                                        </div>

                                                    </div>

                                                    <div class="row p-2">
                                                        <div class="col-12 col-lg-6">
                                                            <div class="p-field" >
                                                                <label for="likelihood" >Likelihood*</label>
                                                                <p-dropdown 
                                                                    appendTo="body"
                                                                    name="cat-{{cat}}-data.charData.likelihood-{{i}}"
                                                                    #likelihood2="ngModel" 
                                                                    placeholder="Select Likelihood"
                                                                    [(ngModel)]="data.likelihood"
                                                                    [options]="likelihood" optionLabel="id"
                                                                    optionValue="value" [required]="true"
                                                                    ></p-dropdown>
                                                                    <p class="info-message text-danger" *ngIf="data.likelihood ==null && (fData1.submitted || likelihood2.touched) || (category.isValidated==false && data.likelihood ==null)">
                                                                      This is a mandatory field </p>
                                                                    <!-- <p-dropdown  *ngIf="approach===2"
                                                                    name={{data}}_charData.relavance
                                                                    placeholder="Select Institution"
                                                                    [(ngModel)]="data.likelihood"
                                                                    [options]="instiTutionList" optionLabel="name"
                                                                    appendTo="body"
                                                                    optionValue="id" [required]="true">
                                                                </p-dropdown> -->

                                                            </div>
                                                        </div>

                                                        <div class="col-12 col-lg-6" *ngIf="approach===1">
                                                            <div class="p-field">
                                                                <label for="justification">Justification*</label>
                                                                <input type="text" pInputText
                                                                    [(ngModel)]="data.likelihood_justification" #just1="ngModel"
                                                                    placeholder="Enter Justification"
                                                                    [name]="data.characteristics.name+ 'likelihood_justification'" />
                                                                    <p class="info-message text-danger" *ngIf="!data.likelihood_justification  && (fData1.submitted || just1.touched) ||(category.isValidated==false && !data.likelihood_justification) ">
                                                                      This is a mandatory field </p>

                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row p-2">
                                                        <label for="question">Supporting Documentation</label>
                                                </div>

                                                  <div class="row p-2 align-items-center">
                                                    <div class="col-2 d-flex align-items-center">
                                                      <p-fileUpload mode="basic" chooseIcon="pi pi-upload" chooseLabel="Upload" name="files"
                                                        [url]="uploadUrl" (onUpload)="onUpload($event,data)" [multiple]="true"
                                                        accept="{{acceptedFiles}}" [maxFileSize]="5000000" [auto]="true">
                                                      </p-fileUpload>
                                                    </div>

                                                    <div class="col-2 d-flex align-items-center" *ngIf="data.uploadedDocumentPath">
                                                      <p>{{data.uploadedDocumentPath}}</p>
                                                    </div>

                                                    <div class="col-2 d-flex align-items-center" *ngIf="data.uploadedDocumentPath">
                                                      <a target="_blank" [href]="fileServerURL+'/'+data.uploadedDocumentPath"><i
                                                          class="pi pi-download download"></i></a>
                                                    </div>
                                                  </div>


                                                </div>
                                                </div>
                                            </div>

                                        </div>
                                    </div>



                            </div>
                        </div>

                        <div  class="row justify-content-end">
                          <div class="d-flex flex-row-reverse mt-20 ">
                               <div class="btn btn-primary text-uppercase"  (click)="next(category,'process')" >
                                   Next
                               </div>
                               <div style="margin-right: 10px;" class="btn btn-primary text-uppercase" (click)="saveDraft(category)">
                                Save
                              </div>
                          </div>
                        </div>

                    </p-tabPanel>






                </p-tabView>
                <!-- </div> -->
            </p-tabPanel>

            <p-tabPanel  header="Outcome of Change">
              <p-tabView #tabView2 (onChange)="onCategoryTabChange($event, tabView2) " [(activeIndex)]="activeIndex2">

                <p-tabPanel *ngFor="let category of outcomeData">

                  <ng-template pTemplate="header">
                    <!-- Use a container div for the header -->
                    <div class="custom-tab-header">{{ category.CategoryName }}</div>
                  </ng-template>

                  <div *ngIf="category.CategoryName === 'SDG Scale of the Outcome' ">
                    <div class="row">
                      <div class="col-5 "><br>
                        <p style="color: black; font-weight: normal; font-size: 17px;">Select those SDGs impacted by the intervention : </p>
                      </div>

                      <div class="col-2 ">
                        <p-multiSelect appendTo="body" name="sdgssss" placeholder="Select SDGs" [(ngModel)]="selectedSDGs"
                          [options]="sdgList" (ngModelChange)="onItemSelectSDGs($event)" optionLabel="name"
                          ></p-multiSelect>
                      </div>

                      <div class="col-5 "></div>
                    </div>
                  </div><br>


                  <div
                    *ngIf="category.CategoryName !== 'SDG Scale of the Outcome' && category.CategoryName !== 'SDG Time frame over which the outcome is sustained'  ">
                    <div class="characteristic-Topic" *ngFor="let data of category.data; index as i">
                      <h6>{{i+1}}.{{data.characteristics.name}}</h6>
                      <div>
                        <form>
                          <div class="container pl-20 pr-20">
                            <div id="content" #content>
                              <div class=" mt-2">
                                <div class="p-grid p-fluid col-12">

                                  <!-- <div class="row p-2">
                                    <div class="col-12 col-lg-12">
                                      <div class="p-field">
                                        <label for="indicator">Indicator</label>
                                        <input type="text" pInputText [(ngModel)]="data.indicator"
                                          placeholder="Indicator Name" name="indicator" />
                                      </div>
                                    </div>
                                  </div>

                                  <div class="row p-2">
                                    <div class="col-12 col-lg-6">
                                      <div class="p-field">
                                        <label for="indicatorStartingVal">Indicator Starting Situation Value</label>
                                        <p-inputNumber [(ngModel)]="data.indicatorStartingVal"
                                          name="indicatorStartingVal" placeholder="Value at the Starting Situation"
                                          inputId="locale-us" mode="decimal" locale="en-US" [minFractionDigits]="2">
                                        </p-inputNumber>
                                      </div>
                                    </div>

                                    <div class="col-12 col-lg-6">
                                      <div class="p-field">
                                        <label for="indicatorExpectedVal">Indicator Expected Value</label>
                                        <p-inputNumber [(ngModel)]="data.indicatorExpectedVal"
                                          name="indicatorExpectedVal" placeholder="Expected Value" inputId="locale-us"
                                          mode="decimal" locale="en-US" [minFractionDigits]="2">
                                        </p-inputNumber>

                                      </div>
                                    </div>
                                  </div> -->


                                  <div class="row p-2">
                                     <label style="font-size: 17px;" for="question">{{data.characteristics.main_question}} </label>

                                     <!--    <div class="tooltip-container">
                                          <div *ngIf="question.question.hint">
                                           <span class="tooltip-icon">i</span> </div>
                                          <div class="tooltip-text">{{addNewline(question.question.hint)}}</div>
                                      </div> -->

                                </div>

                                <!-- Newwwwwww -->
                                <div class="row p-2" *ngIf=" category.CategoryName ==='GHG Scale of the Outcome' && data.characteristics.name === 'International/global level'">
                                  <p>3 - reduction in emissions > 0.1% of global emissions</p>
                                  <p>2 - reduction in emissions > 0.05% of global emissions</p>
                                  <p>1 - reduction in emissions > 0.01% of global emissions</p>
                                  <p>0 - reduction in emissions < 0.01% of global emissions</p>
                                  <p>minus 3 - any emissions increase</p><br><br>
                                  <p>Note: all reduction in emissions calculated as average reduction
                                     in emissions (tCO2e/yr calculated as total estimated reductions over
                                     lifetime of the project divided by project lifetime) and compared to global
                                      emissions for the latest year for which those emissions data is available </p>
                                </div>

                                <div class="row p-2" *ngIf=" category.CategoryName ==='GHG Scale of the Outcome' && data.characteristics.name === 'National/Sectorial level'">
                                  <p>3 - reduction in emissions > 1% of national/sectoral emissions</p>
                                  <p>2 - reduction in emissions equal to 0.5 - 1% of national/sectoral emissions</p>
                                  <p>1 - reduction in emissions equal to 0.1 - 0.5% of national/sectoral emissions</p>
                                  <p>0 - reduction in emissions less than 0.1% of national/sectoral emissions</p>
                                  <p>minus 3 - any emissions increase</p><br><br>
                                  <p>Note: all reduction in emissions calculated as average reduction in emissions
                                     (tCO2e/yr calculated as total estimated reductions over lifetime of the project divided
                                      by project lifetime) and compared to national/sectoral emissions for the latest year for
                                       which those emissions data is available </p>
                                </div>

                                <div class="row p-2" *ngIf=" category.CategoryName ==='GHG Scale of the Outcome' && data.characteristics.name === 'Subnational/regional/municipal or sub sectorial level'">
                                  <p>3 - reduction in emissions > 5% of subnational/regional/municipal emissions or subsectoral level</p>
                                  <p>2 - reduction in emissions equal to 1 - 5% subnational/regional/municipal emissions or subsectoral level</p>
                                  <p>1 - reduction in emissions equal to 0.5 - 1% of subnational/regional/municipal emissions or subsectoral level</p>
                                  <p>0 - reduction in emissions less than 0.5% of subnational/regional/municipal emissions or subsectoral level</p>
                                  <p>minus 3 - any emissions increase</p><br><br>
                                  <p>Note: all reduction in emissions calculated as average reduction in emissions (tCO2e/yr calculated
                                     as total estimated reductions over lifetime of the project divided by project lifetime) and
                                      compared to subnational/regional/municipal emissions or subsectoral level emissions for the
                                      latest year for which those emissions data is available </p>
                                </div>
                                <!-- Newwwwwww - Endddd -->


                                  <div class="row p-2">

                                   <!--  <div class="col-12 col-lg-6">
                                      <div class="p-field">
                                        <label for="Relevance">Score</label>
                                        <p-inputNumber inputId="integeronly" [(ngModel)]="data.score"
                                          [showButtons]="true" [min]="-1" [max]="3" [step]="1" inputId="minmax-buttons"
                                          placeholder="Enter Score" name="data.charData.score"> </p-inputNumber>
                                      </div>
                                    </div> -->

                                    <div class="col-12 col-lg-6">
                                      <div class="p-field">
                                        <label for="score">Score</label>
                                        <div *ngIf=" category.CategoryName ==='GHG Scale of the Outcome' ||  category.CategoryName ==='Adaptation Scale of the Outcome' ">
                                        <p-dropdown appendTo="body" name="score" #type="ngModel"
                                          placeholder="Select Score" [(ngModel)]="data.score"
                                          [options]="outcomeScaleScore" optionLabel="id" optionValue="value"
                                         ></p-dropdown></div>

                                          <div *ngIf=" category.CategoryName ==='GHG Time frame over which the outcome is sustained' ||  category.CategoryName ==='Adaptation Time frame over which the outcome is sustained' ">
                                            <p-dropdown appendTo="body" name="score" #type="ngModel"
                                              placeholder="Select Score" [(ngModel)]="data.score"
                                              [options]="outcomeSustainedScore" optionLabel="id" optionValue="value"
                                              ></p-dropdown></div>
                                      </div>
                                    </div>

                                    <div class="col-12 col-lg-6">
                                      <div class="p-field">
                                        <label for="justification">Justification*</label>
                                        <input type="text" pInputText [(ngModel)]="data.justification" #just2="ngModel"
                                          placeholder="Enter Justification" name="justification" />
                                          <p class="info-message text-danger" *ngIf="!data.justification  && (fData1.submitted || just2.touched) || (category.isValidated==false && !data.justification)">
                                            This is a mandatory field </p>

                                      </div>
                                    </div>
                                  </div>


                                  <!-- lllllllllllllllllllllllllllll -->
                              <div class="row p-2 align-items-center">
                                <div class="col-2 d-flex align-items-center">
                                  <p-fileUpload mode="basic" chooseIcon="pi pi-upload" chooseLabel="Upload" name="files"
                                    [url]="uploadUrl" (onUpload)="onUpload($event,data)" [multiple]="true"
                                    accept="{{acceptedFiles}}" [maxFileSize]="5000000" [auto]="true">
                                  </p-fileUpload>
                                </div>

                                <div class="col-2 d-flex align-items-center" *ngIf="data.uploadedDocumentPath">
                                  <p>{{data.uploadedDocumentPath}}</p>
                                </div>

                                <div class="col-2 d-flex align-items-center" *ngIf="data.uploadedDocumentPath">
                                  <a target="_blank" [href]="fileServerURL+'/'+data.uploadedDocumentPath"><i
                                      class="pi pi-download download"></i></a>
                                </div>
                              </div>


                              <!-- lllllllllllllllllllllllllllll -->


                              <div class="row p-2"
                              *ngIf=" category.CategoryName ==='GHG Scale of the Outcome' && data.characteristics.name === 'Subnational/regional/municipal or sub sectorial level' ">
                              <div class="col-12 col-lg-6">
                                <div class="p-field">
                                  <label for="expected_ghg_mitigation">Expected GHG reductions over intervention lifetime(Mt CO2-eq)</label>
                                  <p-inputNumber [(ngModel)]="data.expected_ghg_mitigation" name="expected_ghg_mitigation"
                                      placeholder="Expected GHG reductions over intervention lifetime" inputId="locale-us" mode="decimal"
                                    locale="en-US" [minFractionDigits]="2">
                                  </p-inputNumber>
                                  </div>
                                </div>

                                <div *ngIf="category.CategoryName ==='GHG Scale of the Outcome'" style="text-align: justify;">
                                  <p>  <br><br>
                                    Note: all reduction in emissions calculated as average reduction in emissions
                                    (tCO2e/yr calculated as total estimated reductions over lifetime of the project
                                    divided by project lifetime) and compared respectively to global, national/sectoral or
                                    subnational and subsectorial emissions for the latest year for which those emissions data
                                    is available
                                  </p>
                                </div>

                                </div>


                              </div>
                            </div>
                          </div>
                        </div>
                        </form>

                      </div>
                    </div>
                    <div  class="row justify-content-end" *ngIf="activeIndex2!==5 || activeIndexMain!==1">
                      <div class="d-flex flex-row-reverse mt-20 ">
                           <div class="btn btn-primary text-uppercase"  (click)="next(category,'outcome')" >
                               Next
                           </div>
                           <div style="margin-right: 10px;" class="btn btn-primary text-uppercase" (click)="saveDraft(category)">
                            Save
                          </div>
                      </div>
                    </div>
                  </div>

                  <div *ngIf="category.CategoryName === 'SDG Scale of the Outcome'">
                    <div *ngFor="let item of sdgDataSendArray2; index as i">
                      <div class="card" style="min-height: 300px;">
                        <h6 style="color: black;">SDG {{ selectedSDGs[i].number }} - {{ selectedSDGs[i].name }}</h6> <br>

                      <div class="row">
                        <div class="col-8">
                          <h6 style="color: black; font-weight: normal; font-size: 17px;">Could the intervention have an impact on this particular SDG?</h6>
                        </div>
                        <div class="col-4">
                          <p-dropdown appendTo="body" [name]="selectedSDGs[i].name" #type="ngModel" placeholder="Select Answer"
                          [(ngModel)]="selectedSDGsWithAnswers[i].answer" [options]="sdg_answers" optionLabel="name"
                          (onChange)="onChangeSDGsAnswer(selectedSDGs[i],selectedSDGs[i])"
                          optionValue="name"  ></p-dropdown>
                        </div>
                      </div>

                      <div class="characteristic-Topic" *ngFor="let data of item.data; index as j">
                        <h6>{{ j+1 }}.{{ data.characteristics.name }}</h6>
                        <div>
                          <form>
                            <div class="container pl-20 pr-20">
                              <div id="content" #content>
                                <div class=" mt-2">
                                  <div class="p-grid p-fluid col-12">


                                   <!--  <div class="row p-2">
                                      <div class="col-12 col-lg-12">
                                        <div class="p-field">
                                          <label for="indicator">Indicator</label>
                                          <input type="text" (ngModelChange)="assignSDG(selectedSDGs[i], data)"
                                            pInputText [(ngModel)]="data.indicator" placeholder="Indicator Name"
                                            name="indicator" />
                                        </div>
                                      </div>
                                    </div> -->

                                    <!-- <div class="row p-2">
                                      <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="indicatorStartingVal">Indicator Starting Situation Value</label>
                                          <p-inputNumber (ngModelChange)="assignSDG(selectedSDGs[i], data)"
                                            [(ngModel)]="data.indicatorStartingVal" name="indicatorStartingVal"
                                            placeholder="Value at the Starting Situation" inputId="locale-us"
                                            mode="decimal" locale="en-US" [minFractionDigits]="2"></p-inputNumber>
                                        </div>
                                      </div>

                                      <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="indicatorExpectedVal">Indicator Expected Value</label>
                                          <p-inputNumber (ngModelChange)="assignSDG(selectedSDGs[i], data)"
                                            [(ngModel)]="data.indicatorExpectedVal" name="indicatorExpectedVal"
                                            placeholder="Expected Value" inputId="locale-us" mode="decimal"
                                            locale="en-US" [minFractionDigits]="2"></p-inputNumber>
                                        </div>
                                      </div>
                                    </div> -->

                                    <div class="row p-2">
                                       <label style="font-size: 17px;" for="question">{{data.characteristics.main_question}} </label>

                                         <!--  <div class="tooltip-container">
                                            <div *ngIf="question.question.hint">
                                             <span class="tooltip-icon">i</span> </div>
                                            <div class="tooltip-text">{{addNewline(question.question.hint)}}</div>
                                        </div> -->

                                  </div>

                                    <div class="row p-2">

                                     <!--  <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="Relevance">Score</label>
                                          <p-inputNumber (ngModelChange)="assignSDG(selectedSDGs[i], data)"
                                            inputId="integeronly" [(ngModel)]="data.score" [showButtons]="true"
                                            [min]="-1" [max]="3" [step]="1" inputId="minmax-buttons"
                                            placeholder="Enter Score" name="data.charData.score"></p-inputNumber>
                                        </div>
                                      </div> -->

                                      <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="score">Score</label>
                                          <p-dropdown appendTo="body" name="score" #type="ngModel"
                                            placeholder="Select Score" [(ngModel)]="data.score" (ngModelChange)="assignSDG(selectedSDGs[i], data)"
                                            [options]="outcomeScaleScore" optionLabel="id" optionValue="value"
                                           ></p-dropdown>
                                        </div>
                                      </div>

                                      <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="justification">Justification*</label>
                                          <input (ngModelChange)="assignSDG(selectedSDGs[i], data)" type="text"
                                            pInputText [(ngModel)]="data.justification" #just3="ngModel"
                                            placeholder="Enter Justification" name="justification" />
                                            <p class="info-message text-danger" *ngIf="!data.justification  && (fData1.submitted || just3.touched) || (isValidSCaleSD==false && !data.justification)">
                                              This is a mandatory field </p>
                                        </div>
                                      </div>
                                    </div>

                                    <!-- lllllllllllllllllllllllllllll -->
                                    <div class="row p-2 align-items-center">
                                      <div class="col-2 d-flex align-items-center">
                                        <p-fileUpload mode="basic" chooseIcon="pi pi-upload" chooseLabel="Upload"
                                          name="files" [url]="uploadUrl" (onUpload)="onUpload($event,data)"
                                          [multiple]="true" accept="{{acceptedFiles}}" [maxFileSize]="5000000"
                                          [auto]="true">
                                        </p-fileUpload>
                                      </div>

                                      <div class="col-2 d-flex align-items-center" *ngIf="data.uploadedDocumentPath">
                                        <p>{{data.uploadedDocumentPath}}</p>
                                      </div>

                                      <div class="col-2 d-flex align-items-center" *ngIf="data.uploadedDocumentPath">
                                        <a target="_blank" [href]="fileServerURL+'/'+data.uploadedDocumentPath"><i
                                            class="pi pi-download download"></i></a>
                                      </div>
                                    </div>


                                    <!-- lllllllllllllllllllllllllllll -->


                                  </div>
                                </div>
                              </div>
                            </div>
                          </form>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div  class="row justify-content-end" >
                    <div class="d-flex flex-row-reverse mt-20 ">
                         <div class="btn btn-primary text-uppercase"  (click)="nextSDG(sdgDataSendArray2,'scaleSD')" >
                             Next
                         </div>
                         <div style="margin-right: 10px;" class="btn btn-primary text-uppercase" (click)="saveDraft(category)">
                          Save
                        </div>
                    </div>
                  </div>
                  
                  </div>



                  <div *ngIf="category.CategoryName === 'SDG Time frame over which the outcome is sustained'  ">

                    <div *ngFor="let item of sdgDataSendArray4; index as i">
                      <div class="card" style="min-height: 300px;">
                        <h6 style="color: black;">SDG {{ selectedSDGs[i].number }} - {{ selectedSDGs[i].name }}</h6> <br>
                      <div class="characteristic-Topic" *ngFor="let data of item.data; index as j">
                        <h6>{{ j+1 }}.{{ data.characteristics.name }}</h6>
                        <div>
                          <form>
                            <div class="container pl-20 pr-20">
                              <div id="content" #content>
                                <div class=" mt-2">
                                  <div class="p-grid p-fluid col-12">

                                   <!--  <div class="row p-2">
                                      <div class="col-12 col-lg-12">
                                        <div class="p-field">
                                          <label for="indicator">Indicator</label>
                                          <input (ngModelChange)="assignSDG(selectedSDGs[i], data)" type="text"
                                            pInputText [(ngModel)]="data.indicator" placeholder="Indicator Name"
                                            name="indicator" />
                                        </div>
                                      </div>
                                    </div> -->

                                   <!--  <div class="row p-2">
                                      <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="indicatorStartingVal">Indicator Starting Situation Value</label>
                                          <p-inputNumber (ngModelChange)="assignSDG(selectedSDGs[i], data)"
                                            [(ngModel)]="data.indicatorStartingVal" name="indicatorStartingVal"
                                            placeholder="Value at the Starting Situation" inputId="locale-us"
                                            mode="decimal" locale="en-US" [minFractionDigits]="2"></p-inputNumber>
                                        </div>
                                      </div>

                                      <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="indicatorExpectedVal">Indicator Expected Value</label>
                                          <p-inputNumber (ngModelChange)="assignSDG(selectedSDGs[i], data)"
                                            [(ngModel)]="data.indicatorExpectedVal" name="indicatorExpectedVal"
                                            placeholder="Expected Value" inputId="locale-us" mode="decimal"
                                            locale="en-US" [minFractionDigits]="2"></p-inputNumber>
                                        </div>
                                      </div>
                                    </div> -->

                                    <div class="row p-2">
                                       <label style="font-size: 17px;" for="question">{{data.characteristics.main_question}} </label>

                                         <!--  <div class="tooltip-container">
                                            <div *ngIf="question.question.hint">
                                             <span class="tooltip-icon">i</span> </div>
                                            <div class="tooltip-text">{{addNewline(question.question.hint)}}</div>
                                        </div> -->
                                  </div>

                                    <div class="row p-2">

                                     <!--  <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="Relevance">Score</label>
                                          <p-inputNumber (ngModelChange)="assignSDG(selectedSDGs[i], data)"
                                            inputId="integeronly" [(ngModel)]="data.score" [showButtons]="true"
                                            [min]="-1" [max]="3" [step]="1" inputId="minmax-buttons"
                                            placeholder="Enter Score" name="data.charData.score"></p-inputNumber>
                                        </div>
                                      </div> -->

                                      <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="score">Score</label>
                                          <p-dropdown appendTo="body" name="score" #type="ngModel"
                                            placeholder="Select Score" [(ngModel)]="data.score" (ngModelChange)="assignSDG(selectedSDGs[i], data)"
                                            [options]="outcomeSustainedScore" optionLabel="id" optionValue="value"
                                            ></p-dropdown>
                                        </div>
                                      </div>

                                      <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="justification">Justification*</label>
                                          <input (ngModelChange)="assignSDG(selectedSDGs[i], data)" type="text"
                                            pInputText [(ngModel)]="data.justification" #just4="ngModel"
                                            placeholder="Enter Justification" name="justification" />
                                            <p class="info-message text-danger" *ngIf="!data.justification  && (fData1.submitted || just4.touched) || (isValidSustainedSD==false && !data.justification)">
                                              This is a mandatory field </p>
                                        </div>
                                      </div>
                                    </div>

                                    <!-- lllllllllllllllllllllllllllll -->
                                    <div class="row p-2 align-items-center">
                                      <div class="col-2 d-flex align-items-center">
                                        <p-fileUpload mode="basic" chooseIcon="pi pi-upload" chooseLabel="Upload"
                                          name="files" [url]="uploadUrl" (onUpload)="onUpload($event,data)"
                                          [multiple]="true" accept="{{acceptedFiles}}" [maxFileSize]="5000000"
                                          [auto]="true">
                                        </p-fileUpload>
                                      </div>

                                      <div class="col-2 d-flex align-items-center" *ngIf="data.uploadedDocumentPath">
                                        <p>{{data.uploadedDocumentPath}}</p>
                                      </div>

                                      <div class="col-2 d-flex align-items-center" *ngIf="data.uploadedDocumentPath">
                                        <a target="_blank" [href]="fileServerURL+'/'+data.uploadedDocumentPath"><i
                                            class="pi pi-download download"></i></a>
                                      </div>
                                    </div>


                                    <!-- lllllllllllllllllllllllllllll -->


                                  </div>
                                </div>
                              </div>
                            </div>
                          </form>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div  class="row justify-content-end" >
                    <div class="d-flex flex-row-reverse mt-20 ">
                         <div class="btn btn-primary text-uppercase"  (click)="nextSDG(sdgDataSendArray4,'sustainedSD')" >
                             Next
                         </div>
                         <div style="margin-right: 10px;" class="btn btn-primary text-uppercase" (click)="saveDraft(category)">
                          Save
                        </div>
                    </div>
                  </div>
                  </div>
                  



                </p-tabPanel>

              </p-tabView>
            </p-tabPanel>


        </p-tabView>

        <div  *ngIf="activeIndex2===5 && activeIndexMain===1" class="row justify-content-end">
            <div>
                <!-- <div class=" col-md-10 offset-md-4" style="color:red" >
                    <div class="col align-self-end" *ngIf="failedLikelihoodArray.length!=0">
                       Please make sure to set Likelihood weights for
                       <span  *ngFor="let data of failedLikelihoodArray ; let last = last" class="array-item">
                           {{data.category}}<span  *ngIf="!last">, </span>
                        </span > should sum up to 100%.

                    </div>
                    <div class="col align-self-end" *ngIf="failedRelevanceArray.length!=0">
                        Please make sure to set Relevance weights for <span  *ngFor="let data of failedRelevanceArray ; let last = last" class="array-item">
                            {{data.category}} <span  *ngIf="!last">, </span>
                         </span > should sum up to 100%.


                    </div>
                </div> -->



                <div
                class="d-flex flex-row-reverse mt-20 ">
                    <button class="btn btn-primary text-uppercase" type="submit" [disabled]="failedLikelihoodArray.length!=0 ||failedRelevanceArray.length!=0 || !fData1.valid">
                        {{approach==1 ?'Calculate & Check results': (approach==2 ?'Send to Data Collection Team':'')}}
                    </button>
                </div>
            </div>
        </div>

      







    </form>
<!-- <ng-template #elseblock> -->


<!-- </ng-template> -->

    </div>


</div>
