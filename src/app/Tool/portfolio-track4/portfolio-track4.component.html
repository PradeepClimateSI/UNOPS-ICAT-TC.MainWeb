<div class="container pl-20 pr-20">
  <div *ngIf="track4Selectt">
    <div class="mb-12">
      <h4 class="mt-4">Assess the Transformational Change due to a Portfolio of Interventions</h4>
    </div>
    <form #fData="ngForm" (ngSubmit)="save(fData)">
      <div class="card" style="min-height: 600px;">
        <div class="p-grid p-fluid col-md-6 col-sm-12">
          <div class="row p-2">
            <div class="col-12 col-md-8">

              <!--  <div class="p-field p-2">
              <label for="assessment_method">Assessment Method *</label>
              <select class="form-control select-with-arrow"  (change)="onChangeTrack($event)" [(ngModel)]="assessment.assessment_method"
                name="assessment_method" id="exampleFormControlSelect1"  #assessmentMethod="ngModel">
                <option value="" disabled selected hidden>Select Assessment Method</option>
                <option>Track 1</option>
                <option>Track 2</option>
                <option>Track 3</option>
                <option>Track 4</option>
              </select>
              <p class="info-message text-danger" *ngIf="!assessment.assessment_method && (fData.submitted || assessmentMethod.touched)">This is a mandatory field</p>
            </div> -->


              <div class="p-field p-2">
                <label for="assessment_method">Assessment Method *</label>
                <p-dropdown appendTo="body" name="assessment_method" #assessmentMethod="ngModel"
                  placeholder="Select Assessment Method" [(ngModel)]="assessment.assessment_method" ngModel
                  [options]="assessmentMethodList" (onChange)="onChangeTrack($event)" optionLabel="name"
                  optionValue="name" [required]="true"></p-dropdown>
                <p class="info-message text-danger"
                  *ngIf="!assessment.assessment_method && (fData.submitted || assessmentMethod.touched)">This is a
                  mandatory field</p>
              </div>



              <div class="p-field p-2">
                <label for="policy">Select Intervetion *</label>
                <p-dropdown appendTo="body" name="policy" #policy="ngModel" placeholder="Select Policy"
                  [(ngModel)]="assessment.climateAction" appendTo="body" [options]="policies" optionLabel="policyName"
                  [required]="true"></p-dropdown>
                <p class="info-message text-danger" *ngIf="
                                                  !assessment.climateAction &&
                                                  (fData.submitted || policy.touched)
                                                ">
                  This is a mandatory field
                </p>
              </div>
              <div class="p-field p-2">
                <label for="policy">Assessment Type *</label>
                <p-dropdown appendTo="body" name="type" #type="ngModel" placeholder="Select Assessment Type"
                  [(ngModel)]="assessment.assessmentType" [options]="assessment_types" optionLabel="name"
                  optionValue="name" [required]="true" (onChange)="selectAssessmentType($event)"></p-dropdown>
                <p class="info-message text-danger" *ngIf="
                              !assessment.assessmentType &&
                              (fData.submitted || type.touched)
                            ">
                  This is a mandatory field
                </p>
              </div>
              <!--  <div class="p-field p-2">
              <label for="Level of implementation">Level of implementation *</label>
              <p-dropdown appendTo="body" name="investorAssessment.level_of_implemetation" #type="ngModel"
                placeholder="Select Level of implementation" [(ngModel)]="investorAssessment.level_of_implemetation"
                [options]="levelOfImplementation" optionLabel="name" optionValue="name" [required]="true"></p-dropdown>
              <p class="info-message text-danger" *ngIf="
                              !investorAssessment.level_of_implemetation &&
                              (fData.submitted || type.touched)
                            ">
                This is a mandatory field
              </p>
            </div> -->
              <div class="p-field p-2">
                <label for="Level of implementation">Geographical Areas Covered *</label>
                <p-dropdown appendTo="body" name="investorAssessment.geographical_areas_covered" #type="ngModel"
                  placeholder="Select Geographical Areas Covered"
                  [(ngModel)]="investorAssessment.geographical_areas_covered" [options]="levelOfImplementation"
                  optionLabel="name" optionValue="name" [required]="true"></p-dropdown>
                <p class="info-message text-danger" *ngIf="
                              !investorAssessment.geographical_areas_covered &&
                              (fData.submitted || type.touched)
                            ">
                  This is a mandatory field
                </p>
              </div>
              <div class="p-field p-2">
                <label for="Sectors Covered">Sectors Covered *</label>

                <p-multiSelect appendTo="body" name="sectors" #type="ngModel" placeholder="Select Sectors Covered"
                  [(ngModel)]="sectorArray" [options]="sectorList" (ngModelChange)="onItemSelectSectors($event)"
                  optionLabel="name" [required]="true"></p-multiSelect>
                <p class="info-message text-danger" *ngIf="
                              sectorArray.length===0 &&
                              (fData.submitted || type.touched)
                            ">
                  This is a mandatory field
                </p>
              </div>

              <!--   <div class="p-field p-2">
              <label for="Sectors Covered">Impacts Covered *</label>
              <p-multiSelect appendTo="body" name="impact" #type="ngModel" placeholder="Select Impact Covered" [(ngModel)]="impactArray"
                [options]="impactCovered" (ngModelChange)="onItemSelectImpacts($event)" optionLabel="name"
                [required]="true"></p-multiSelect>
              <p class="info-message text-danger" *ngIf="
                              impactArray.length===0 &&
                              (fData.submitted || type.touched)
                            ">
                This is a mandatory field
              </p>
            </div> -->


              <div class="p-field p-2">
                <label for="assessment_approach">Assessment Approach *</label>
                <p-dropdown appendTo="body" name="assessment_approach" #assessment_approach="ngModel"
                  placeholder="Select Assessment Approach" [(ngModel)]="assessment.assessment_approach" ngModel
                  [options]="assessmentApproach" (onChange)="onChangeApproach($event)" optionLabel="name"
                  optionValue="name" [required]="true"></p-dropdown>
                <p class="info-message text-danger"
                  *ngIf="!assessment_approach.value && (fData.submitted || assessment_approach.touched)">This is a
                  mandatory field</p>
              </div>


              <div class="p-field p-2">

                <label for="date1">Assessment Period*</label>
                <div class="p-inputgroup">
                  <span class="p-inputgroup-addon">
                    <i class="pi pi-calendar"></i>
                  </span>
                  <p-calendar dateFormat="mm-dd-yy" inputId="date1" placeholder="From" [(ngModel)]="assessment.from"
                    name="date1" #date1="ngModel" [required]="true" appendTo="body" [disabled]="isSavedAssessment">
                  </p-calendar>
                  <span class="p-inputgroup-addon">to</span>
                  <p-calendar dateFormat="mm-dd-yy" inputId="date2" placeholder="To" [(ngModel)]="assessment.to"
                    name="date2" #date2="ngModel" [required]="true" appendTo="body"
                    [disabled]="isSavedAssessment"></p-calendar>

                </div>
                <div class="col-12">
                  <p class="info-message text-danger"
                    *ngIf="(date1.invalid || date2.invalid) && (fData.submitted || date1.touched || date2.touched)">
                    This is a mandatory field
                  </p>
                </div>

              </div>

            </div>
          </div>
        </div>
        <div class="row justify-content-end" *ngIf="!isSavedAssessment">
          <div>

            <div class="d-flex flex-row-reverse  ">
              <button class="btn btn-primary text-uppercase" type="submit">
                Continue
              </button>
            </div>
          </div>
        </div>
      </div>


    </form>
    <!-- <div class="p-grid p-fluid col-sm-12" *ngIf="showSections">
      <app-cm-section [assessment]="assessmentres"></app-cm-section>
  </div> -->
    <div *ngIf=" load && selectedApproach === 'Direct'">
      <!-- <div > -->
      <div class="card">
        <form #fData1="ngForm" (ngSubmit)="onsubmit(fData1)">
          <p-tabView (onChange)="onMainTabChange($event)" [(activeIndex)]="activeIndexMain ">

            <p-tabPanel header="Process of Change">
              <!-- <div *ngFor="let characteristic of meth1Process"> -->

              <p-tabView #tabView (onChange)="onCategoryTabChange($event, tabView)" [(activeIndex)]="activeIndex ">

                <p-tabPanel [header]="category.CategoryName" *ngFor="let category of processData">


                  <div class="characteristic-Topic" *ngFor="let data of category.data; index as i">
                    <h6>{{i+1}}.{{data.characteristics.name}}</h6>
                    <div>

                      <div class="container pl-20 pr-20">
                        <div id="content" #content>
                          <div class=" mt-2">
                            <div class="p-grid p-fluid col-12">

                              <div class="row p-2">
                                <div class="col-12 col-lg-6">
                                  <div class="p-field">
                                    <label for="Description">Description</label>
                                    <textarea name="{{data.characteristics.name}}_description" placeholder="Description"
                                      rows="5" cols="60" pInputTextarea [(ngModel)]="data.description"
                                      autoResize="autoResize" class="p-inputtext"></textarea>
                                  </div>
                                </div>

                                <div class="col-12 col-lg-6">
                                  <div class="p-field">
                                    <label for="StartingSituation">Starting
                                      Situation</label>
                                    <textarea name="Starting Situation" placeholder="Starting Situation" rows="5"
                                      cols="60" pInputTextarea [(ngModel)]="data.starting_situation"
                                      autoResize="autoResize" class="p-inputtext"></textarea>

                                  </div>
                                </div>
                              </div>

                              <div class="row p-2">
                                <div class="col-12 col-lg-6">
                                  <div class="p-field">
                                    <label for="Description">Relevance</label>
                                    <p-dropdown appendTo="body" name="data.charData.relavance" #type="ngModel"
                                      placeholder="Select Relevance" [(ngModel)]="data.relavance" [options]="relevance"
                                      optionLabel="name" optionValue="value" [required]="true"></p-dropdown>
                                  </div>
                                </div>

                                <div class="col-12 col-lg-6">
                                  <div class="p-field">
                                    <label for="justification">Justification</label>
                                    <input type="text" pInputText [(ngModel)]="data.justification"
                                      placeholder="Enter Justifiaction" name="justification" />

                                  </div>
                                </div>
                              </div>
                              <div class="row p-2">
                                <div class="col-12 col-lg-12">
                                  <div class="p-field">
                                    <label for="indicator">Indicator</label>
                                    <input type="text" pInputText [(ngModel)]="data.indicator"
                                      placeholder="Indicator Name" name="indicator" />
                                  </div>
                                </div>
                              </div>

                              <div class="row p-2">
                                <div class="col-12 col-lg-6">
                                  <div class="p-field">
                                    <label for="indicatorStartingVal">Indicator Starting Situation Value</label>
                                    <p-inputNumber [(ngModel)]="data.indicatorStartingVal" name="indicatorStartingVal"
                                      placeholder="Value at the Starting Situation" inputId="locale-us" mode="decimal"
                                      locale="en-US" [minFractionDigits]="2">
                                    </p-inputNumber>
                                  </div>
                                </div>

                                <div class="col-12 col-lg-6">
                                  <div class="p-field">
                                    <label for="indicatorExpectedVal">Indicator Expected Value</label>
                                    <p-inputNumber [(ngModel)]="data.indicatorExpectedVal" name="indicatorExpectedVal"
                                      placeholder="Expected Value" inputId="locale-us" mode="decimal" locale="en-US"
                                      [minFractionDigits]="2">
                                    </p-inputNumber>

                                  </div>
                                </div>
                              </div>

                              <div class="row p-2">
                                <div class="col-12 col-lg-6">
                                  <div class="p-field">
                                    <label for="Relevance">Likelihood</label>
                                    <p-dropdown appendTo="body" name="data.charData.likelihood" #type="ngModel"
                                      placeholder="Select Likelihood" [(ngModel)]="data.likelihood"
                                      [options]="likelihood" optionLabel="id" optionValue="value"
                                      [required]="true"></p-dropdown>
                                  </div>
                                </div>

                                <div class="col-12 col-lg-6">
                                  <div class="p-field">
                                    <label for="justification">Justification</label>
                                    <input type="text" pInputText [(ngModel)]="data.likelihood_justification"
                                      placeholder="Enter Justifiaction" name="data.charData.likelihood_justification" />

                                  </div>
                                </div>
                              </div>


                              <!-- lllllllllllllllllllllllllllll -->
                              <div class="row p-2 align-items-center">
                                <div class="col-2 d-flex align-items-center">
                                  <p-fileUpload mode="basic" chooseIcon="pi pi-upload" chooseLabel="Upload" name="files"
                                    [url]="uploadUrl" (onUpload)="onUpload($event,data)" [multiple]="true"
                                    accept="{{acceptedFiles}}" [maxFileSize]="5000000" [auto]="true">
                                  </p-fileUpload>
                                </div>

                                <div class="col-2 d-flex align-items-center" *ngIf="data.uploadedDocumentPath">
                                  <p>{{data.uploadedDocumentPath}}</p>
                                </div>

                                <div class="col-2 d-flex align-items-center" *ngIf="data.uploadedDocumentPath">
                                  <a target="_blank" [href]="fileServerURL+'/'+data.uploadedDocumentPath"><i
                                      class="pi pi-download download"></i></a>
                                </div>
                              </div>


                              <!-- lllllllllllllllllllllllllllll -->

                              <div class="row p-2">
                                <div class="col-12 col-lg-6">
                                  <div class="p-field">
                                    <label for="Relevance">Relevance Weight (%)</label>
                                    <p-inputNumber inputId="locale-us" mode="decimal" locale="en-US"
                                      [minFractionDigits]="2" [min]="0" [max]="100" [(ngModel)]="data.relevance_weight"
                                      placeholder="Enter Relevance Weight" name="data.charData.relevance_weight"
                                      (ngModelChange)="onRelevanceWeightChange(category.CategoryName,data.characteristics.name, $event)">
                                    </p-inputNumber>

                                    <!-- <div *ngIf="!chaCategoryTotalEqualsTo1[category.CategoryName]" style="color: red;"> -->
                                    <div
                                      *ngIf="!chaCategoryTotalEqualsTo1[category.CategoryName] && initialRelevance !==0"
                                      style="color: red;">
                                      Relevance weights for characteristics of {{category.CategoryName}} category should
                                      sum up to 100%.
                                      <br>
                                    </div>
                                  </div>
                                </div>



                                <div class="col-12 col-lg-4">
                                  <div class="p-field">
                                    <label for="Relevance">Likelihood Weight (%)</label>
                                    <p-inputNumber inputId="locale-us" mode="decimal" [min]="0" [max]="100"
                                      locale="en-US" [minFractionDigits]="2" [(ngModel)]="data.likelihood_weight"
                                      placeholder="Enter Likelihood Weight" name="data.charData.likelihood_weight"
                                      (ngModelChange)="onLikelihoodWeightChange(category.CategoryName,data.characteristics.name, $event)">
                                    </p-inputNumber>

                                    <!-- <div *ngIf="!chaCategoryLikelihoodTotalEqualsTo1[category.CategoryName]" style="color: red;"> -->
                                    <div
                                      *ngIf="!chaCategoryLikelihoodTotalEqualsTo1[category.CategoryName] && initialLikelihood !==0 "
                                      style="color: red;">
                                      Likelihood weights for characteristics of {{category.CategoryName}} category
                                      should sum up to 100%.
                                      <br>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>

                        </div>
                      </div>

                    </div>
                  </div>

                </p-tabPanel>
              </p-tabView>
              <!-- </div> -->
            </p-tabPanel>


            <p-tabPanel header="Outcome of Change">
              <p-tabView #tabView2 (onChange)="onCategoryTabChange($event, tabView2) " [(activeIndex)]="activeIndex2">

                <p-tabPanel [header]="category.CategoryName" *ngFor="let category of outcomeData">

                  <div *ngIf="category.CategoryName === 'Scale SD' ">
                    <div class="row">
                      <div class="col-2 ">
                        <p>Select SDGs : </p>
                      </div>

                      <div class="col-4 ">
                        <p-multiSelect appendTo="body" name="sdgs" placeholder="Select SDGs" [(ngModel)]="selectedSDGs"
                          [options]="sdgList" (ngModelChange)="onItemSelectSDGs($event)" optionLabel="name"
                          [required]="true"></p-multiSelect>
                      </div>

                      <div class="col-5 "></div>
                    </div>
                  </div>


                  <div
                    *ngIf="category.CategoryName !== 'Scale SD' && category.CategoryName !== 'Sustained nature-SD'  ">
                    <div class="characteristic-Topic" *ngFor="let data of category.data; index as i">
                      <h6>{{i+1}}.{{data.characteristics.name}}</h6>
                      <div>
                        <form>
                          <div class="container pl-20 pr-20">
                            <div id="content" #content>
                              <div class=" mt-2">
                                <div class="p-grid p-fluid col-12">

                                  <div class="row p-2">
                                    <div class="col-12 col-lg-12">
                                      <div class="p-field">
                                        <label for="indicator">Indicator</label>
                                        <input type="text" pInputText [(ngModel)]="data.indicator"
                                          placeholder="Indicator Name" name="indicator" />
                                      </div>
                                    </div>
                                  </div>

                                  <div class="row p-2">
                                    <div class="col-12 col-lg-6">
                                      <div class="p-field">
                                        <label for="indicatorStartingVal">Indicator Starting Situation Value</label>
                                        <p-inputNumber [(ngModel)]="data.indicatorStartingVal"
                                          name="indicatorStartingVal" placeholder="Value at the Starting Situation"
                                          inputId="locale-us" mode="decimal" locale="en-US" [minFractionDigits]="2">
                                        </p-inputNumber>
                                      </div>
                                    </div>

                                    <div class="col-12 col-lg-6">
                                      <div class="p-field">
                                        <label for="indicatorExpectedVal">Indicator Expected Value</label>
                                        <p-inputNumber [(ngModel)]="data.indicatorExpectedVal"
                                          name="indicatorExpectedVal" placeholder="Expected Value" inputId="locale-us"
                                          mode="decimal" locale="en-US" [minFractionDigits]="2">
                                        </p-inputNumber>

                                      </div>
                                    </div>
                                  </div>



                                  <div class="row p-2">
                                    <div class="col-12 col-lg-6">
                                      <div class="p-field">
                                        <label for="Relevance">Score</label>
                                        <p-inputNumber inputId="integeronly" [(ngModel)]="data.score"
                                          [showButtons]="true" [min]="-1" [max]="3" [step]="1" inputId="minmax-buttons"
                                          placeholder="Enter Score" name="data.charData.score"> </p-inputNumber>
                                      </div>
                                    </div>

                                    <div class="col-12 col-lg-6">
                                      <div class="p-field">
                                        <label for="justification">Justification</label>
                                        <input type="text" pInputText [(ngModel)]="data.justification"
                                          placeholder="Enter Justifiaction" name="justification" />

                                      </div>
                                    </div>
                                  </div>


                                  <!-- lllllllllllllllllllllllllllll -->
                              <div class="row p-2 align-items-center">
                                <div class="col-2 d-flex align-items-center">
                                  <p-fileUpload mode="basic" chooseIcon="pi pi-upload" chooseLabel="Upload" name="files"
                                    [url]="uploadUrl" (onUpload)="onUpload($event,data)" [multiple]="true"
                                    accept="{{acceptedFiles}}" [maxFileSize]="5000000" [auto]="true">
                                  </p-fileUpload>
                                </div>

                                <div class="col-2 d-flex align-items-center" *ngIf="data.uploadedDocumentPath">
                                  <p>{{data.uploadedDocumentPath}}</p>
                                </div>

                                <div class="col-2 d-flex align-items-center" *ngIf="data.uploadedDocumentPath">
                                  <a target="_blank" [href]="fileServerURL+'/'+data.uploadedDocumentPath"><i
                                      class="pi pi-download download"></i></a>
                                </div>
                              </div>


                              <!-- lllllllllllllllllllllllllllll -->


                            <div class="row p-2" *ngIf=" category.CategoryName ==='Scale GHGs' && data.characteristics.name === 'Micro Level'">
                              <div class="col-12 col-lg-6">
                                <div class="p-field">
                                  <label for="expected_ghg_mitigation">Expected GHG mitgation (Mt CO2-eq)</label>
                                  <p-inputNumber [(ngModel)]="data.expected_ghg_mitigation" name="expected_ghg_mitigation"
                                      placeholder="Expected GHG mitgation Value" inputId="locale-us" mode="decimal"
                                    locale="en-US" [minFractionDigits]="2">
                                  </p-inputNumber>
                                  </div>
                                </div>

                                </div>


                              </div>
                            </div>
                          </div>
                        </div>
                        </form>

                      </div>
                    </div>
                  </div>

                  <div *ngIf="category.CategoryName === 'Scale SD'">
                    <div *ngFor="let item of sdgDataSendArray2; index as i">
                      <br>
                      <h6>SDG {{ selectedSDGs[i].number }} - {{ selectedSDGs[i].name }}</h6>
                      <div class="characteristic-Topic" *ngFor="let data of item.data; index as j">
                        <h6>{{ j+1 }}.{{ data.characteristics.name }}</h6>
                        <div>
                          <form>
                            <div class="container pl-20 pr-20">
                              <div id="content" #content>
                                <div class=" mt-2">
                                  <div class="p-grid p-fluid col-12">
                                    <div class="row p-2">
                                      <div class="col-12 col-lg-12">
                                        <div class="p-field">
                                          <label for="indicator">Indicator</label>
                                          <input type="text" (ngModelChange)="assignSDG(selectedSDGs[i], data)"
                                            pInputText [(ngModel)]="data.indicator" placeholder="Indicator Name"
                                            name="indicator" />
                                        </div>
                                      </div>
                                    </div>

                                    <div class="row p-2">
                                      <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="indicatorStartingVal">Indicator Starting Situation Value</label>
                                          <p-inputNumber (ngModelChange)="assignSDG(selectedSDGs[i], data)"
                                            [(ngModel)]="data.indicatorStartingVal" name="indicatorStartingVal"
                                            placeholder="Value at the Starting Situation" inputId="locale-us"
                                            mode="decimal" locale="en-US" [minFractionDigits]="2"></p-inputNumber>
                                        </div>
                                      </div>

                                      <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="indicatorExpectedVal">Indicator Expected Value</label>
                                          <p-inputNumber (ngModelChange)="assignSDG(selectedSDGs[i], data)"
                                            [(ngModel)]="data.indicatorExpectedVal" name="indicatorExpectedVal"
                                            placeholder="Expected Value" inputId="locale-us" mode="decimal"
                                            locale="en-US" [minFractionDigits]="2"></p-inputNumber>
                                        </div>
                                      </div>
                                    </div>

                                    <div class="row p-2">
                                      <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="Relevance">Score</label>
                                          <p-inputNumber (ngModelChange)="assignSDG(selectedSDGs[i], data)"
                                            inputId="integeronly" [(ngModel)]="data.score" [showButtons]="true"
                                            [min]="-1" [max]="3" [step]="1" inputId="minmax-buttons"
                                            placeholder="Enter Score" name="data.charData.score"></p-inputNumber>
                                        </div>
                                      </div>

                                      <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="justification">Justification</label>
                                          <input (ngModelChange)="assignSDG(selectedSDGs[i], data)" type="text"
                                            pInputText [(ngModel)]="data.justification"
                                            placeholder="Enter Justification" name="justification" />
                                        </div>
                                      </div>
                                    </div>

                                    <!-- lllllllllllllllllllllllllllll -->
                                    <div class="row p-2 align-items-center">
                                      <div class="col-2 d-flex align-items-center">
                                        <p-fileUpload mode="basic" chooseIcon="pi pi-upload" chooseLabel="Upload"
                                          name="files" [url]="uploadUrl" (onUpload)="onUpload($event,data)"
                                          [multiple]="true" accept="{{acceptedFiles}}" [maxFileSize]="5000000"
                                          [auto]="true">
                                        </p-fileUpload>
                                      </div>

                                      <div class="col-2 d-flex align-items-center" *ngIf="data.uploadedDocumentPath">
                                        <p>{{data.uploadedDocumentPath}}</p>
                                      </div>

                                      <div class="col-2 d-flex align-items-center" *ngIf="data.uploadedDocumentPath">
                                        <a target="_blank" [href]="fileServerURL+'/'+data.uploadedDocumentPath"><i
                                            class="pi pi-download download"></i></a>
                                      </div>
                                    </div>


                                    <!-- lllllllllllllllllllllllllllll -->


                                  </div>
                                </div>
                              </div>
                            </div>
                          </form>
                        </div>
                      </div>
                    </div>
                  </div>



                  <div *ngIf="category.CategoryName === 'Sustained nature-SD'  ">

                    <div *ngFor="let item of sdgDataSendArray4; index as i">
                      <br>
                      <h6>SDG {{ selectedSDGs[i].number }} - {{ selectedSDGs[i].name }}</h6>
                      <div class="characteristic-Topic" *ngFor="let data of item.data; index as j">
                        <h6>{{ j+1 }}.{{ data.characteristics.name }}</h6>
                        <div>
                          <form>
                            <div class="container pl-20 pr-20">
                              <div id="content" #content>
                                <div class=" mt-2">
                                  <div class="p-grid p-fluid col-12">
                                    <div class="row p-2">
                                      <div class="col-12 col-lg-12">
                                        <div class="p-field">
                                          <label for="indicator">Indicator</label>
                                          <input (ngModelChange)="assignSDG(selectedSDGs[i], data)" type="text"
                                            pInputText [(ngModel)]="data.indicator" placeholder="Indicator Name"
                                            name="indicator" />
                                        </div>
                                      </div>
                                    </div>

                                    <div class="row p-2">
                                      <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="indicatorStartingVal">Indicator Starting Situation Value</label>
                                          <p-inputNumber (ngModelChange)="assignSDG(selectedSDGs[i], data)"
                                            [(ngModel)]="data.indicatorStartingVal" name="indicatorStartingVal"
                                            placeholder="Value at the Starting Situation" inputId="locale-us"
                                            mode="decimal" locale="en-US" [minFractionDigits]="2"></p-inputNumber>
                                        </div>
                                      </div>

                                      <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="indicatorExpectedVal">Indicator Expected Value</label>
                                          <p-inputNumber (ngModelChange)="assignSDG(selectedSDGs[i], data)"
                                            [(ngModel)]="data.indicatorExpectedVal" name="indicatorExpectedVal"
                                            placeholder="Expected Value" inputId="locale-us" mode="decimal"
                                            locale="en-US" [minFractionDigits]="2"></p-inputNumber>
                                        </div>
                                      </div>
                                    </div>

                                    <div class="row p-2">
                                      <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="Relevance">Score</label>
                                          <p-inputNumber (ngModelChange)="assignSDG(selectedSDGs[i], data)"
                                            inputId="integeronly" [(ngModel)]="data.score" [showButtons]="true"
                                            [min]="-1" [max]="3" [step]="1" inputId="minmax-buttons"
                                            placeholder="Enter Score" name="data.charData.score"></p-inputNumber>
                                        </div>
                                      </div>

                                      <div class="col-12 col-lg-6">
                                        <div class="p-field">
                                          <label for="justification">Justification</label>
                                          <input (ngModelChange)="assignSDG(selectedSDGs[i], data)" type="text"
                                            pInputText [(ngModel)]="data.justification"
                                            placeholder="Enter Justification" name="justification" />
                                        </div>
                                      </div>
                                    </div>

                                    <!-- lllllllllllllllllllllllllllll -->
                                    <div class="row p-2 align-items-center">
                                      <div class="col-2 d-flex align-items-center">
                                        <p-fileUpload mode="basic" chooseIcon="pi pi-upload" chooseLabel="Upload"
                                          name="files" [url]="uploadUrl" (onUpload)="onUpload($event,data)"
                                          [multiple]="true" accept="{{acceptedFiles}}" [maxFileSize]="5000000"
                                          [auto]="true">
                                        </p-fileUpload>
                                      </div>

                                      <div class="col-2 d-flex align-items-center" *ngIf="data.uploadedDocumentPath">
                                        <p>{{data.uploadedDocumentPath}}</p>
                                      </div>

                                      <div class="col-2 d-flex align-items-center" *ngIf="data.uploadedDocumentPath">
                                        <a target="_blank" [href]="fileServerURL+'/'+data.uploadedDocumentPath"><i
                                            class="pi pi-download download"></i></a>
                                      </div>
                                    </div>


                                    <!-- lllllllllllllllllllllllllllll -->


                                  </div>
                                </div>
                              </div>
                            </div>
                          </form>
                        </div>
                      </div>
                    </div>

                  </div>



                </p-tabPanel>

              </p-tabView>
            </p-tabPanel>

          </p-tabView>

          <div *ngIf="activeIndex2===3 && activeIndexMain===1" class="row justify-content-end">
            <div>
              <div class=" col-md-10 offset-md-4" style="color:red">
                <div class="col align-self-end" *ngIf="failedLikelihoodArray.length!=0">
                  Please make sure to set Likelihood weights for
                  <span *ngFor="let data of failedLikelihoodArray ; let last = last" class="array-item">
                    {{data.category}}<span *ngIf="!last">, </span>
                  </span> should sum up to 100%.

                </div>
                <div class="col align-self-end" *ngIf="failedRelevanceArray.length!=0">
                  Please make sure to set Relevance weights for <span
                    *ngFor="let data of failedRelevanceArray ; let last = last" class="array-item">
                    {{data.category}} <span *ngIf="!last">, </span>
                  </span> should sum up to 100%.


                </div>
              </div>
              <div class="d-flex flex-row-reverse mt-20 ">
                <button class="btn btn-primary text-uppercase" type="submit"
                  [disabled]="failedLikelihoodArray.length!=0 ||failedRelevanceArray.length!=0">
                  Calculate & Check Results
                </button>
              </div>
            </div>

          </div>
          <div *ngIf="activeIndex2!==3 || activeIndexMain!==1" class="row justify-content-end">
            <div>

              <div class="d-flex flex-row-reverse mt-20 ">
                <div class="btn btn-primary text-uppercase" (click)="next()"
                  [class.disabled]="(!isLikelihoodDisabled || !isRelavanceDisabled)">

                  Next
                </div>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>

    <!-- <div > -->
    <div *ngIf="load && selectedApproach === 'Indirect'">

      <div class="card">
        <form #fData1="ngForm" (ngSubmit)="onsubmit(fData1)">
          <p-tabView (onChange)="onMainTabChange($event)" [(activeIndex)]="activeIndexMain ">

            <p-tabPanel header="Process of Change">
              <!-- <div *ngFor="let characteristic of meth1Process"> -->

              <p-tabView #tabView (onChange)="onCategoryTabChange($event, tabView)" [(activeIndex)]="activeIndex ">

                <p-tabPanel [header]="category.CategoryName" *ngFor="let category of processData">


                  <div class="characteristic-Topic" *ngFor="let data of category.data; index as i">
                    <h6>{{i+1}}.{{data.characteristics.name}}</h6>
                    <div>

                      <div class="container pl-20 pr-20">
                        <div id="content" #content>
                          <div class=" mt-2">
                            <div class="p-grid p-fluid col-12">

                              <div class="row p-2">
                                <div class="col-12 col-lg-6">
                                  <div class="p-field">
                                    <label for="Description">Description</label>
                                    <textarea name="{{data.characteristics.name}}_description" placeholder="Description"
                                      rows="5" cols="60" pInputTextarea [(ngModel)]="data.description"
                                      autoResize="autoResize" class="p-inputtext"></textarea>
                                  </div>
                                </div>

                                <div class="col-12 col-lg-6">
                                  <div class="p-field">
                                    <label for="StartingSituation">Starting
                                      Situation</label>
                                    <textarea name="Starting Situation" placeholder="Starting Situation" rows="5"
                                      cols="60" pInputTextarea [(ngModel)]="data.starting_situation"
                                      autoResize="autoResize" class="p-inputtext"></textarea>

                                  </div>
                                </div>
                              </div>

                              <div class="row p-2">
                                <div class="col-12 col-lg-6">
                                  <div class="p-field">
                                    <label for="relavance">Relevance</label>
                                    <p-dropdown appendTo="body" name="relavance" placeholder="Select Institution"
                                      [(ngModel)]="data.relavance" [options]="instiTutionList" optionLabel="name"
                                      optionValue="id" [required]="true"></p-dropdown>
                                  </div>
                                </div>

                                <div class="col-12 col-lg-6">
                                  <div class="p-field">
                                    <label for="justification">Justification</label>
                                    <input type="text" pInputText [(ngModel)]="data.justification"
                                      placeholder="Enter Justifiaction" name="justification" />

                                  </div>
                                </div>
                              </div>
                              <div class="row p-2">
                                <div class="col-12 col-lg-12">
                                  <div class="p-field">
                                    <label for="indicator">Indicator</label>
                                    <input type="text" pInputText [(ngModel)]="data.indicator"
                                      placeholder="Indicator Name" name="indicator" />
                                  </div>
                                </div>
                              </div>

                              <div class="row p-2">
                                <div class="col-12 col-lg-6">
                                  <div class="p-field">
                                    <label for="indicatorStartingVal">Indicator Starting Situation Value</label>
                                    <p-dropdown appendTo="body" name="indicatorStartingVal"
                                      placeholder="Select Institution" [(ngModel)]="data.indicatorStartingVal"
                                      [options]="instiTutionList" optionLabel="name" optionValue="id"
                                      [required]="true"></p-dropdown>
                                  </div>
                                </div>

                                <div class="col-12 col-lg-6">
                                  <div class="p-field">
                                    <label for="indicatorExpectedVal">Indicator Expected Value</label>
                                    <p-dropdown appendTo="body" name="indicatorExpectedVal"
                                      placeholder="Select Institution" [(ngModel)]="data.indicatorExpectedVal"
                                      [options]="instiTutionList" optionLabel="name" optionValue="id"
                                      [required]="true"></p-dropdown>
                                  </div>
                                </div>
                              </div>

                              <div class="row p-2">
                                <div class="col-12 col-lg-6">
                                  <div class="p-field">
                                    <label for="likelihood">Likelihood</label>
                                    <p-dropdown appendTo="body" name="likelihood" placeholder="Select Institution"
                                      [(ngModel)]="data.likelihood" [options]="instiTutionList" optionLabel="name"
                                      optionValue="id" [required]="true"></p-dropdown>
                                  </div>
                                </div>

                                <div class="col-12 col-lg-6">
                                  <div class="p-field">
                                    <label for="justification">Justification</label>
                                    <input type="text" pInputText [(ngModel)]="data.likelihood_justification"
                                      placeholder="Enter Justifiaction" name="data.charData.likelihood_justification" />

                                  </div>
                                </div>
                              </div>

                              <div class="row p-2">
                                <div class="col-12 col-lg-6">
                                  <div class="p-field">
                                    <label for="Relevance">Relevance Weight (%)</label>
                                    <p-inputNumber inputId="locale-us" mode="decimal" locale="en-US"
                                      [minFractionDigits]="2" [min]="0" [max]="100" [(ngModel)]="data.relevance_weight"
                                      placeholder="Enter Relevance Weight" name="data.charData.relevance_weight"
                                      (ngModelChange)="onRelevanceWeightChange(category.CategoryName,data.characteristics.name, $event)">
                                    </p-inputNumber>

                                    <!-- <div *ngIf="!chaCategoryTotalEqualsTo1[category.CategoryName]" style="color: red;"> -->
                                    <div
                                      *ngIf="!chaCategoryTotalEqualsTo1[category.CategoryName] && initialRelevance !==0"
                                      style="color: red;">
                                      Relevance weights for characteristics of {{category.CategoryName}} category should
                                      sum up to 100%.
                                      <br>
                                    </div>
                                  </div>
                                </div>



                                <div class="col-12 col-lg-4">
                                  <div class="p-field">
                                    <label for="Relevance">Likelihood Weight (%)</label>
                                    <p-inputNumber inputId="locale-us" mode="decimal" [min]="0" [max]="100"
                                      locale="en-US" [minFractionDigits]="2" [(ngModel)]="data.likelihood_weight"
                                      placeholder="Enter Likelihood Weight" name="data.charData.likelihood_weight"
                                      (ngModelChange)="onLikelihoodWeightChange(category.CategoryName,data.characteristics.name, $event)">
                                    </p-inputNumber>

                                    <!-- <div *ngIf="!chaCategoryLikelihoodTotalEqualsTo1[category.CategoryName]" style="color: red;"> -->
                                    <div
                                      *ngIf="!chaCategoryLikelihoodTotalEqualsTo1[category.CategoryName] && initialLikelihood !==0 "
                                      style="color: red;">
                                      Likelihood weights for characteristics of {{category.CategoryName}} category
                                      should sum up to 100%.
                                      <br>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>

                        </div>
                      </div>



                    </div>
                  </div>




                </p-tabPanel>






              </p-tabView>
              <!-- </div> -->
            </p-tabPanel>
            <p-tabPanel header="Outcome of Change">
              <p-tabView #tabView2 (onChange)="onCategoryTabChange($event, tabView2) " [(activeIndex)]="activeIndex2">

                <p-tabPanel [header]="category.CategoryName" *ngFor="let category of outcomeData">

                  <div class="characteristic-Topic" *ngFor="let data of category.data; index as i">
                    <h6>{{i+1}}.{{data.characteristics.name}}</h6>
                    <div>
                      <form>
                        <div class="container pl-20 pr-20">
                          <div id="content" #content>
                            <div class=" mt-2">
                              <div class="p-grid p-fluid col-12">
                                <div class="row p-2">
                                  <div class="col-12 col-lg-12">
                                    <div class="p-field">
                                      <label for="indicator">Indicator</label>
                                      <input type="text" pInputText [(ngModel)]="data.indicator"
                                        placeholder="Indicator Name" name="indicator" />
                                    </div>
                                  </div>
                                </div>

                                <div class="row p-2">
                                  <div class="col-12 col-lg-6">
                                    <div class="p-field">
                                      <label for="indicatorStartingVal">Indicator Starting Situation Value</label>
                                      <p-dropdown appendTo="body" name="indicatorStartingVal"
                                        placeholder="Select Institution" [(ngModel)]="data.indicatorStartingVal"
                                        [options]="instiTutionList" optionLabel="name" optionValue="id"
                                        [required]="true"></p-dropdown>
                                    </div>
                                  </div>

                                  <div class="col-12 col-lg-6">
                                    <div class="p-field">
                                      <label for="indicatorExpectedVal">Indicator Expected Value</label>
                                      <p-dropdown appendTo="body" name="indicatorExpectedVal"
                                        placeholder="Select Institution" [(ngModel)]="data.indicatorExpectedVal"
                                        [options]="instiTutionList" optionLabel="name" optionValue="id"
                                        [required]="true"></p-dropdown>

                                    </div>
                                  </div>
                                </div>



                                <div class="row p-2">
                                  <div class="col-12 col-lg-6">
                                    <div class="p-field">
                                      <label for="score">Score</label>
                                      <p-dropdown appendTo="body" name="score" placeholder="Select Institution"
                                        [(ngModel)]="data.score" [options]="instiTutionList" optionLabel="name"
                                        optionValue="id" [required]="true"></p-dropdown>
                                    </div>
                                  </div>

                                  <div class="col-12 col-lg-6">
                                    <div class="p-field">
                                      <label for="justification">Justification</label>
                                      <input type="text" pInputText [(ngModel)]="data.justification"
                                        placeholder="Enter Justifiaction" name="justification" />

                                    </div>
                                  </div>
                                </div>

                            <div class="row p-2" *ngIf=" category.CategoryName ==='Scale GHGs' && data.characteristics.name === 'Micro Level'">
                              <div class="col-12 col-lg-6">
                                <div class="p-field">
                                  <label for="expected_ghg_mitigation">Expected GHG mitgation (Mt CO2-eq)</label>
                                  <p-inputNumber [(ngModel)]="data.expected_ghg_mitigation" name="expected_ghg_mitigation"
                                      placeholder="Expected GHG mitgation Value" inputId="locale-us" mode="decimal"
                                    locale="en-US" [minFractionDigits]="2">
                                  </p-inputNumber>
                                  </div>
                                </div>


                                </div>
                              </div>
                            </div>
                          </div>
                        </div>

                      </form>

                    </div>
                  </div>



                </p-tabPanel>




              </p-tabView>
            </p-tabPanel>

          </p-tabView>

          <div *ngIf="activeIndex2===3 && activeIndexMain===1" class="row justify-content-end">
            <div>
              <div class=" col-md-10 offset-md-4" style="color:red">
                <div class="col align-self-end" *ngIf="failedLikelihoodArray.length!=0">
                  Please make sure to set Likelihood weights for
                  <span *ngFor="let data of failedLikelihoodArray ; let last = last" class="array-item">
                    {{data.category}}<span *ngIf="!last">, </span>
                  </span> should sum up to 100%.

                </div>
                <div class="col align-self-end" *ngIf="failedRelevanceArray.length!=0">
                  Please make sure to set Relevance weights for <span
                    *ngFor="let data of failedRelevanceArray ; let last = last" class="array-item">
                    {{data.category}} <span *ngIf="!last">, </span>
                  </span> should sum up to 100%.


                </div>
              </div>
              <div class="d-flex flex-row-reverse mt-20 ">
                <button class="btn btn-primary text-uppercase" type="submit"
                  [disabled]="failedLikelihoodArray.length!=0 ||failedRelevanceArray.length!=0">
                  {{ selectedApproach === 'Indirect' ? 'Send to Data Collection Team' : 'Calculate & Check Results' }}
                </button>

              </div>
            </div>

          </div>
          <div *ngIf="activeIndex2!==3 || activeIndexMain!==1" class="row justify-content-end">
            <div>

              <div class="d-flex flex-row-reverse mt-20 ">
                <div class="btn btn-primary text-uppercase" (click)="next()"
                  [class.disabled]="(!isLikelihoodDisabled || !isRelavanceDisabled)">
                  Next
                </div>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>

  </div>
</div>


<div *ngIf="!track4Selectt">
  <app-carbon></app-carbon>
</div>
