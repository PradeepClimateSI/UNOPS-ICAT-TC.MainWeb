<nb-layout>
  <nb-layout-column class="p-0">
    <div class="wrapper d-flex flex-row flex-grow-1">
      <div class="sidebar d-flex flex-column customSB d-print-none"
        [ngClass]="{ open: togglemenu || innerWidth > 1280 }">
        <div class="sidebar--button selectable" (click)="togglemenu = !togglemenu">
          <i class="pi pi-arrow-right" *ngIf="!togglemenu"></i>
          <i class="pi pi-arrow-left" *ngIf="togglemenu"></i>
        </div>
        <div class="sidebar--header">
          <div class="row mb-2">
            <div class="col-md-3">
              <img
              src="https://climateactiontransparency.org/wp-content/themes/custom/assets/i/logo/logo_yellow.svg"
              alt="logo" height="40px"
            />
            </div>
            <div class="col-md-5">
              <img
                src="https://climateactiontransparency.org/wp-content/themes/custom/assets/i/logo/logo_text.svg"
                width="150px"
                height="40px"
                alt="logo text"
              />
            </div>
          </div>
        </div>
        <div class="sidebar-items flex-grow-1">
          <div data-ccs-admin-menu>
            <div class="sidebar-items--link align-items-start" [routerLink]="['/app/']" routerLinkActive="selected">
              Overview
            </div>
            <div
              *ngIf="userRole==loginRole.MASTER_ADMIN || userRole==loginRole.Sector_Admin  || userRole==loginRole.MRV_Admin||  userRole==loginRole.Data_Collection_Team || userRole==loginRole.Institution_Admin ||  userRole==loginRole.Country_Admin">
              <p-accordion>
                <p-accordionTab data-assess>
                  <p-header class="p-accordion-header-text d-flex flex-row align-items-left">
                    <div [routerLink]="['/app/institution']" routerLinkActive="selected">
                      <p class="mb-2">Institutions</p>
                    </div>
                  </p-header>

                  <div class="sidebar-items--link d-flex flex-column align-items-start"
                    [routerLink]="['/app/add-institution']" routerLinkActive="selected">
                    <p class="mb-0 ml-20">Create</p>
                  </div>
                  <div class="sidebar-items--link d-flex flex-column align-items-start"
                    [routerLink]="['/app/institutionlist']" routerLinkActive="selected">
                    <p class="mb-0 ml-20">Manage</p>
                  </div>
                </p-accordionTab>
              </p-accordion>
            </div>

            <div
              *ngIf="userRole==loginRole.MASTER_ADMIN || userRole==loginRole.Sector_Admin  || userRole==loginRole.MRV_Admin||  userRole==loginRole.Data_Collection_Team || userRole==loginRole.Institution_Admin ||  userRole==loginRole.Country_Admin">
              <p-accordion>
                <p-accordionTab data-assess>
                  <p-header class="p-accordion-header-text d-flex flex-row align-items-left">
                    <div [routerLink]="['/app/user']" routerLinkActive="selected">
                      <p class="mb-2">Users</p>
                    </div>
                  </p-header>

                  <div class="sidebar-items--link d-flex flex-column align-items-start"
                    [routerLink]="['/app/user/create']" routerLinkActive="selected">
                    <p class="mb-0 ml-20">Create</p>
                  </div>

                  <div class="sidebar-items--link d-flex flex-column align-items-start"
                    [routerLink]="['/app/user/list']" routerLinkActive="selected">
                    <p class="mb-0 ml-20">Manage</p>
                  </div>

                </p-accordionTab>
              </p-accordion>
            </div>
            <div
              *ngIf="userRole==loginRole.Country_Admin"
              class="sidebar-items--link align-items-start" [routerLink]="['/app/manage-sdgs']"
              routerLinkActive="selected">
              Manage SDGs
            </div>

            <p-accordion>
              <div
                *ngIf="userRole==loginRole.MASTER_ADMIN || userRole==loginRole.Sector_Admin || userRole==loginRole.Country_User || userRole==loginRole.MRV_Admin||  userRole==loginRole.Data_Collection_Team ||  userRole==loginRole.Country_Admin ||  userRole==loginRole.External ">
                <p-accordionTab data-assess>
                  <p-header class="p-accordion-header-text d-flex flex-row align-items-left">
                    <div
                      *ngIf="userRole==loginRole.MASTER_ADMIN || userRole==loginRole.Sector_Admin || userRole==loginRole.Country_User || userRole==loginRole.MRV_Admin||  userRole==loginRole.Data_Collection_Team ||  userRole==loginRole.Country_Admin ||  userRole==loginRole.External ">
                      <p class="mb-2">Interventions</p>
                    </div>
                  </p-header>
                  <div
                    *ngIf="userRole==loginRole.MASTER_ADMIN || userRole==loginRole.Sector_Admin || userRole==loginRole.Country_User || userRole==loginRole.MRV_Admin||  userRole==loginRole.Data_Collection_Team ||   userRole==loginRole.External ||  userRole==loginRole.Country_Admin"
                    class="sidebar-items--link d-flex flex-column align-items-start"
                    [routerLink]="['/app/add-interventions']" routerLinkActive="selected">
                    <p class="mb-0 ml-20">Create</p>
                  </div>
                  <div
                    *ngIf="userRole==loginRole.MASTER_ADMIN || userRole==loginRole.Sector_Admin || userRole==loginRole.Country_User ||  userRole==loginRole.External || userRole==loginRole.MRV_Admin||  userRole==loginRole.Data_Collection_Team||  userRole==loginRole.Country_Admin"
                    class="sidebar-items--link d-flex flex-column align-items-start"
                    [routerLink]="['/app/view-interventions']" routerLinkActive="selected">
                    <p class="mb-0 ml-20">Manage</p>
                  </div>

                </p-accordionTab>
              </div>


            </p-accordion>
            <div
              *ngIf="userRole==loginRole.MASTER_ADMIN || userRole==loginRole.Sector_Admin ||  userRole==loginRole.External || userRole==loginRole.Country_User ||  userRole==loginRole.Country_Admin">
              <p-accordion>
                <p-accordionTab data-assess [selected]="true">
                  <p-header class="p-accordion-header-text d-flex flex-row align-items-left" (click)="$event.stopPropagation()">
                    <div [routerLink]="['/app/assessment-flow']" routerLinkActive="selected">
                      <p class="mb-2">Assess interventions</p>
                    </div>
                  </p-header>
                  <div class="sidebar-items--link d-flex flex-column align-items-start" *ngIf="isPortfolioTool || userRole==loginRole.External"
                    [routerLink]="['/app/portfolio-tool']" routerLinkActive="selected">
                    <p class="mb-0 ml-20">{{masterDataService.getToolName('PORTFOLIO')}}</p>
                  </div>
                  <div class="sidebar-items--link d-flex flex-column align-items-start" *ngIf="isCarbonMarketTool || userRole==loginRole.External"
                    [routerLink]="['/app/carbon-market-tool']" routerLinkActive="selected">
                    <p class="mb-0 ml-20">{{masterDataService.getToolName('CARBON_MARKET')}}</p>
                  </div>

                  <div class="sidebar-items--link d-flex flex-column align-items-start" *ngIf="isInvesmentTool || userRole==loginRole.External"
                    [routerLink]="['/app/investor-tool-new']" routerLinkActive="selected">
                    <p class="mb-0 ml-20">{{masterDataService.getToolName('INVESTOR')}}</p>
                  </div>


                </p-accordionTab>
              </p-accordion>
            </div>
            <div
              *ngIf="userRole==loginRole.MASTER_ADMIN || userRole==loginRole.Sector_Admin || userRole==loginRole.Country_User || userRole==loginRole.MRV_Admin||  userRole==loginRole.Data_Collection_Team || userRole==loginRole.External || userRole==loginRole.Country_Admin"
              class="sidebar-items--link align-items-start" [routerLink]="['/app/portfolio-list']"
              routerLinkActive="selected">
              Portfolio tool
            </div>
            <div
            *ngIf="userRole==loginRole.MASTER_ADMIN || userRole==loginRole.Country_User ||  userRole==loginRole.External ||  userRole==loginRole.Country_Admin"
            class="sidebar-items--link align-items-start" [routerLink]="['/app/assessment-inprogress']"
            routerLinkActive="selected">
            Assessments in progress
          </div>
            <div
              *ngIf="userRole==loginRole.MASTER_ADMIN || userRole==loginRole.Sector_Admin || userRole==loginRole.Country_User ||  userRole==loginRole.External || userRole==loginRole.MRV_Admin||  userRole==loginRole.Data_Collection_Team ||  userRole==loginRole.Country_Admin"
              class="sidebar-items--link align-items-start" [routerLink]="['/app/assessment-results']"
              routerLinkActive="selected">
              Assessment results
            </div>
            <div
              *ngIf="userRole==loginRole.MASTER_ADMIN || userRole==loginRole.Sector_Admin ||  userRole==loginRole.External || userRole==loginRole.Country_User || userRole==loginRole.MRV_Admin||  userRole==loginRole.Data_Collection_Team||  userRole==loginRole.Country_Admin ||  userRole==loginRole.Country_Admin"
              class="sidebar-items--link align-items-start" [routerLink]="['/app/report']" routerLinkActive="selected">
              <div class=""></div>
              Reports
            </div>
            <div *ngIf="userRole !=loginRole.External" class="sidebar-items--link align-items-start"
              [routerLink]="['/app/audit-log']" routerLinkActive="selected">
              Audit log
            </div>
            <div class="sidebar-items--link align-items-start" [routerLink]="['/auth/reset-password']"
              routerLinkActive="selected">

              <div class=""></div>
              Password reset
            </div>
            <div class="sidebar-items--link" (click)="logout()">
              <i class="pi pi-sign-out"></i> Logout
            </div>



          </div>
        </div>

        <div class="sidebar--footer">
          <div></div>
          <div></div>
          <div></div>

        </div>
      </div>
      <div class="main d-flex flex-column flex-grow-1">
        <div class="d-flex flex-column justify-content-end">
          <div class="p-text-nowrap p-text-truncate m-0 pr-2 text-right">
            <div class="top-panel d-flex justify-content-end">
              <div class="d-flex mt-15 mr-20">
                <span>
                  <div class="username">{{userName}}</div>
                  <div class="userrole">{{userRole}}</div>
                </span>
                <span>
                  <div (click)="logout()" class="logout">
                    <i class="pi pi-sign-out"></i>
                  </div>
                </span>
              </div>
            </div>
          </div>
          <div class="p-text-nowrap p-text-truncate m-0 mb-1 pr-2 text-right">
          </div>
        </div>

        <p-dialog [(visible)]="confirm" header="Notification" position="top-right">

          <div class="container" style="width: 500px; height: 225px; margin-left: 50px; margin-top: 0px ;">
            <p-table #table [value]="notification" [lazy]="true" [showCurrentPageReport]="true"
              paginatorDropdownAppendTo="body"
              currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries" [responsive]="true">
              <ng-template pTemplate="header">
                <tr>
                  <th>
                  </th>
                  <th></th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-notification>
                <tr>
                  <td style="color:blue">
                    <i [hidden]="notification.is_viewed" class="pi pi-eye"
                      style="font-size: 1.5rem; border-color: transparent ; color-scheme: blue; "
                      (click)="detail(notification)"></i>
                    <i [hidden]="!notification.is_viewed" class="pi pi-eye-slash"
                      style="font-size: 1.5rem; border-color:transparent"></i>
                  </td>

                  <td>{{ notification.massege! }}</td>
                </tr>
              </ng-template>
            </p-table>

          </div>
        </p-dialog>
        <p-messages *ngIf="messages && isDeploying" [(value)]="messages" [enableService]="false" [closable]="false"></p-messages>
        <router-outlet></router-outlet>
      </div>
    </div>

  </nb-layout-column>

  <nb-layout-footer fixed>
  </nb-layout-footer>
</nb-layout>
<p-confirmDialog key="logout" header="Confirmation" icon="pi pi-exclamation-triangle"></p-confirmDialog>

